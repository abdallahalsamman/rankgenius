var xb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qr(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function Wr(){}Object.assign(Wr,{default:Wr,register:Wr,revert:function(){},__esModule:!0});Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(l){const e=(this.document||this.ownerDocument).querySelectorAll(l);let n=e.length;for(;--n>=0&&e.item(n)!==this;);return n>-1});Element.prototype.closest||(Element.prototype.closest=function(l){let e=this;if(!document.documentElement.contains(e))return null;do{if(e.matches(l))return e;e=e.parentElement||e.parentNode}while(e!==null);return null});Element.prototype.prepend||(Element.prototype.prepend=function(l){const e=document.createDocumentFragment();Array.isArray(l)||(l=[l]),l.forEach(n=>{const r=n instanceof Node;e.appendChild(r?n:document.createTextNode(n))}),this.insertBefore(e,this.firstChild)});Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(l){l=arguments.length===0?!0:!!l;const e=this.parentNode,n=window.getComputedStyle(e,null),r=parseInt(n.getPropertyValue("border-top-width")),s=parseInt(n.getPropertyValue("border-left-width")),c=this.offsetTop-e.offsetTop<e.scrollTop,h=this.offsetTop-e.offsetTop+this.clientHeight-r>e.scrollTop+e.clientHeight,f=this.offsetLeft-e.offsetLeft<e.scrollLeft,g=this.offsetLeft-e.offsetLeft+this.clientWidth-s>e.scrollLeft+e.clientWidth,w=c&&!h;(c||h)&&l&&(e.scrollTop=this.offsetTop-e.offsetTop-e.clientHeight/2-r+this.clientHeight/2),(f||g)&&l&&(e.scrollLeft=this.offsetLeft-e.offsetLeft-e.clientWidth/2-s+this.clientWidth/2),(c||h||f||g)&&!l&&this.scrollIntoView(w)});window.requestIdleCallback=window.requestIdleCallback||function(l){const e=Date.now();return setTimeout(function(){l({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})},1)};window.cancelIdleCallback=window.cancelIdleCallback||function(l){clearTimeout(l)};let yb=(l=21)=>crypto.getRandomValues(new Uint8Array(l)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");var ac=(l=>(l.VERBOSE="VERBOSE",l.INFO="INFO",l.WARN="WARN",l.ERROR="ERROR",l))(ac||{});const ot={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91,SLASH:191},Cb={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4};function yo(l,e,n="log",r,s="color: inherit"){if(!("console"in window)||!window.console[n])return;const c=["info","log","warn","error"].includes(n),h=[];switch(yo.logLevel){case"ERROR":if(n!=="error")return;break;case"WARN":if(!["error","warn"].includes(n))return;break;case"INFO":if(!c||l)return;break}r&&h.push(r);const f="Editor.js 2.29.0",g=`line-height: 1em;
            color: #006FEA;
            display: inline-block;
            font-size: 11px;
            line-height: 1em;
            background-color: #fff;
            padding: 4px 9px;
            border-radius: 30px;
            border: 1px solid rgba(56, 138, 229, 0.16);
            margin: 4px 5px 4px 0;`;l&&(c?(h.unshift(g,s),e=`%c${f}%c ${e}`):e=`( ${f} )${e}`);try{c?r?console[n](`${e} %o`,...h):console[n](e,...h):console[n](e)}catch{}}yo.logLevel="VERBOSE";function Eb(l){yo.logLevel=l}const yt=yo.bind(window,!1),Ne=yo.bind(window,!0);function _n(l){return Object.prototype.toString.call(l).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function Mt(l){return _n(l)==="function"||_n(l)==="asyncfunction"}function jt(l){return _n(l)==="object"}function gn(l){return _n(l)==="string"}function Sb(l){return _n(l)==="boolean"}function $l(l){return _n(l)==="number"}function Yl(l){return _n(l)==="undefined"}function Le(l){return l?Object.keys(l).length===0&&l.constructor===Object:!0}function lc(l){return l>47&&l<58||l===32||l===13||l===229||l>64&&l<91||l>95&&l<112||l>185&&l<193||l>218&&l<223}async function Tb(l,e=()=>{},n=()=>{}){async function r(s,c,h){try{await s.function(s.data),await c(Yl(s.data)?{}:s.data)}catch{h(Yl(s.data)?{}:s.data)}}return l.reduce(async(s,c)=>(await s,r(c,e,n)),Promise.resolve())}function cc(l){return Array.prototype.slice.call(l)}function gi(l,e){return function(){const n=this,r=arguments;window.setTimeout(()=>l.apply(n,r),e)}}function _b(l){return l.name.split(".").pop()}function Bb(l){return/^[-\w]+\/([-+\w]+|\*)$/.test(l)}function Kl(l,e,n){let r;return(...s)=>{const c=this,h=()=>{r=null,n||l.apply(c,s)},f=n&&!r;window.clearTimeout(r),r=window.setTimeout(h,e),f&&l.apply(c,s)}}function Yr(l,e,n=void 0){let r,s,c,h=null,f=0;n||(n={});const g=function(){f=n.leading===!1?0:Date.now(),h=null,c=l.apply(r,s),h||(r=s=null)};return function(){const w=Date.now();!f&&n.leading===!1&&(f=w);const I=e-(w-f);return r=this,s=arguments,I<=0||I>e?(h&&(clearTimeout(h),h=null),f=w,c=l.apply(r,s),h||(r=s=null)):!h&&n.trailing!==!1&&(h=setTimeout(g,I)),c}}function Lb(){const l={win:!1,mac:!1,x11:!1,linux:!1},e=Object.keys(l).find(n=>window.navigator.appVersion.toLowerCase().indexOf(n)!==-1);return e&&(l[e]=!0),l}function qn(l){return l[0].toUpperCase()+l.slice(1)}function Kr(l,...e){if(!e.length)return l;const n=e.shift();if(jt(l)&&jt(n))for(const r in n)jt(n[r])?(l[r]||Object.assign(l,{[r]:{}}),Kr(l[r],n[r])):Object.assign(l,{[r]:n[r]});return Kr(l,...e)}function vi(l){const e=Lb();return l=l.replace(/shift/gi,"⇧").replace(/backspace/gi,"⌫").replace(/enter/gi,"⏎").replace(/up/gi,"↑").replace(/left/gi,"→").replace(/down/gi,"↓").replace(/right/gi,"←").replace(/escape/gi,"⎋").replace(/insert/gi,"Ins").replace(/delete/gi,"␡").replace(/\+/gi," + "),e.mac?l=l.replace(/ctrl|cmd/gi,"⌘").replace(/alt/gi,"⌥"):l=l.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN"),l}function Ib(l){try{return new URL(l).href}catch{}return l.substring(0,2)==="//"?window.location.protocol+l:window.location.origin+l}function Ab(){return yb(10)}function Mb(l){window.open(l,"_blank")}function Ob(l=""){return`${l}${Math.floor(Math.random()*1e8).toString(16)}`}function qr(l,e,n){const r=`«${e}» is deprecated and will be removed in the next major release. Please use the «${n}» instead.`;l&&Ne(r,"warn")}function jn(l,e,n){const r=n.value?"value":"get",s=n[r],c=`#${e}Cache`;if(n[r]=function(...h){return this[c]===void 0&&(this[c]=s.apply(this,...h)),this[c]},r==="get"&&n.set){const h=n.set;n.set=function(f){delete l[c],h.apply(this,f)}}return n}const dc=650;function Tn(){return window.matchMedia(`(max-width: ${dc}px)`).matches}const ql=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);function Rb(l,e){const n=Array.isArray(l)||jt(l),r=Array.isArray(e)||jt(e);return n||r?JSON.stringify(l)===JSON.stringify(e):l===e}let C=class ne{static isSingleTag(e){return e.tagName&&["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(e.tagName)}static isLineBreakTag(e){return e&&e.tagName&&["BR","WBR"].includes(e.tagName)}static make(e,n=null,r={}){const s=document.createElement(e);Array.isArray(n)?s.classList.add(...n):n&&s.classList.add(n);for(const c in r)Object.prototype.hasOwnProperty.call(r,c)&&(s[c]=r[c]);return s}static text(e){return document.createTextNode(e)}static append(e,n){Array.isArray(n)?n.forEach(r=>e.appendChild(r)):e.appendChild(n)}static prepend(e,n){Array.isArray(n)?(n=n.reverse(),n.forEach(r=>e.prepend(r))):e.prepend(n)}static swap(e,n){const r=document.createElement("div"),s=e.parentNode;s.insertBefore(r,e),s.insertBefore(e,n),s.insertBefore(n,r),s.removeChild(r)}static find(e=document,n){return e.querySelector(n)}static get(e){return document.getElementById(e)}static findAll(e=document,n){return e.querySelectorAll(n)}static get allInputsSelector(){return"[contenteditable=true], textarea, input:not([type]), "+["text","password","email","number","search","tel","url"].map(e=>`input[type="${e}"]`).join(", ")}static findAllInputs(e){return cc(e.querySelectorAll(ne.allInputsSelector)).reduce((n,r)=>ne.isNativeInput(r)||ne.containsOnlyInlineElements(r)?[...n,r]:[...n,...ne.getDeepestBlockElements(r)],[])}static getDeepestNode(e,n=!1){const r=n?"lastChild":"firstChild",s=n?"previousSibling":"nextSibling";if(e&&e.nodeType===Node.ELEMENT_NODE&&e[r]){let c=e[r];if(ne.isSingleTag(c)&&!ne.isNativeInput(c)&&!ne.isLineBreakTag(c))if(c[s])c=c[s];else if(c.parentNode[s])c=c.parentNode[s];else return c.parentNode;return this.getDeepestNode(c,n)}return e}static isElement(e){return $l(e)?!1:e&&e.nodeType&&e.nodeType===Node.ELEMENT_NODE}static isFragment(e){return $l(e)?!1:e&&e.nodeType&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}static isContentEditable(e){return e.contentEditable==="true"}static isNativeInput(e){const n=["INPUT","TEXTAREA"];return e&&e.tagName?n.includes(e.tagName):!1}static canSetCaret(e){let n=!0;if(ne.isNativeInput(e))switch(e.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":n=!1;break}else n=ne.isContentEditable(e);return n}static isNodeEmpty(e,n){let r;return this.isSingleTag(e)&&!this.isLineBreakTag(e)?!1:(this.isElement(e)&&this.isNativeInput(e)?r=e.value:r=e.textContent.replace("​",""),n&&(r=r.replace(new RegExp(n,"g"),"")),r.trim().length===0)}static isLeaf(e){return e?e.childNodes.length===0:!1}static isEmpty(e,n){e.normalize();const r=[e];for(;r.length>0;)if(e=r.shift(),!!e){if(this.isLeaf(e)&&!this.isNodeEmpty(e,n))return!1;e.childNodes&&r.push(...Array.from(e.childNodes))}return!0}static isHTMLString(e){const n=ne.make("div");return n.innerHTML=e,n.childElementCount>0}static getContentLength(e){return ne.isNativeInput(e)?e.value.length:e.nodeType===Node.TEXT_NODE?e.length:e.textContent.length}static get blockElements(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tbody","thead","tr","tfoot","ul","video"]}static containsOnlyInlineElements(e){let n;gn(e)?(n=document.createElement("div"),n.innerHTML=e):n=e;const r=s=>!ne.blockElements.includes(s.tagName.toLowerCase())&&Array.from(s.children).every(r);return Array.from(n.children).every(r)}static getDeepestBlockElements(e){return ne.containsOnlyInlineElements(e)?[e]:Array.from(e.children).reduce((n,r)=>[...n,...ne.getDeepestBlockElements(r)],[])}static getHolder(e){return gn(e)?document.getElementById(e):e}static isAnchor(e){return e.tagName.toLowerCase()==="a"}static offset(e){const n=e.getBoundingClientRect(),r=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop,c=n.top+s,h=n.left+r;return{top:c,left:h,bottom:c+n.height,right:h+n.width}}};const Nb={blockTunes:{toggler:{"Click to tune":"","or drag to move":""}},inlineToolbar:{converter:{"Convert to":""}},toolbar:{toolbox:{Add:""}},popover:{Filter:"","Nothing found":""}},Db={Text:"",Link:"",Bold:"",Italic:""},Pb={link:{"Add a link":""},stub:{"The block can not be displayed correctly.":""}},Hb={delete:{Delete:"","Click to delete":""},moveUp:{"Move up":""},moveDown:{"Move down":""}},hc={ui:Nb,toolNames:Db,tools:Pb,blockTunes:Hb},$n=class{static ui(l,e){return $n._t(l,e)}static t(l,e){return $n._t(l,e)}static setDictionary(l){$n.currentDictionary=l}static _t(l,e){const n=$n.getNamespace(l);return!n||!n[e]?e:n[e]}static getNamespace(l){return l.split(".").reduce((e,n)=>!e||!Object.keys(e).length?{}:e[n],$n.currentDictionary)}};let de=$n;de.currentDictionary=hc;class uc extends Error{}class ki{constructor(){this.subscribers={}}on(e,n){e in this.subscribers||(this.subscribers[e]=[]),this.subscribers[e].push(n)}once(e,n){e in this.subscribers||(this.subscribers[e]=[]);const r=s=>{const c=n(s),h=this.subscribers[e].indexOf(r);return h!==-1&&this.subscribers[e].splice(h,1),c};this.subscribers[e].push(r)}emit(e,n){Le(this.subscribers)||!this.subscribers[e]||this.subscribers[e].reduce((r,s)=>{const c=s(r);return c!==void 0?c:r},n)}off(e,n){if(this.subscribers[e]===void 0){console.warn(`EventDispatcher .off(): there is no subscribers for event "${e.toString()}". Probably, .off() called before .on()`);return}for(let r=0;r<this.subscribers[e].length;r++)if(this.subscribers[e][r]===n){delete this.subscribers[e][r];break}}destroy(){this.subscribers={}}}function Sn(l){Object.setPrototypeOf(this,{get id(){return l.id},get name(){return l.name},get config(){return l.config},get holder(){return l.holder},get isEmpty(){return l.isEmpty},get selected(){return l.selected},set stretched(e){l.stretched=e},get stretched(){return l.stretched},get focusable(){return l.focusable},call(e,n){return l.call(e,n)},save(){return l.save()},validate(e){return l.validate(e)},dispatchChange(){l.dispatchChange()}})}class ts{constructor(){this.allListeners=[]}on(e,n,r,s=!1){const c=Ob("l"),h={id:c,element:e,eventType:n,handler:r,options:s};if(!this.findOne(e,n,r))return this.allListeners.push(h),e.addEventListener(n,r,s),c}off(e,n,r,s){const c=this.findAll(e,n,r);c.forEach((h,f)=>{const g=this.allListeners.indexOf(c[f]);g>-1&&(this.allListeners.splice(g,1),h.element.removeEventListener(h.eventType,h.handler,h.options))})}offById(e){const n=this.findById(e);n&&n.element.removeEventListener(n.eventType,n.handler,n.options)}findOne(e,n,r){const s=this.findAll(e,n,r);return s.length>0?s[0]:null}findAll(e,n,r){let s;const c=e?this.findByEventTarget(e):[];return e&&n&&r?s=c.filter(h=>h.eventType===n&&h.handler===r):e&&n?s=c.filter(h=>h.eventType===n):s=c,s}removeAll(){this.allListeners.map(e=>{e.element.removeEventListener(e.eventType,e.handler,e.options)}),this.allListeners=[]}destroy(){this.removeAll()}findByEventTarget(e){return this.allListeners.filter(n=>{if(n.element===e)return n})}findByType(e){return this.allListeners.filter(n=>{if(n.eventType===e)return n})}findByHandler(e){return this.allListeners.filter(n=>{if(n.handler===e)return n})}findById(e){return this.allListeners.find(n=>n.id===e)}}let bt=class pc{constructor({config:e,eventsDispatcher:n}){if(this.nodes={},this.listeners=new ts,this.readOnlyMutableListeners={on:(r,s,c,h=!1)=>{this.mutableListenerIds.push(this.listeners.on(r,s,c,h))},clearAll:()=>{for(const r of this.mutableListenerIds)this.listeners.offById(r);this.mutableListenerIds=[]}},this.mutableListenerIds=[],new.target===pc)throw new TypeError("Constructors for abstract class Module are not allowed.");this.config=e,this.eventsDispatcher=n}set state(e){this.Editor=e}removeAllNodes(){for(const e in this.nodes){const n=this.nodes[e];n instanceof HTMLElement&&n.remove()}}get isRtl(){return this.config.i18n.direction==="rtl"}},nt=class un{constructor(){this.instance=null,this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}static get CSS(){return{editorWrapper:"codex-editor",editorZone:"codex-editor__redactor"}}static get anchorNode(){const e=window.getSelection();return e?e.anchorNode:null}static get anchorElement(){const e=window.getSelection();if(!e)return null;const n=e.anchorNode;return n?C.isElement(n)?n:n.parentElement:null}static get anchorOffset(){const e=window.getSelection();return e?e.anchorOffset:null}static get isCollapsed(){const e=window.getSelection();return e?e.isCollapsed:null}static get isAtEditor(){return this.isSelectionAtEditor(un.get())}static isSelectionAtEditor(e){if(!e)return!1;let n=e.anchorNode||e.focusNode;n&&n.nodeType===Node.TEXT_NODE&&(n=n.parentNode);let r=null;return n&&n instanceof Element&&(r=n.closest(`.${un.CSS.editorZone}`)),r?r.nodeType===Node.ELEMENT_NODE:!1}static isRangeAtEditor(e){if(!e)return;let n=e.startContainer;n&&n.nodeType===Node.TEXT_NODE&&(n=n.parentNode);let r=null;return n&&n instanceof Element&&(r=n.closest(`.${un.CSS.editorZone}`)),r?r.nodeType===Node.ELEMENT_NODE:!1}static get isSelectionExists(){return!!un.get().anchorNode}static get range(){return this.getRangeFromSelection(this.get())}static getRangeFromSelection(e){return e&&e.rangeCount?e.getRangeAt(0):null}static get rect(){let e=document.selection,n,r={x:0,y:0,width:0,height:0};if(e&&e.type!=="Control")return e=e,n=e.createRange(),r.x=n.boundingLeft,r.y=n.boundingTop,r.width=n.boundingWidth,r.height=n.boundingHeight,r;if(!window.getSelection)return yt("Method window.getSelection is not supported","warn"),r;if(e=window.getSelection(),e.rangeCount===null||isNaN(e.rangeCount))return yt("Method SelectionUtils.rangeCount is not supported","warn"),r;if(e.rangeCount===0)return r;if(n=e.getRangeAt(0).cloneRange(),n.getBoundingClientRect&&(r=n.getBoundingClientRect()),r.x===0&&r.y===0){const s=document.createElement("span");if(s.getBoundingClientRect){s.appendChild(document.createTextNode("​")),n.insertNode(s),r=s.getBoundingClientRect();const c=s.parentNode;c.removeChild(s),c.normalize()}}return r}static get text(){return window.getSelection?window.getSelection().toString():""}static get(){return window.getSelection()}static setCursor(e,n=0){const r=document.createRange(),s=window.getSelection();return C.isNativeInput(e)?C.canSetCaret(e)?(e.focus(),e.selectionStart=e.selectionEnd=n,e.getBoundingClientRect()):void 0:(r.setStart(e,n),r.setEnd(e,n),s.removeAllRanges(),s.addRange(r),r.getBoundingClientRect())}static isRangeInsideContainer(e){const n=un.range;return n===null?!1:e.contains(n.startContainer)}static addFakeCursor(){const e=un.range;if(e===null)return;const n=C.make("span","codex-editor__fake-cursor");n.dataset.mutationFree="true",e.collapse(),e.insertNode(n)}static isFakeCursorInsideContainer(e){return C.find(e,".codex-editor__fake-cursor")!==null}static removeFakeCursor(e=document.body){const n=C.find(e,".codex-editor__fake-cursor");n&&n.remove()}removeFakeBackground(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}setFakeBackground(){document.execCommand(this.commandBackground,!1,"#a8d6ff"),this.isFakeBackgroundEnabled=!0}save(){this.savedSelectionRange=un.range}restore(){if(!this.savedSelectionRange)return;const e=window.getSelection();e.removeAllRanges(),e.addRange(this.savedSelectionRange)}clearSaved(){this.savedSelectionRange=null}collapseToEnd(){const e=window.getSelection(),n=document.createRange();n.selectNodeContents(e.focusNode),n.collapse(!1),e.removeAllRanges(),e.addRange(n)}findParentTag(e,n,r=10){const s=window.getSelection();let c=null;return!s||!s.anchorNode||!s.focusNode?null:([s.anchorNode,s.focusNode].forEach(h=>{let f=r;for(;f>0&&h.parentNode&&!(h.tagName===e&&(c=h,n&&h.classList&&!h.classList.contains(n)&&(c=null),c));)h=h.parentNode,f--}),c)}expandToTag(e){const n=window.getSelection();n.removeAllRanges();const r=document.createRange();r.selectNodeContents(e),n.addRange(r)}};function Fb(l,e){const{type:n,target:r,addedNodes:s,removedNodes:c}=l;if(r===e)return!0;if(["characterData","attributes"].includes(n)){const g=r.nodeType===Node.TEXT_NODE?r.parentNode:r;return e.contains(g)}const h=Array.from(s).some(g=>e.contains(g)),f=Array.from(c).some(g=>e.contains(g));return h||f}const Gr="redactor dom changed",fc="block changed",gc="fake cursor is about to be toggled",mc="fake cursor have been set";function Gl(l,e){return l.mergeable&&l.name===e.name}function Ub(l,e){const n=e==null?void 0:e.export;return Mt(n)?n(l):gn(n)?l[n]:(n!==void 0&&yt("Conversion «export» property must be a string or function. String means key of saved data object to export. Function should export processed string to export."),"")}function zb(l,e){const n=e==null?void 0:e.import;return Mt(n)?n(l):gn(n)?{[n]:l}:(n!==void 0&&yt("Conversion «import» property must be a string or function. String means key of tool data to import. Function accepts a imported string and return composed tool data."),{})}var Ze=(l=>(l.APPEND_CALLBACK="appendCallback",l.RENDERED="rendered",l.MOVED="moved",l.UPDATED="updated",l.REMOVED="removed",l.ON_PASTE="onPaste",l))(Ze||{});let Ve=class pn extends ki{constructor({id:e=Ab(),data:n,tool:r,api:s,readOnly:c,tunesData:h},f){super(),this.cachedInputs=[],this.toolRenderedElement=null,this.tunesInstances=new Map,this.defaultTunesInstances=new Map,this.unavailableTunesData={},this.inputIndex=0,this.editorEventBus=null,this.handleFocus=()=>{this.dropInputsCache(),this.updateCurrentInput()},this.didMutated=(g=void 0)=>{const w=g===void 0,I=g instanceof InputEvent;!w&&!I&&this.detectToolRootChange(g);let E;w||I?E=!0:E=!(g.length>0&&g.every(D=>{const{addedNodes:U,removedNodes:T,target:F}=D;return[...Array.from(U),...Array.from(T),F].some(P=>(C.isElement(P)||(P=P.parentElement),P&&P.closest('[data-mutation-free="true"]')!==null))})),E&&(this.dropInputsCache(),this.updateCurrentInput(),this.call("updated"),this.emit("didMutated",this))},this.name=r.name,this.id=e,this.settings=r.settings,this.config=r.settings.config||{},this.api=s,this.editorEventBus=f||null,this.blockAPI=new Sn(this),this.tool=r,this.toolInstance=r.create(n,this.blockAPI,c),this.tunes=r.tunes,this.composeTunes(h),this.holder=this.compose(),window.requestIdleCallback(()=>{this.watchBlockMutations(),this.addInputEvents()})}static get CSS(){return{wrapper:"ce-block",wrapperStretched:"ce-block--stretched",content:"ce-block__content",selected:"ce-block--selected",dropTarget:"ce-block--drop-target"}}get inputs(){if(this.cachedInputs.length!==0)return this.cachedInputs;const e=C.findAllInputs(this.holder);return this.inputIndex>e.length-1&&(this.inputIndex=e.length-1),this.cachedInputs=e,e}get currentInput(){return this.inputs[this.inputIndex]}set currentInput(e){const n=this.inputs.findIndex(r=>r===e||r.contains(e));n!==-1&&(this.inputIndex=n)}get firstInput(){return this.inputs[0]}get lastInput(){const e=this.inputs;return e[e.length-1]}get nextInput(){return this.inputs[this.inputIndex+1]}get previousInput(){return this.inputs[this.inputIndex-1]}get data(){return this.save().then(e=>e&&!Le(e.data)?e.data:{})}get sanitize(){return this.tool.sanitizeConfig}get mergeable(){return Mt(this.toolInstance.merge)}get focusable(){return this.inputs.length!==0}get isEmpty(){const e=C.isEmpty(this.pluginsContent,"/"),n=!this.hasMedia;return e&&n}get hasMedia(){const e=["img","iframe","video","audio","source","input","textarea","twitterwidget"];return!!this.holder.querySelector(e.join(","))}set selected(e){var n,r;this.holder.classList.toggle(pn.CSS.selected,e);const s=e===!0&&nt.isRangeInsideContainer(this.holder),c=e===!1&&nt.isFakeCursorInsideContainer(this.holder);(s||c)&&((n=this.editorEventBus)==null||n.emit(gc,{state:e}),s?nt.addFakeCursor():nt.removeFakeCursor(this.holder),(r=this.editorEventBus)==null||r.emit(mc,{state:e}))}get selected(){return this.holder.classList.contains(pn.CSS.selected)}set stretched(e){this.holder.classList.toggle(pn.CSS.wrapperStretched,e)}get stretched(){return this.holder.classList.contains(pn.CSS.wrapperStretched)}set dropTarget(e){this.holder.classList.toggle(pn.CSS.dropTarget,e)}get pluginsContent(){return this.toolRenderedElement}call(e,n){if(Mt(this.toolInstance[e])){e==="appendCallback"&&yt("`appendCallback` hook is deprecated and will be removed in the next major release. Use `rendered` hook instead","warn");try{this.toolInstance[e].call(this.toolInstance,n)}catch(r){yt(`Error during '${e}' call: ${r.message}`,"error")}}}async mergeWith(e){await this.toolInstance.merge(e)}async save(){const e=await this.toolInstance.save(this.pluginsContent),n=this.unavailableTunesData;[...this.tunesInstances.entries(),...this.defaultTunesInstances.entries()].forEach(([c,h])=>{if(Mt(h.save))try{n[c]=h.save()}catch(f){yt(`Tune ${h.constructor.name} save method throws an Error %o`,"warn",f)}});const r=window.performance.now();let s;return Promise.resolve(e).then(c=>(s=window.performance.now(),{id:this.id,tool:this.name,data:c,tunes:n,time:s-r})).catch(c=>{yt(`Saving process for ${this.name} tool failed due to the ${c}`,"log","red")})}async validate(e){let n=!0;return this.toolInstance.validate instanceof Function&&(n=await this.toolInstance.validate(e)),n}getTunes(){const e=document.createElement("div"),n=[],r=typeof this.toolInstance.renderSettings=="function"?this.toolInstance.renderSettings():[],s=[...this.tunesInstances.values(),...this.defaultTunesInstances.values()].map(c=>c.render());return[r,s].flat().forEach(c=>{C.isElement(c)?e.appendChild(c):Array.isArray(c)?n.push(...c):n.push(c)}),[n,e]}updateCurrentInput(){this.currentInput=C.isNativeInput(document.activeElement)||!nt.anchorNode?document.activeElement:nt.anchorNode}dispatchChange(){this.didMutated()}destroy(){this.unwatchBlockMutations(),this.removeInputEvents(),super.destroy(),Mt(this.toolInstance.destroy)&&this.toolInstance.destroy()}async getActiveToolboxEntry(){const e=this.tool.toolbox;if(e.length===1)return Promise.resolve(this.tool.toolbox[0]);const n=await this.data;return e.find(r=>Object.entries(r.data).some(([s,c])=>n[s]&&Rb(n[s],c)))}async exportDataAsString(){const e=await this.data;return Ub(e,this.tool.conversionConfig)}compose(){const e=C.make("div",pn.CSS.wrapper),n=C.make("div",pn.CSS.content),r=this.toolInstance.render();e.dataset.id=this.id,this.toolRenderedElement=r,n.appendChild(this.toolRenderedElement);let s=n;return[...this.tunesInstances.values(),...this.defaultTunesInstances.values()].forEach(c=>{if(Mt(c.wrap))try{s=c.wrap(s)}catch(h){yt(`Tune ${c.constructor.name} wrap method throws an Error %o`,"warn",h)}}),e.appendChild(s),e}composeTunes(e){Array.from(this.tunes.values()).forEach(n=>{(n.isInternal?this.defaultTunesInstances:this.tunesInstances).set(n.name,n.create(e[n.name],this.blockAPI))}),Object.entries(e).forEach(([n,r])=>{this.tunesInstances.has(n)||(this.unavailableTunesData[n]=r)})}addInputEvents(){this.inputs.forEach(e=>{e.addEventListener("focus",this.handleFocus),C.isNativeInput(e)&&e.addEventListener("input",this.didMutated)})}removeInputEvents(){this.inputs.forEach(e=>{e.removeEventListener("focus",this.handleFocus),C.isNativeInput(e)&&e.removeEventListener("input",this.didMutated)})}watchBlockMutations(){var e;this.redactorDomChangedCallback=n=>{const{mutations:r}=n;r.some(s=>Fb(s,this.toolRenderedElement))&&this.didMutated(r)},(e=this.editorEventBus)==null||e.on(Gr,this.redactorDomChangedCallback)}unwatchBlockMutations(){var e;(e=this.editorEventBus)==null||e.off(Gr,this.redactorDomChangedCallback)}detectToolRootChange(e){e.forEach(n=>{if(Array.from(n.removedNodes).includes(this.toolRenderedElement)){const r=n.addedNodes[n.addedNodes.length-1];this.toolRenderedElement=r}})}dropInputsCache(){this.cachedInputs=[]}};class Wb extends bt{constructor(){super(...arguments),this.insert=(e=this.config.defaultBlock,n={},r={},s,c,h,f)=>{const g=this.Editor.BlockManager.insert({id:f,tool:e,data:n,index:s,needToFocus:c,replace:h});return new Sn(g)},this.composeBlockData=async e=>{const n=this.Editor.Tools.blockTools.get(e);return new Ve({tool:n,api:this.Editor.API,readOnly:!0,data:{},tunesData:{}}).data},this.update=async(e,n)=>{const{BlockManager:r}=this.Editor,s=r.getBlockById(e);if(s===void 0)throw new Error(`Block with id "${e}" not found`);const c=await r.update(s,n);return new Sn(c)},this.convert=(e,n,r)=>{var s,c;const{BlockManager:h,Tools:f}=this.Editor,g=h.getBlockById(e);if(!g)throw new Error(`Block with id "${e}" not found`);const w=f.blockTools.get(g.name),I=f.blockTools.get(n);if(!I)throw new Error(`Block Tool with type "${n}" not found`);const E=((s=w==null?void 0:w.conversionConfig)==null?void 0:s.export)!==void 0,D=((c=I.conversionConfig)==null?void 0:c.import)!==void 0;if(E&&D)h.convert(g,n,r);else{const U=[E?!1:qn(g.name),D?!1:qn(n)].filter(Boolean).join(" and ");throw new Error(`Conversion from "${g.name}" to "${n}" is not possible. ${U} tool(s) should provide a "conversionConfig"`)}},this.insertMany=(e,n=this.Editor.BlockManager.blocks.length-1)=>{this.validateIndex(n);const r=e.map(({id:s,type:c,data:h})=>this.Editor.BlockManager.composeBlock({id:s,tool:c||this.config.defaultBlock,data:h}));return this.Editor.BlockManager.insertMany(r,n),r.map(s=>new Sn(s))}}get methods(){return{clear:()=>this.clear(),render:e=>this.render(e),renderFromHTML:e=>this.renderFromHTML(e),delete:e=>this.delete(e),swap:(e,n)=>this.swap(e,n),move:(e,n)=>this.move(e,n),getBlockByIndex:e=>this.getBlockByIndex(e),getById:e=>this.getById(e),getCurrentBlockIndex:()=>this.getCurrentBlockIndex(),getBlockIndex:e=>this.getBlockIndex(e),getBlocksCount:()=>this.getBlocksCount(),stretchBlock:(e,n=!0)=>this.stretchBlock(e,n),insertNewBlock:()=>this.insertNewBlock(),insert:this.insert,insertMany:this.insertMany,update:this.update,composeBlockData:this.composeBlockData,convert:this.convert}}getBlocksCount(){return this.Editor.BlockManager.blocks.length}getCurrentBlockIndex(){return this.Editor.BlockManager.currentBlockIndex}getBlockIndex(e){const n=this.Editor.BlockManager.getBlockById(e);if(!n){Ne("There is no block with id `"+e+"`","warn");return}return this.Editor.BlockManager.getBlockIndex(n)}getBlockByIndex(e){const n=this.Editor.BlockManager.getBlockByIndex(e);if(n===void 0){Ne("There is no block at index `"+e+"`","warn");return}return new Sn(n)}getById(e){const n=this.Editor.BlockManager.getBlockById(e);return n===void 0?(Ne("There is no block with id `"+e+"`","warn"),null):new Sn(n)}swap(e,n){yt("`blocks.swap()` method is deprecated and will be removed in the next major release. Use `block.move()` method instead","info"),this.Editor.BlockManager.swap(e,n)}move(e,n){this.Editor.BlockManager.move(e,n)}delete(e=this.Editor.BlockManager.currentBlockIndex){try{const n=this.Editor.BlockManager.getBlockByIndex(e);this.Editor.BlockManager.removeBlock(n)}catch(n){Ne(n,"warn");return}this.Editor.BlockManager.blocks.length===0&&this.Editor.BlockManager.insert(),this.Editor.BlockManager.currentBlock&&this.Editor.Caret.setToBlock(this.Editor.BlockManager.currentBlock,this.Editor.Caret.positions.END),this.Editor.Toolbar.close()}async clear(){await this.Editor.BlockManager.clear(!0),this.Editor.InlineToolbar.close()}async render(e){if(e===void 0||e.blocks===void 0)throw new Error("Incorrect data passed to the render() method");this.Editor.ModificationsObserver.disable(),await this.Editor.BlockManager.clear(),await this.Editor.Renderer.render(e.blocks),this.Editor.ModificationsObserver.enable()}renderFromHTML(e){return this.Editor.BlockManager.clear(),this.Editor.Paste.processText(e,!0)}stretchBlock(e,n=!0){qr(!0,"blocks.stretchBlock()","BlockAPI");const r=this.Editor.BlockManager.getBlockByIndex(e);r&&(r.stretched=n)}insertNewBlock(){yt("Method blocks.insertNewBlock() is deprecated and it will be removed in the next major release. Use blocks.insert() instead.","warn"),this.insert()}validateIndex(e){if(typeof e!="number")throw new Error("Index should be a number");if(e<0)throw new Error("Index should be greater than or equal to 0");if(e===null)throw new Error("Index should be greater than or equal to 0")}}class $b extends bt{constructor(){super(...arguments),this.setToFirstBlock=(e=this.Editor.Caret.positions.DEFAULT,n=0)=>this.Editor.BlockManager.firstBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.firstBlock,e,n),!0):!1,this.setToLastBlock=(e=this.Editor.Caret.positions.DEFAULT,n=0)=>this.Editor.BlockManager.lastBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.lastBlock,e,n),!0):!1,this.setToPreviousBlock=(e=this.Editor.Caret.positions.DEFAULT,n=0)=>this.Editor.BlockManager.previousBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.previousBlock,e,n),!0):!1,this.setToNextBlock=(e=this.Editor.Caret.positions.DEFAULT,n=0)=>this.Editor.BlockManager.nextBlock?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.nextBlock,e,n),!0):!1,this.setToBlock=(e,n=this.Editor.Caret.positions.DEFAULT,r=0)=>this.Editor.BlockManager.blocks[e]?(this.Editor.Caret.setToBlock(this.Editor.BlockManager.blocks[e],n,r),!0):!1,this.focus=(e=!1)=>e?this.setToLastBlock(this.Editor.Caret.positions.END):this.setToFirstBlock(this.Editor.Caret.positions.START)}get methods(){return{setToFirstBlock:this.setToFirstBlock,setToLastBlock:this.setToLastBlock,setToPreviousBlock:this.setToPreviousBlock,setToNextBlock:this.setToNextBlock,setToBlock:this.setToBlock,focus:this.focus}}}class Yb extends bt{get methods(){return{emit:(e,n)=>this.emit(e,n),off:(e,n)=>this.off(e,n),on:(e,n)=>this.on(e,n)}}on(e,n){this.eventsDispatcher.on(e,n)}emit(e,n){this.eventsDispatcher.emit(e,n)}off(e,n){this.eventsDispatcher.off(e,n)}}class es extends bt{static getNamespace(e){return e.isTune()?`blockTunes.${e.name}`:`tools.${e.name}`}get methods(){return{t:()=>{Ne("I18n.t() method can be accessed only from Tools","warn")}}}getMethodsForTool(e){return Object.assign(this.methods,{t:n=>de.t(es.getNamespace(e),n)})}}class Kb extends bt{get methods(){return{blocks:this.Editor.BlocksAPI.methods,caret:this.Editor.CaretAPI.methods,events:this.Editor.EventsAPI.methods,listeners:this.Editor.ListenersAPI.methods,notifier:this.Editor.NotifierAPI.methods,sanitizer:this.Editor.SanitizerAPI.methods,saver:this.Editor.SaverAPI.methods,selection:this.Editor.SelectionAPI.methods,styles:this.Editor.StylesAPI.classes,toolbar:this.Editor.ToolbarAPI.methods,inlineToolbar:this.Editor.InlineToolbarAPI.methods,tooltip:this.Editor.TooltipAPI.methods,i18n:this.Editor.I18nAPI.methods,readOnly:this.Editor.ReadOnlyAPI.methods,ui:this.Editor.UiAPI.methods}}getMethodsForTool(e){return Object.assign(this.methods,{i18n:this.Editor.I18nAPI.getMethodsForTool(e)})}}class qb extends bt{get methods(){return{close:()=>this.close(),open:()=>this.open()}}open(){this.Editor.InlineToolbar.tryToShow()}close(){this.Editor.InlineToolbar.close()}}class Gb extends bt{get methods(){return{on:(e,n,r,s)=>this.on(e,n,r,s),off:(e,n,r,s)=>this.off(e,n,r,s),offById:e=>this.offById(e)}}on(e,n,r,s){return this.listeners.on(e,n,r,s)}off(e,n,r,s){this.listeners.off(e,n,r,s)}offById(e){this.listeners.offById(e)}}var jr={},jb={get exports(){return jr},set exports(l){jr=l}};(function(l,e){(function(n,r){l.exports=r()})(window,function(){return function(n){var r={};function s(c){if(r[c])return r[c].exports;var h=r[c]={i:c,l:!1,exports:{}};return n[c].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=n,s.c=r,s.d=function(c,h,f){s.o(c,h)||Object.defineProperty(c,h,{enumerable:!0,get:f})},s.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},s.t=function(c,h){if(1&h&&(c=s(c)),8&h||4&h&&typeof c=="object"&&c&&c.__esModule)return c;var f=Object.create(null);if(s.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:c}),2&h&&typeof c!="string")for(var g in c)s.d(f,g,(function(w){return c[w]}).bind(null,g));return f},s.n=function(c){var h=c&&c.__esModule?function(){return c.default}:function(){return c};return s.d(h,"a",h),h},s.o=function(c,h){return Object.prototype.hasOwnProperty.call(c,h)},s.p="/",s(s.s=0)}([function(n,r,s){s(1),n.exports=function(){var c=s(6),h="cdx-notify--bounce-in",f=null;return{show:function(g){if(g.message){(function(){if(f)return!0;f=c.getWrapper(),document.body.appendChild(f)})();var w=null,I=g.time||8e3;switch(g.type){case"confirm":w=c.confirm(g);break;case"prompt":w=c.prompt(g);break;default:w=c.alert(g),window.setTimeout(function(){w.remove()},I)}f.appendChild(w),w.classList.add(h)}}}}()},function(n,r,s){var c=s(2);typeof c=="string"&&(c=[[n.i,c,""]]);var h={hmr:!0,transform:void 0,insertInto:void 0};s(4)(c,h),c.locals&&(n.exports=c.locals)},function(n,r,s){(n.exports=s(3)(!1)).push([n.i,`.cdx-notify--error{background:#fffbfb!important}.cdx-notify--error::before{background:#fb5d5d!important}.cdx-notify__input{max-width:130px;padding:5px 10px;background:#f7f7f7;border:0;border-radius:3px;font-size:13px;color:#656b7c;outline:0}.cdx-notify__input:-ms-input-placeholder{color:#656b7c}.cdx-notify__input::placeholder{color:#656b7c}.cdx-notify__input:focus:-ms-input-placeholder{color:rgba(101,107,124,.3)}.cdx-notify__input:focus::placeholder{color:rgba(101,107,124,.3)}.cdx-notify__button{border:none;border-radius:3px;font-size:13px;padding:5px 10px;cursor:pointer}.cdx-notify__button:last-child{margin-left:10px}.cdx-notify__button--cancel{background:#f2f5f7;box-shadow:0 2px 1px 0 rgba(16,19,29,0);color:#656b7c}.cdx-notify__button--cancel:hover{background:#eee}.cdx-notify__button--confirm{background:#34c992;box-shadow:0 1px 1px 0 rgba(18,49,35,.05);color:#fff}.cdx-notify__button--confirm:hover{background:#33b082}.cdx-notify__btns-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;margin-top:5px}.cdx-notify__cross{position:absolute;top:5px;right:5px;width:10px;height:10px;padding:5px;opacity:.54;cursor:pointer}.cdx-notify__cross::after,.cdx-notify__cross::before{content:'';position:absolute;left:9px;top:5px;height:12px;width:2px;background:#575d67}.cdx-notify__cross::before{transform:rotate(-45deg)}.cdx-notify__cross::after{transform:rotate(45deg)}.cdx-notify__cross:hover{opacity:1}.cdx-notifies{position:fixed;z-index:2;bottom:20px;left:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.cdx-notify{position:relative;width:220px;margin-top:15px;padding:13px 16px;background:#fff;box-shadow:0 11px 17px 0 rgba(23,32,61,.13);border-radius:5px;font-size:14px;line-height:1.4em;word-wrap:break-word}.cdx-notify::before{content:'';position:absolute;display:block;top:0;left:0;width:3px;height:calc(100% - 6px);margin:3px;border-radius:5px;background:0 0}@keyframes bounceIn{0%{opacity:0;transform:scale(.3)}50%{opacity:1;transform:scale(1.05)}70%{transform:scale(.9)}100%{transform:scale(1)}}.cdx-notify--bounce-in{animation-name:bounceIn;animation-duration:.6s;animation-iteration-count:1}.cdx-notify--success{background:#fafffe!important}.cdx-notify--success::before{background:#41ffb1!important}`,""])},function(n,r){n.exports=function(s){var c=[];return c.toString=function(){return this.map(function(h){var f=function(g,w){var I=g[1]||"",E=g[3];if(!E)return I;if(w&&typeof btoa=="function"){var D=(T=E,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(T))))+" */"),U=E.sources.map(function(F){return"/*# sourceURL="+E.sourceRoot+F+" */"});return[I].concat(U).concat([D]).join(`
`)}var T;return[I].join(`
`)}(h,s);return h[2]?"@media "+h[2]+"{"+f+"}":f}).join("")},c.i=function(h,f){typeof h=="string"&&(h=[[null,h,""]]);for(var g={},w=0;w<this.length;w++){var I=this[w][0];typeof I=="number"&&(g[I]=!0)}for(w=0;w<h.length;w++){var E=h[w];typeof E[0]=="number"&&g[E[0]]||(f&&!E[2]?E[2]=f:f&&(E[2]="("+E[2]+") and ("+f+")"),c.push(E))}},c}},function(n,r,s){var c,h,f={},g=(c=function(){return window&&document&&document.all&&!window.atob},function(){return h===void 0&&(h=c.apply(this,arguments)),h}),w=function(y){var S={};return function(A){if(typeof A=="function")return A();if(S[A]===void 0){var R=(function(z){return document.querySelector(z)}).call(this,A);if(window.HTMLIFrameElement&&R instanceof window.HTMLIFrameElement)try{R=R.contentDocument.head}catch{R=null}S[A]=R}return S[A]}}(),I=null,E=0,D=[],U=s(5);function T(y,S){for(var A=0;A<y.length;A++){var R=y[A],z=f[R.id];if(z){z.refs++;for(var V=0;V<z.parts.length;V++)z.parts[V](R.parts[V]);for(;V<R.parts.length;V++)z.parts.push(G(R.parts[V],S))}else{var rt=[];for(V=0;V<R.parts.length;V++)rt.push(G(R.parts[V],S));f[R.id]={id:R.id,refs:1,parts:rt}}}}function F(y,S){for(var A=[],R={},z=0;z<y.length;z++){var V=y[z],rt=S.base?V[0]+S.base:V[0],j={css:V[1],media:V[2],sourceMap:V[3]};R[rt]?R[rt].parts.push(j):A.push(R[rt]={id:rt,parts:[j]})}return A}function P(y,S){var A=w(y.insertInto);if(!A)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var R=D[D.length-1];if(y.insertAt==="top")R?R.nextSibling?A.insertBefore(S,R.nextSibling):A.appendChild(S):A.insertBefore(S,A.firstChild),D.push(S);else if(y.insertAt==="bottom")A.appendChild(S);else{if(typeof y.insertAt!="object"||!y.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var z=w(y.insertInto+" "+y.insertAt.before);A.insertBefore(S,z)}}function it(y){if(y.parentNode===null)return!1;y.parentNode.removeChild(y);var S=D.indexOf(y);S>=0&&D.splice(S,1)}function kt(y){var S=document.createElement("style");return y.attrs.type===void 0&&(y.attrs.type="text/css"),Ot(S,y.attrs),P(y,S),S}function Ot(y,S){Object.keys(S).forEach(function(A){y.setAttribute(A,S[A])})}function G(y,S){var A,R,z,V;if(S.transform&&y.css){if(!(V=S.transform(y.css)))return function(){};y.css=V}if(S.singleton){var rt=E++;A=I||(I=kt(S)),R=$.bind(null,A,rt,!1),z=$.bind(null,A,rt,!0)}else y.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(A=function(j){var wt=document.createElement("link");return j.attrs.type===void 0&&(j.attrs.type="text/css"),j.attrs.rel="stylesheet",Ot(wt,j.attrs),P(j,wt),wt}(S),R=(function(j,wt,ht){var Tt=ht.css,Ut=ht.sourceMap,ft=wt.convertToAbsoluteUrls===void 0&&Ut;(wt.convertToAbsoluteUrls||ft)&&(Tt=U(Tt)),Ut&&(Tt+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(Ut))))+" */");var ut=new Blob([Tt],{type:"text/css"}),oe=j.href;j.href=URL.createObjectURL(ut),oe&&URL.revokeObjectURL(oe)}).bind(null,A,S),z=function(){it(A),A.href&&URL.revokeObjectURL(A.href)}):(A=kt(S),R=(function(j,wt){var ht=wt.css,Tt=wt.media;if(Tt&&j.setAttribute("media",Tt),j.styleSheet)j.styleSheet.cssText=ht;else{for(;j.firstChild;)j.removeChild(j.firstChild);j.appendChild(document.createTextNode(ht))}}).bind(null,A),z=function(){it(A)});return R(y),function(j){if(j){if(j.css===y.css&&j.media===y.media&&j.sourceMap===y.sourceMap)return;R(y=j)}else z()}}n.exports=function(y,S){if(typeof DEBUG<"u"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(S=S||{}).attrs=typeof S.attrs=="object"?S.attrs:{},S.singleton||typeof S.singleton=="boolean"||(S.singleton=g()),S.insertInto||(S.insertInto="head"),S.insertAt||(S.insertAt="bottom");var A=F(y,S);return T(A,S),function(R){for(var z=[],V=0;V<A.length;V++){var rt=A[V];(j=f[rt.id]).refs--,z.push(j)}for(R&&T(F(R,S),S),V=0;V<z.length;V++){var j;if((j=z[V]).refs===0){for(var wt=0;wt<j.parts.length;wt++)j.parts[wt]();delete f[j.id]}}}};var Y,Z=(Y=[],function(y,S){return Y[y]=S,Y.filter(Boolean).join(`
`)});function $(y,S,A,R){var z=A?"":R.css;if(y.styleSheet)y.styleSheet.cssText=Z(S,z);else{var V=document.createTextNode(z),rt=y.childNodes;rt[S]&&y.removeChild(rt[S]),rt.length?y.insertBefore(V,rt[S]):y.appendChild(V)}}},function(n,r){n.exports=function(s){var c=typeof window<"u"&&window.location;if(!c)throw new Error("fixUrls requires window.location");if(!s||typeof s!="string")return s;var h=c.protocol+"//"+c.host,f=h+c.pathname.replace(/\/[^\/]*$/,"/");return s.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(g,w){var I,E=w.trim().replace(/^"(.*)"$/,function(D,U){return U}).replace(/^'(.*)'$/,function(D,U){return U});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(E)?g:(I=E.indexOf("//")===0?E:E.indexOf("/")===0?h+E:f+E.replace(/^\.\//,""),"url("+JSON.stringify(I)+")")})}},function(n,r,s){var c,h,f,g,w,I,E,D,U;n.exports=(c="cdx-notifies",h="cdx-notify",f="cdx-notify__cross",g="cdx-notify__button--confirm",w="cdx-notify__button--cancel",I="cdx-notify__input",E="cdx-notify__button",D="cdx-notify__btns-wrapper",{alert:U=function(T){var F=document.createElement("DIV"),P=document.createElement("DIV"),it=T.message,kt=T.style;return F.classList.add(h),kt&&F.classList.add(h+"--"+kt),F.innerHTML=it,P.classList.add(f),P.addEventListener("click",F.remove.bind(F)),F.appendChild(P),F},confirm:function(T){var F=U(T),P=document.createElement("div"),it=document.createElement("button"),kt=document.createElement("button"),Ot=F.querySelector("."+f),G=T.cancelHandler,Y=T.okHandler;return P.classList.add(D),it.innerHTML=T.okText||"Confirm",kt.innerHTML=T.cancelText||"Cancel",it.classList.add(E),kt.classList.add(E),it.classList.add(g),kt.classList.add(w),G&&typeof G=="function"&&(kt.addEventListener("click",G),Ot.addEventListener("click",G)),Y&&typeof Y=="function"&&it.addEventListener("click",Y),it.addEventListener("click",F.remove.bind(F)),kt.addEventListener("click",F.remove.bind(F)),P.appendChild(it),P.appendChild(kt),F.appendChild(P),F},prompt:function(T){var F=U(T),P=document.createElement("div"),it=document.createElement("button"),kt=document.createElement("input"),Ot=F.querySelector("."+f),G=T.cancelHandler,Y=T.okHandler;return P.classList.add(D),it.innerHTML=T.okText||"Ok",it.classList.add(E),it.classList.add(g),kt.classList.add(I),T.placeholder&&kt.setAttribute("placeholder",T.placeholder),T.default&&(kt.value=T.default),T.inputType&&(kt.type=T.inputType),G&&typeof G=="function"&&Ot.addEventListener("click",G),Y&&typeof Y=="function"&&it.addEventListener("click",function(){Y(kt.value)}),it.addEventListener("click",F.remove.bind(F)),P.appendChild(kt),P.appendChild(it),F.appendChild(P),F},getWrapper:function(){var T=document.createElement("DIV");return T.classList.add(c),T}})}])})})(jb);const Xb=Qr(jr);class Zb{show(e){Xb.show(e)}}class Vb extends bt{constructor({config:e,eventsDispatcher:n}){super({config:e,eventsDispatcher:n}),this.notifier=new Zb}get methods(){return{show:e=>this.show(e)}}show(e){return this.notifier.show(e)}}class Jb extends bt{get methods(){const e=()=>this.isEnabled;return{toggle:n=>this.toggle(n),get isEnabled(){return e()}}}toggle(e){return this.Editor.ReadOnly.toggle(e)}get isEnabled(){return this.Editor.ReadOnly.isEnabled}}var Xr={},Qb={get exports(){return Xr},set exports(l){Xr=l}};(function(l,e){(function(n,r){l.exports=r()})(xb,function(){function n(E){var D=E.tags,U=Object.keys(D),T=U.map(function(F){return typeof D[F]}).every(function(F){return F==="object"||F==="boolean"||F==="function"});if(!T)throw new Error("The configuration was invalid");this.config=E}var r=["P","LI","TD","TH","DIV","H1","H2","H3","H4","H5","H6","PRE"];function s(E){return r.indexOf(E.nodeName)!==-1}var c=["A","B","STRONG","I","EM","SUB","SUP","U","STRIKE"];function h(E){return c.indexOf(E.nodeName)!==-1}n.prototype.clean=function(E){const D=document.implementation.createHTMLDocument(),U=D.createElement("div");return U.innerHTML=E,this._sanitize(D,U),U.innerHTML},n.prototype._sanitize=function(E,D){var U=f(E,D),T=U.firstChild();if(T)do{if(T.nodeType===Node.TEXT_NODE)if(T.data.trim()===""&&(T.previousElementSibling&&s(T.previousElementSibling)||T.nextElementSibling&&s(T.nextElementSibling))){D.removeChild(T),this._sanitize(E,D);break}else continue;if(T.nodeType===Node.COMMENT_NODE){D.removeChild(T),this._sanitize(E,D);break}var F=h(T),P;F&&(P=Array.prototype.some.call(T.childNodes,s));var it=!!D.parentNode,kt=s(D)&&s(T)&&it,Ot=T.nodeName.toLowerCase(),G=g(this.config,Ot,T),Y=F&&P;if(Y||w(T,G)||!this.config.keepNestedBlockElements&&kt){if(!(T.nodeName==="SCRIPT"||T.nodeName==="STYLE"))for(;T.childNodes.length>0;)D.insertBefore(T.childNodes[0],T);D.removeChild(T),this._sanitize(E,D);break}for(var Z=0;Z<T.attributes.length;Z+=1){var $=T.attributes[Z];I($,G,T)&&(T.removeAttribute($.name),Z=Z-1)}this._sanitize(E,T)}while(T=U.nextSibling())};function f(E,D){return E.createTreeWalker(D,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,null,!1)}function g(E,D,U){return typeof E.tags[D]=="function"?E.tags[D](U):E.tags[D]}function w(E,D){return typeof D>"u"?!0:typeof D=="boolean"?!D:!1}function I(E,D,U){var T=E.name.toLowerCase();return D===!0?!1:typeof D[T]=="function"?!D[T](E.value,U):typeof D[T]>"u"||D[T]===!1?!0:typeof D[T]=="string"?D[T]!==E.value:!1}return n})})(Qb);const tv=Xr;function bc(l,e){return l.map(n=>{const r=Mt(e)?e(n.tool):e;return Le(r)||(n.data=ns(n.data,r)),n})}function Je(l,e={}){const n={tags:e};return new tv(n).clean(l)}function ns(l,e){return Array.isArray(l)?ev(l,e):jt(l)?nv(l,e):gn(l)?ov(l,e):l}function ev(l,e){return l.map(n=>ns(n,e))}function nv(l,e){const n={};for(const r in l){if(!Object.prototype.hasOwnProperty.call(l,r))continue;const s=l[r],c=iv(e[r])?e[r]:e;n[r]=ns(s,c)}return n}function ov(l,e){return jt(e)?Je(l,e):e===!1?Je(l,{}):l}function iv(l){return jt(l)||Sb(l)||Mt(l)}class rv extends bt{get methods(){return{clean:(e,n)=>this.clean(e,n)}}clean(e,n){return Je(e,n)}}class sv extends bt{get methods(){return{save:()=>this.save()}}save(){const e="Editor's content can not be saved in read-only mode";return this.Editor.ReadOnly.isEnabled?(Ne(e,"warn"),Promise.reject(new Error(e))):this.Editor.Saver.save()}}class av extends bt{get methods(){return{findParentTag:(e,n)=>this.findParentTag(e,n),expandToTag:e=>this.expandToTag(e)}}findParentTag(e,n){return new nt().findParentTag(e,n)}expandToTag(e){new nt().expandToTag(e)}}class lv extends bt{get classes(){return{block:"cdx-block",inlineToolButton:"ce-inline-tool",inlineToolButtonActive:"ce-inline-tool--active",input:"cdx-input",loader:"cdx-loader",button:"cdx-button",settingsButton:"cdx-settings-button",settingsButtonActive:"cdx-settings-button--active"}}}class cv extends bt{get methods(){return{close:()=>this.close(),open:()=>this.open(),toggleBlockSettings:e=>this.toggleBlockSettings(e),toggleToolbox:e=>this.toggleToolbox(e)}}open(){this.Editor.Toolbar.moveAndOpen()}close(){this.Editor.Toolbar.close()}toggleBlockSettings(e){if(this.Editor.BlockManager.currentBlockIndex===-1){Ne("Could't toggle the Toolbar because there is no block selected ","warn");return}e??!this.Editor.BlockSettings.opened?(this.Editor.Toolbar.moveAndOpen(),this.Editor.BlockSettings.open()):this.Editor.BlockSettings.close()}toggleToolbox(e){if(this.Editor.BlockManager.currentBlockIndex===-1){Ne("Could't toggle the Toolbox because there is no block selected ","warn");return}e??!this.Editor.Toolbar.toolbox.opened?(this.Editor.Toolbar.moveAndOpen(),this.Editor.Toolbar.toolbox.open()):this.Editor.Toolbar.toolbox.close()}}var Zr={},dv={get exports(){return Zr},set exports(l){Zr=l}};/*!
 * CodeX.Tooltips
 * 
 * @version 1.0.5
 * 
 * @licence MIT
 * @author CodeX <https://codex.so>
 * 
 * 
 */(function(l,e){(function(n,r){l.exports=r()})(window,function(){return function(n){var r={};function s(c){if(r[c])return r[c].exports;var h=r[c]={i:c,l:!1,exports:{}};return n[c].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=n,s.c=r,s.d=function(c,h,f){s.o(c,h)||Object.defineProperty(c,h,{enumerable:!0,get:f})},s.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},s.t=function(c,h){if(1&h&&(c=s(c)),8&h||4&h&&typeof c=="object"&&c&&c.__esModule)return c;var f=Object.create(null);if(s.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:c}),2&h&&typeof c!="string")for(var g in c)s.d(f,g,(function(w){return c[w]}).bind(null,g));return f},s.n=function(c){var h=c&&c.__esModule?function(){return c.default}:function(){return c};return s.d(h,"a",h),h},s.o=function(c,h){return Object.prototype.hasOwnProperty.call(c,h)},s.p="",s(s.s=0)}([function(n,r,s){n.exports=s(1)},function(n,r,s){s.r(r),s.d(r,"default",function(){return c});class c{constructor(){this.nodes={wrapper:null,content:null},this.showed=!1,this.offsetTop=10,this.offsetLeft=10,this.offsetRight=10,this.hidingDelay=0,this.handleWindowScroll=()=>{this.showed&&this.hide(!0)},this.loadStyles(),this.prepare(),window.addEventListener("scroll",this.handleWindowScroll,{passive:!0})}get CSS(){return{tooltip:"ct",tooltipContent:"ct__content",tooltipShown:"ct--shown",placement:{left:"ct--left",bottom:"ct--bottom",right:"ct--right",top:"ct--top"}}}show(f,g,w){this.nodes.wrapper||this.prepare(),this.hidingTimeout&&clearTimeout(this.hidingTimeout);const I=Object.assign({placement:"bottom",marginTop:0,marginLeft:0,marginRight:0,marginBottom:0,delay:70,hidingDelay:0},w);if(I.hidingDelay&&(this.hidingDelay=I.hidingDelay),this.nodes.content.innerHTML="",typeof g=="string")this.nodes.content.appendChild(document.createTextNode(g));else{if(!(g instanceof Node))throw Error("[CodeX Tooltip] Wrong type of «content» passed. It should be an instance of Node or String. But "+typeof g+" given.");this.nodes.content.appendChild(g)}switch(this.nodes.wrapper.classList.remove(...Object.values(this.CSS.placement)),I.placement){case"top":this.placeTop(f,I);break;case"left":this.placeLeft(f,I);break;case"right":this.placeRight(f,I);break;case"bottom":default:this.placeBottom(f,I)}I&&I.delay?this.showingTimeout=setTimeout(()=>{this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0},I.delay):(this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0)}hide(f=!1){if(this.hidingDelay&&!f)return this.hidingTimeout&&clearTimeout(this.hidingTimeout),void(this.hidingTimeout=setTimeout(()=>{this.hide(!0)},this.hidingDelay));this.nodes.wrapper.classList.remove(this.CSS.tooltipShown),this.showed=!1,this.showingTimeout&&clearTimeout(this.showingTimeout)}onHover(f,g,w){f.addEventListener("mouseenter",()=>{this.show(f,g,w)}),f.addEventListener("mouseleave",()=>{this.hide()})}destroy(){this.nodes.wrapper.remove(),window.removeEventListener("scroll",this.handleWindowScroll)}prepare(){this.nodes.wrapper=this.make("div",this.CSS.tooltip),this.nodes.content=this.make("div",this.CSS.tooltipContent),this.append(this.nodes.wrapper,this.nodes.content),this.append(document.body,this.nodes.wrapper)}loadStyles(){const f="codex-tooltips-style";if(document.getElementById(f))return;const g=s(2),w=this.make("style",null,{textContent:g.toString(),id:f});this.prepend(document.head,w)}placeBottom(f,g){const w=f.getBoundingClientRect(),I=w.left+f.clientWidth/2-this.nodes.wrapper.offsetWidth/2,E=w.bottom+window.pageYOffset+this.offsetTop+g.marginTop;this.applyPlacement("bottom",I,E)}placeTop(f,g){const w=f.getBoundingClientRect(),I=w.left+f.clientWidth/2-this.nodes.wrapper.offsetWidth/2,E=w.top+window.pageYOffset-this.nodes.wrapper.clientHeight-this.offsetTop;this.applyPlacement("top",I,E)}placeLeft(f,g){const w=f.getBoundingClientRect(),I=w.left-this.nodes.wrapper.offsetWidth-this.offsetLeft-g.marginLeft,E=w.top+window.pageYOffset+f.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("left",I,E)}placeRight(f,g){const w=f.getBoundingClientRect(),I=w.right+this.offsetRight+g.marginRight,E=w.top+window.pageYOffset+f.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("right",I,E)}applyPlacement(f,g,w){this.nodes.wrapper.classList.add(this.CSS.placement[f]),this.nodes.wrapper.style.left=g+"px",this.nodes.wrapper.style.top=w+"px"}make(f,g=null,w={}){const I=document.createElement(f);Array.isArray(g)?I.classList.add(...g):g&&I.classList.add(g);for(const E in w)w.hasOwnProperty(E)&&(I[E]=w[E]);return I}append(f,g){Array.isArray(g)?g.forEach(w=>f.appendChild(w)):f.appendChild(g)}prepend(f,g){Array.isArray(g)?(g=g.reverse()).forEach(w=>f.prepend(w)):f.prepend(g)}}},function(n,r){n.exports=`.ct{z-index:999;opacity:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;-webkit-transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1),-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);will-change:opacity,top,left;-webkit-box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);border-radius:9px}.ct,.ct:before{position:absolute;top:0;left:0}.ct:before{content:"";bottom:0;right:0;background-color:#1d202b;z-index:-1;border-radius:4px}@supports(-webkit-mask-box-image:url("")){.ct:before{border-radius:0;-webkit-mask-box-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M10.71 0h2.58c3.02 0 4.64.42 6.1 1.2a8.18 8.18 0 013.4 3.4C23.6 6.07 24 7.7 24 10.71v2.58c0 3.02-.42 4.64-1.2 6.1a8.18 8.18 0 01-3.4 3.4c-1.47.8-3.1 1.21-6.11 1.21H10.7c-3.02 0-4.64-.42-6.1-1.2a8.18 8.18 0 01-3.4-3.4C.4 17.93 0 16.3 0 13.29V10.7c0-3.02.42-4.64 1.2-6.1a8.18 8.18 0 013.4-3.4C6.07.4 7.7 0 10.71 0z"/></svg>') 48% 41% 37.9% 53.3%}}@media (--mobile){.ct{display:none}}.ct__content{padding:6px 10px;color:#cdd1e0;font-size:12px;text-align:center;letter-spacing:.02em;line-height:1em}.ct:after{content:"";width:8px;height:8px;position:absolute;background-color:#1d202b;z-index:-1}.ct--bottom{-webkit-transform:translateY(5px);transform:translateY(5px)}.ct--bottom:after{top:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--top{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.ct--top:after{top:auto;bottom:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--left{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.ct--left:after{top:50%;left:auto;right:0;-webkit-transform:translate(41.6%,-50%) rotate(-45deg);transform:translate(41.6%,-50%) rotate(-45deg)}.ct--right{-webkit-transform:translateX(5px);transform:translateX(5px)}.ct--right:after{top:50%;left:0;-webkit-transform:translate(-41.6%,-50%) rotate(-45deg);transform:translate(-41.6%,-50%) rotate(-45deg)}.ct--shown{opacity:1;-webkit-transform:none;transform:none}`}]).default})})(dv);const hv=Qr(Zr);let Pe=null;function os(){Pe||(Pe=new hv)}function uv(l,e,n){os(),Pe==null||Pe.show(l,e,n)}function Vr(l=!1){os(),Pe==null||Pe.hide(l)}function wo(l,e,n){os(),Pe==null||Pe.onHover(l,e,n)}function pv(){Pe==null||Pe.destroy(),Pe=null}class fv extends bt{constructor({config:e,eventsDispatcher:n}){super({config:e,eventsDispatcher:n})}get methods(){return{show:(e,n,r)=>this.show(e,n,r),hide:()=>this.hide(),onHover:(e,n,r)=>this.onHover(e,n,r)}}show(e,n,r){uv(e,n,r)}hide(){Vr()}onHover(e,n,r){wo(e,n,r)}}class gv extends bt{get methods(){return{nodes:this.editorNodes}}get editorNodes(){return{wrapper:this.Editor.UI.nodes.wrapper,redactor:this.Editor.UI.nodes.redactor}}}function vc(l,e){const n={};return Object.entries(l).forEach(([r,s])=>{if(jt(s)){const c=e?`${e}.${r}`:r;Object.values(s).every(h=>gn(h))?n[r]=c:n[r]=vc(s,c);return}n[r]=s}),n}const De=vc(hc);function mv(l,e){const n={};return Object.keys(l).forEach(r=>{const s=e[r];s!==void 0?n[s]=l[r]:n[r]=l[r]}),n}const bv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M9 12L9 7.1C9 7.04477 9.04477 7 9.1 7H10.4C11.5 7 14 7.1 14 9.5C14 9.5 14 12 11 12M9 12V16.8C9 16.9105 9.08954 17 9.2 17H12.5C14 17 15 16 15 14.5C15 11.7046 11 12 11 12M9 12H11"/></svg>',kc='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 10L11.8586 14.8586C11.9367 14.9367 12.0633 14.9367 12.1414 14.8586L17 10"/></svg>',vv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 15L11.8586 10.1414C11.9367 10.0633 12.0633 10.0633 12.1414 10.1414L17 15"/></svg>',kv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 8L12 12M12 12L16 16M12 12L16 8M12 12L8 16"/></svg>',wv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/></svg>',xv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M13.34 10C12.4223 12.7337 11 17 11 17"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M14.21 7H14.2"/></svg>',jl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.69998 12.6L7.67896 12.62C6.53993 13.7048 6.52012 15.5155 7.63516 16.625V16.625C8.72293 17.7073 10.4799 17.7102 11.5712 16.6314L13.0263 15.193C14.0703 14.1609 14.2141 12.525 13.3662 11.3266L13.22 11.12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16.22 11.12L16.3564 10.9805C17.2895 10.0265 17.3478 8.5207 16.4914 7.49733V7.49733C15.5691 6.39509 13.9269 6.25143 12.8271 7.17675L11.3901 8.38588C10.0935 9.47674 9.95706 11.4241 11.0888 12.6852L11.12 12.72"/></svg>',yv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.40999 7.29999H9.4"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 7.29999H14.59"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.30999 12H9.3"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 12H14.59"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.40999 16.7H9.4"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 16.7H14.59"/></svg>',Cv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M12 7V12M12 17V12M17 12H12M12 12H7"/></svg>',Ev='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><circle cx="10.5" cy="10.5" r="5.5" stroke="currentColor" stroke-width="2"/><line x1="15.4142" x2="19" y1="15" y2="18.5858" stroke="currentColor" stroke-linecap="round" stroke-width="2"/></svg>',Sv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M15.7795 11.5C15.7795 11.5 16.053 11.1962 16.5497 10.6722C17.4442 9.72856 17.4701 8.2475 16.5781 7.30145V7.30145C15.6482 6.31522 14.0873 6.29227 13.1288 7.25073L11.8796 8.49999"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8.24517 12.3883C8.24517 12.3883 7.97171 12.6922 7.47504 13.2161C6.58051 14.1598 6.55467 15.6408 7.44666 16.5869V16.5869C8.37653 17.5731 9.93744 17.5961 10.8959 16.6376L12.1452 15.3883"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M17.7802 15.1032L16.597 14.9422C16.0109 14.8624 15.4841 15.3059 15.4627 15.8969L15.4199 17.0818"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6.39064 9.03238L7.58432 9.06668C8.17551 9.08366 8.6522 8.58665 8.61056 7.99669L8.5271 6.81397"/><line x1="12.1142" x2="11.7" y1="12.2" y2="11.7858" stroke="currentColor" stroke-linecap="round" stroke-width="2"/></svg>',Tv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/><line x1="12" x2="12" y1="9" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M12 15.02V15.01"/></svg>';let Xl=class $t{constructor(e){this.nodes={root:null,icon:null},this.confirmationState=null,this.removeSpecialFocusBehavior=()=>{this.nodes.root.classList.remove($t.CSS.noFocus)},this.removeSpecialHoverBehavior=()=>{this.nodes.root.classList.remove($t.CSS.noHover)},this.onErrorAnimationEnd=()=>{this.nodes.icon.classList.remove($t.CSS.wobbleAnimation),this.nodes.icon.removeEventListener("animationend",this.onErrorAnimationEnd)},this.params=e,this.nodes.root=this.make(e)}get isDisabled(){return this.params.isDisabled}get toggle(){return this.params.toggle}get title(){return this.params.title}get closeOnActivate(){return this.params.closeOnActivate}get isConfirmationStateEnabled(){return this.confirmationState!==null}get isFocused(){return this.nodes.root.classList.contains($t.CSS.focused)}static get CSS(){return{container:"ce-popover-item",title:"ce-popover-item__title",secondaryTitle:"ce-popover-item__secondary-title",icon:"ce-popover-item__icon",active:"ce-popover-item--active",disabled:"ce-popover-item--disabled",focused:"ce-popover-item--focused",hidden:"ce-popover-item--hidden",confirmationState:"ce-popover-item--confirmation",noHover:"ce-popover-item--no-hover",noFocus:"ce-popover-item--no-focus",wobbleAnimation:"wobble"}}getElement(){return this.nodes.root}handleClick(){if(this.isConfirmationStateEnabled){this.activateOrEnableConfirmationMode(this.confirmationState);return}this.activateOrEnableConfirmationMode(this.params)}toggleActive(e){this.nodes.root.classList.toggle($t.CSS.active,e)}toggleHidden(e){this.nodes.root.classList.toggle($t.CSS.hidden,e)}reset(){this.isConfirmationStateEnabled&&this.disableConfirmationMode()}onFocus(){this.disableSpecialHoverAndFocusBehavior()}make(e){const n=C.make("div",$t.CSS.container);return e.name&&(n.dataset.itemName=e.name),this.nodes.icon=C.make("div",$t.CSS.icon,{innerHTML:e.icon||wv}),n.appendChild(this.nodes.icon),n.appendChild(C.make("div",$t.CSS.title,{innerHTML:e.title||""})),e.secondaryLabel&&n.appendChild(C.make("div",$t.CSS.secondaryTitle,{textContent:e.secondaryLabel})),e.isActive&&n.classList.add($t.CSS.active),e.isDisabled&&n.classList.add($t.CSS.disabled),n}enableConfirmationMode(e){const n={...this.params,...e,confirmation:e.confirmation},r=this.make(n);this.nodes.root.innerHTML=r.innerHTML,this.nodes.root.classList.add($t.CSS.confirmationState),this.confirmationState=e,this.enableSpecialHoverAndFocusBehavior()}disableConfirmationMode(){const e=this.make(this.params);this.nodes.root.innerHTML=e.innerHTML,this.nodes.root.classList.remove($t.CSS.confirmationState),this.confirmationState=null,this.disableSpecialHoverAndFocusBehavior()}enableSpecialHoverAndFocusBehavior(){this.nodes.root.classList.add($t.CSS.noHover),this.nodes.root.classList.add($t.CSS.noFocus),this.nodes.root.addEventListener("mouseleave",this.removeSpecialHoverBehavior,{once:!0})}disableSpecialHoverAndFocusBehavior(){this.removeSpecialFocusBehavior(),this.removeSpecialHoverBehavior(),this.nodes.root.removeEventListener("mouseleave",this.removeSpecialHoverBehavior)}activateOrEnableConfirmationMode(e){if(e.confirmation===void 0)try{e.onActivate(e),this.disableConfirmationMode()}catch{this.animateError()}else this.enableConfirmationMode(e.confirmation)}animateError(){this.nodes.icon.classList.contains($t.CSS.wobbleAnimation)||(this.nodes.icon.classList.add($t.CSS.wobbleAnimation),this.nodes.icon.addEventListener("animationend",this.onErrorAnimationEnd))}};const mo=class{constructor(l,e){this.cursor=-1,this.items=[],this.items=l||[],this.focusedCssClass=e}get currentItem(){return this.cursor===-1?null:this.items[this.cursor]}setCursor(l){l<this.items.length&&l>=-1&&(this.dropCursor(),this.cursor=l,this.items[this.cursor].classList.add(this.focusedCssClass))}setItems(l){this.items=l}next(){this.cursor=this.leafNodesAndReturnIndex(mo.directions.RIGHT)}previous(){this.cursor=this.leafNodesAndReturnIndex(mo.directions.LEFT)}dropCursor(){this.cursor!==-1&&(this.items[this.cursor].classList.remove(this.focusedCssClass),this.cursor=-1)}leafNodesAndReturnIndex(l){if(this.items.length===0)return this.cursor;let e=this.cursor;return e===-1?e=l===mo.directions.RIGHT?-1:0:this.items[e].classList.remove(this.focusedCssClass),l===mo.directions.RIGHT?e=(e+1)%this.items.length:e=(this.items.length+e-1)%this.items.length,C.canSetCaret(this.items[e])&&gi(()=>nt.setCursor(this.items[e]),50)(),this.items[e].classList.add(this.focusedCssClass),e}};let Yn=mo;Yn.directions={RIGHT:"right",LEFT:"left"};class Qe{constructor(e){this.iterator=null,this.activated=!1,this.flipCallbacks=[],this.onKeyDown=n=>{if(this.isEventReadyForHandling(n))switch(Qe.usedKeys.includes(n.keyCode)&&n.preventDefault(),n.keyCode){case ot.TAB:this.handleTabPress(n);break;case ot.LEFT:case ot.UP:this.flipLeft();break;case ot.RIGHT:case ot.DOWN:this.flipRight();break;case ot.ENTER:this.handleEnterPress(n);break}},this.iterator=new Yn(e.items,e.focusedItemClass),this.activateCallback=e.activateCallback,this.allowedKeys=e.allowedKeys||Qe.usedKeys}get isActivated(){return this.activated}static get usedKeys(){return[ot.TAB,ot.LEFT,ot.RIGHT,ot.ENTER,ot.UP,ot.DOWN]}activate(e,n){this.activated=!0,e&&this.iterator.setItems(e),n!==void 0&&this.iterator.setCursor(n),document.addEventListener("keydown",this.onKeyDown,!0)}deactivate(){this.activated=!1,this.dropCursor(),document.removeEventListener("keydown",this.onKeyDown)}focusFirst(){this.dropCursor(),this.flipRight()}flipLeft(){this.iterator.previous(),this.flipCallback()}flipRight(){this.iterator.next(),this.flipCallback()}hasFocus(){return!!this.iterator.currentItem}onFlip(e){this.flipCallbacks.push(e)}removeOnFlip(e){this.flipCallbacks=this.flipCallbacks.filter(n=>n!==e)}dropCursor(){this.iterator.dropCursor()}isEventReadyForHandling(e){return this.activated&&this.allowedKeys.includes(e.keyCode)}handleTabPress(e){switch(e.shiftKey?Yn.directions.LEFT:Yn.directions.RIGHT){case Yn.directions.RIGHT:this.flipRight();break;case Yn.directions.LEFT:this.flipLeft();break}}handleEnterPress(e){this.activated&&(this.iterator.currentItem&&(e.stopPropagation(),e.preventDefault(),this.iterator.currentItem.click()),Mt(this.activateCallback)&&this.activateCallback(this.iterator.currentItem))}flipCallback(){this.iterator.currentItem&&this.iterator.currentItem.scrollIntoViewIfNeeded(),this.flipCallbacks.forEach(e=>e())}}class vo{static get CSS(){return{wrapper:"cdx-search-field",icon:"cdx-search-field__icon",input:"cdx-search-field__input"}}constructor({items:e,onSearch:n,placeholder:r}){this.listeners=new ts,this.items=e,this.onSearch=n,this.render(r)}getElement(){return this.wrapper}focus(){this.input.focus()}clear(){this.input.value="",this.searchQuery="",this.onSearch("",this.foundItems)}destroy(){this.listeners.removeAll()}render(e){this.wrapper=C.make("div",vo.CSS.wrapper);const n=C.make("div",vo.CSS.icon,{innerHTML:Ev});this.input=C.make("input",vo.CSS.input,{placeholder:e,tabIndex:-1}),this.wrapper.appendChild(n),this.wrapper.appendChild(this.input),this.listeners.on(this.input,"input",()=>{this.searchQuery=this.input.value,this.onSearch(this.searchQuery,this.foundItems)})}get foundItems(){return this.items.filter(e=>this.checkItem(e))}checkItem(e){var n;const r=((n=e.title)==null?void 0:n.toLowerCase())||"",s=this.searchQuery.toLowerCase();return r.includes(s)}}const bo=class{lock(){ql?this.lockHard():document.body.classList.add(bo.CSS.scrollLocked)}unlock(){ql?this.unlockHard():document.body.classList.remove(bo.CSS.scrollLocked)}lockHard(){this.scrollPosition=window.pageYOffset,document.documentElement.style.setProperty("--window-scroll-offset",`${this.scrollPosition}px`),document.body.classList.add(bo.CSS.scrollLockedHard)}unlockHard(){document.body.classList.remove(bo.CSS.scrollLockedHard),this.scrollPosition!==null&&window.scrollTo(0,this.scrollPosition),this.scrollPosition=null}};let wc=bo;wc.CSS={scrollLocked:"ce-scroll-locked",scrollLockedHard:"ce-scroll-locked--hard"};var _v=Object.defineProperty,Bv=Object.getOwnPropertyDescriptor,Lv=(l,e,n,r)=>{for(var s=r>1?void 0:r?Bv(e,n):e,c=l.length-1,h;c>=0;c--)(h=l[c])&&(s=(r?h(e,n,s):h(s))||s);return r&&s&&_v(e,n,s),s},xo=(l=>(l.Close="close",l))(xo||{});const Gt=class extends ki{constructor(l){super(),this.scopeElement=document.body,this.listeners=new ts,this.scrollLocker=new wc,this.nodes={wrapper:null,popover:null,nothingFoundMessage:null,customContent:null,items:null,overlay:null},this.messages={nothingFound:"Nothing found",search:"Search"},this.onFlip=()=>{this.items.find(e=>e.isFocused).onFocus()},this.items=l.items.map(e=>new Xl(e)),l.scopeElement!==void 0&&(this.scopeElement=l.scopeElement),l.messages&&(this.messages={...this.messages,...l.messages}),l.customContentFlippableItems&&(this.customContentFlippableItems=l.customContentFlippableItems),this.make(),l.customContent&&this.addCustomContent(l.customContent),l.searchable&&this.addSearch(),this.initializeFlipper()}static get CSS(){return{popover:"ce-popover",popoverOpenTop:"ce-popover--open-top",popoverOpened:"ce-popover--opened",search:"ce-popover__search",nothingFoundMessage:"ce-popover__nothing-found-message",nothingFoundMessageDisplayed:"ce-popover__nothing-found-message--displayed",customContent:"ce-popover__custom-content",customContentHidden:"ce-popover__custom-content--hidden",items:"ce-popover__items",overlay:"ce-popover__overlay",overlayHidden:"ce-popover__overlay--hidden"}}getElement(){return this.nodes.wrapper}hasFocus(){return this.flipper.hasFocus()}show(){this.shouldOpenBottom||(this.nodes.popover.style.setProperty("--popover-height",this.height+"px"),this.nodes.popover.classList.add(Gt.CSS.popoverOpenTop)),this.nodes.overlay.classList.remove(Gt.CSS.overlayHidden),this.nodes.popover.classList.add(Gt.CSS.popoverOpened),this.flipper.activate(this.flippableElements),this.search!==void 0&&requestAnimationFrame(()=>{var l;(l=this.search)==null||l.focus()}),Tn()&&this.scrollLocker.lock()}hide(){this.nodes.popover.classList.remove(Gt.CSS.popoverOpened),this.nodes.popover.classList.remove(Gt.CSS.popoverOpenTop),this.nodes.overlay.classList.add(Gt.CSS.overlayHidden),this.flipper.deactivate(),this.items.forEach(l=>l.reset()),this.search!==void 0&&this.search.clear(),Tn()&&this.scrollLocker.unlock(),this.emit("close")}destroy(){this.flipper.deactivate(),this.listeners.removeAll(),Tn()&&this.scrollLocker.unlock()}make(){this.nodes.popover=C.make("div",[Gt.CSS.popover]),this.nodes.nothingFoundMessage=C.make("div",[Gt.CSS.nothingFoundMessage],{textContent:this.messages.nothingFound}),this.nodes.popover.appendChild(this.nodes.nothingFoundMessage),this.nodes.items=C.make("div",[Gt.CSS.items]),this.items.forEach(l=>{this.nodes.items.appendChild(l.getElement())}),this.nodes.popover.appendChild(this.nodes.items),this.listeners.on(this.nodes.popover,"click",l=>{const e=this.getTargetItem(l);e!==void 0&&this.handleItemClick(e)}),this.nodes.wrapper=C.make("div"),this.nodes.overlay=C.make("div",[Gt.CSS.overlay,Gt.CSS.overlayHidden]),this.listeners.on(this.nodes.overlay,"click",()=>{this.hide()}),this.nodes.wrapper.appendChild(this.nodes.overlay),this.nodes.wrapper.appendChild(this.nodes.popover)}addSearch(){this.search=new vo({items:this.items,placeholder:this.messages.search,onSearch:(e,n)=>{this.items.forEach(s=>{const c=!n.includes(s);s.toggleHidden(c)}),this.toggleNothingFoundMessage(n.length===0),this.toggleCustomContent(e!=="");const r=e===""?this.flippableElements:n.map(s=>s.getElement());this.flipper.isActivated&&(this.flipper.deactivate(),this.flipper.activate(r))}});const l=this.search.getElement();l.classList.add(Gt.CSS.search),this.nodes.popover.insertBefore(l,this.nodes.popover.firstChild)}addCustomContent(l){this.nodes.customContent=l,this.nodes.customContent.classList.add(Gt.CSS.customContent),this.nodes.popover.insertBefore(l,this.nodes.popover.firstChild)}getTargetItem(l){return this.items.find(e=>l.composedPath().includes(e.getElement()))}handleItemClick(l){l.isDisabled||(this.items.filter(e=>e!==l).forEach(e=>e.reset()),l.handleClick(),this.toggleItemActivenessIfNeeded(l),l.closeOnActivate&&this.hide())}initializeFlipper(){this.flipper=new Qe({items:this.flippableElements,focusedItemClass:Xl.CSS.focused,allowedKeys:[ot.TAB,ot.UP,ot.DOWN,ot.ENTER]}),this.flipper.onFlip(this.onFlip)}get flippableElements(){const l=this.items.map(e=>e.getElement());return(this.customContentFlippableItems||[]).concat(l)}get height(){let l=0;if(this.nodes.popover===null)return l;const e=this.nodes.popover.cloneNode(!0);return e.style.visibility="hidden",e.style.position="absolute",e.style.top="-1000px",e.classList.add(Gt.CSS.popoverOpened),document.body.appendChild(e),l=e.offsetHeight,e.remove(),l}get shouldOpenBottom(){const l=this.nodes.popover.getBoundingClientRect(),e=this.scopeElement.getBoundingClientRect(),n=this.height,r=l.top+n,s=l.top-n,c=Math.min(window.innerHeight,e.bottom);return s<e.top||r<=c}toggleNothingFoundMessage(l){this.nodes.nothingFoundMessage.classList.toggle(Gt.CSS.nothingFoundMessageDisplayed,l)}toggleCustomContent(l){var e;(e=this.nodes.customContent)==null||e.classList.toggle(Gt.CSS.customContentHidden,l)}toggleItemActivenessIfNeeded(l){if(l.toggle===!0&&l.toggleActive(),typeof l.toggle=="string"){const e=this.items.filter(n=>n.toggle===l.toggle);if(e.length===1){l.toggleActive();return}e.forEach(n=>{n.toggleActive(n===l)})}}};let is=Gt;Lv([jn],is.prototype,"height",1);class Iv extends bt{constructor(){super(...arguments),this.opened=!1,this.selection=new nt,this.onPopoverClose=()=>{this.close()}}get events(){return{opened:"block-settings-opened",closed:"block-settings-closed"}}get CSS(){return{settings:"ce-settings"}}get flipper(){var e;return(e=this.popover)==null?void 0:e.flipper}make(){this.nodes.wrapper=C.make("div",[this.CSS.settings])}destroy(){this.removeAllNodes()}open(e=this.Editor.BlockManager.currentBlock){this.opened=!0,this.selection.save(),this.Editor.BlockSelection.selectBlock(e),this.Editor.BlockSelection.clearCache();const[n,r]=e.getTunes();this.eventsDispatcher.emit(this.events.opened),this.popover=new is({searchable:!0,items:n.map(s=>this.resolveTuneAliases(s)),customContent:r,customContentFlippableItems:this.getControls(r),scopeElement:this.Editor.API.methods.ui.nodes.redactor,messages:{nothingFound:de.ui(De.ui.popover,"Nothing found"),search:de.ui(De.ui.popover,"Filter")}}),this.popover.on(xo.Close,this.onPopoverClose),this.nodes.wrapper.append(this.popover.getElement()),this.popover.show()}getElement(){return this.nodes.wrapper}close(){this.opened&&(this.opened=!1,nt.isAtEditor||this.selection.restore(),this.selection.clearSaved(),!this.Editor.CrossBlockSelection.isCrossBlockSelectionStarted&&this.Editor.BlockManager.currentBlock&&this.Editor.BlockSelection.unselectBlock(this.Editor.BlockManager.currentBlock),this.eventsDispatcher.emit(this.events.closed),this.popover&&(this.popover.off(xo.Close,this.onPopoverClose),this.popover.destroy(),this.popover.getElement().remove(),this.popover=null))}getControls(e){const{StylesAPI:n}=this.Editor,r=e.querySelectorAll(`.${n.classes.settingsButton}, ${C.allInputsSelector}`);return Array.from(r)}resolveTuneAliases(e){const n=mv(e,{label:"title"});return e.confirmation&&(n.confirmation=this.resolveTuneAliases(e.confirmation)),n}}class ke extends bt{constructor(){super(...arguments),this.opened=!1,this.tools=[],this.flipper=null,this.togglingCallback=null}static get CSS(){return{conversionToolbarWrapper:"ce-conversion-toolbar",conversionToolbarShowed:"ce-conversion-toolbar--showed",conversionToolbarTools:"ce-conversion-toolbar__tools",conversionToolbarLabel:"ce-conversion-toolbar__label",conversionTool:"ce-conversion-tool",conversionToolHidden:"ce-conversion-tool--hidden",conversionToolIcon:"ce-conversion-tool__icon",conversionToolSecondaryLabel:"ce-conversion-tool__secondary-label",conversionToolFocused:"ce-conversion-tool--focused",conversionToolActive:"ce-conversion-tool--active"}}make(){this.nodes.wrapper=C.make("div",[ke.CSS.conversionToolbarWrapper,...this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]]),this.nodes.tools=C.make("div",ke.CSS.conversionToolbarTools);const e=C.make("div",ke.CSS.conversionToolbarLabel,{textContent:de.ui(De.ui.inlineToolbar.converter,"Convert to")});return this.addTools(),this.enableFlipper(),C.append(this.nodes.wrapper,e),C.append(this.nodes.wrapper,this.nodes.tools),this.nodes.wrapper}destroy(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}toggle(e){this.opened?this.close():this.open(),Mt(e)&&(this.togglingCallback=e)}open(){this.filterTools(),this.opened=!0,this.nodes.wrapper.classList.add(ke.CSS.conversionToolbarShowed),window.requestAnimationFrame(()=>{this.flipper.activate(this.tools.map(e=>e.button).filter(e=>!e.classList.contains(ke.CSS.conversionToolHidden))),this.flipper.focusFirst(),Mt(this.togglingCallback)&&this.togglingCallback(!0)})}close(){this.opened=!1,this.flipper.deactivate(),this.nodes.wrapper.classList.remove(ke.CSS.conversionToolbarShowed),Mt(this.togglingCallback)&&this.togglingCallback(!1)}hasTools(){return this.tools.length===1?this.tools[0].name!==this.config.defaultBlock:!0}async replaceWithBlock(e,n){const{BlockManager:r,BlockSelection:s,InlineToolbar:c,Caret:h}=this.Editor;r.convert(this.Editor.BlockManager.currentBlock,e,n),s.clearSelection(),this.close(),c.close(),window.requestAnimationFrame(()=>{h.setToBlock(this.Editor.BlockManager.currentBlock,h.positions.END)})}addTools(){const e=this.Editor.Tools.blockTools;Array.from(e.entries()).forEach(([n,r])=>{var s;const c=r.conversionConfig;!c||!c.import||(s=r.toolbox)==null||s.forEach(h=>this.addToolIfValid(n,h))})}addToolIfValid(e,n){Le(n)||!n.icon||this.addTool(e,n)}addTool(e,n){var r;const s=C.make("div",[ke.CSS.conversionTool]),c=C.make("div",[ke.CSS.conversionToolIcon]);s.dataset.tool=e,c.innerHTML=n.icon,C.append(s,c),C.append(s,C.text(de.t(De.toolNames,n.title||qn(e))));const h=(r=this.Editor.Tools.blockTools.get(e))==null?void 0:r.shortcut;if(h){const f=C.make("span",ke.CSS.conversionToolSecondaryLabel,{innerText:vi(h)});C.append(s,f)}C.append(this.nodes.tools,s),this.tools.push({name:e,button:s,toolboxItem:n}),this.listeners.on(s,"click",async()=>{await this.replaceWithBlock(e,n.data)})}async filterTools(){const{currentBlock:e}=this.Editor.BlockManager,n=await e.getActiveToolboxEntry();function r(s,c){return s.icon===c.icon&&s.title===c.title}this.tools.forEach(s=>{let c=!1;if(n){const h=r(n,s.toolboxItem);c=s.button.dataset.tool===e.name&&h}s.button.hidden=c,s.button.classList.toggle(ke.CSS.conversionToolHidden,c)})}enableFlipper(){this.flipper=new Qe({focusedItemClass:ke.CSS.conversionToolFocused})}}var Jr={},Av={get exports(){return Jr},set exports(l){Jr=l}};/*!
 * Library for handling keyboard shortcuts
 * @copyright CodeX (https://codex.so)
 * @license MIT
 * @author CodeX (https://codex.so)
 * @version 1.2.0
 */(function(l,e){(function(n,r){l.exports=r()})(window,function(){return function(n){var r={};function s(c){if(r[c])return r[c].exports;var h=r[c]={i:c,l:!1,exports:{}};return n[c].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=n,s.c=r,s.d=function(c,h,f){s.o(c,h)||Object.defineProperty(c,h,{enumerable:!0,get:f})},s.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},s.t=function(c,h){if(1&h&&(c=s(c)),8&h||4&h&&typeof c=="object"&&c&&c.__esModule)return c;var f=Object.create(null);if(s.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:c}),2&h&&typeof c!="string")for(var g in c)s.d(f,g,(function(w){return c[w]}).bind(null,g));return f},s.n=function(c){var h=c&&c.__esModule?function(){return c.default}:function(){return c};return s.d(h,"a",h),h},s.o=function(c,h){return Object.prototype.hasOwnProperty.call(c,h)},s.p="",s(s.s=0)}([function(n,r,s){function c(g,w){for(var I=0;I<w.length;I++){var E=w[I];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(g,E.key,E)}}function h(g,w,I){return w&&c(g.prototype,w),I&&c(g,I),g}s.r(r);var f=function(){function g(w){var I=this;(function(E,D){if(!(E instanceof D))throw new TypeError("Cannot call a class as a function")})(this,g),this.commands={},this.keys={},this.name=w.name,this.parseShortcutName(w.name),this.element=w.on,this.callback=w.callback,this.executeShortcut=function(E){I.execute(E)},this.element.addEventListener("keydown",this.executeShortcut,!1)}return h(g,null,[{key:"supportedCommands",get:function(){return{SHIFT:["SHIFT"],CMD:["CMD","CONTROL","COMMAND","WINDOWS","CTRL"],ALT:["ALT","OPTION"]}}},{key:"keyCodes",get:function(){return{0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,BACKSPACE:8,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,".":190}}}]),h(g,[{key:"parseShortcutName",value:function(w){w=w.split("+");for(var I=0;I<w.length;I++){w[I]=w[I].toUpperCase();var E=!1;for(var D in g.supportedCommands)if(g.supportedCommands[D].includes(w[I])){E=this.commands[D]=!0;break}E||(this.keys[w[I]]=!0)}for(var U in g.supportedCommands)this.commands[U]||(this.commands[U]=!1)}},{key:"execute",value:function(w){var I,E={CMD:w.ctrlKey||w.metaKey,SHIFT:w.shiftKey,ALT:w.altKey},D=!0;for(I in this.commands)this.commands[I]!==E[I]&&(D=!1);var U,T=!0;for(U in this.keys)T=T&&w.keyCode===g.keyCodes[U];D&&T&&this.callback(w)}},{key:"remove",value:function(){this.element.removeEventListener("keydown",this.executeShortcut)}}]),g}();r.default=f}]).default})})(Av);const Mv=Qr(Jr);class Ov{constructor(){this.registeredShortcuts=new Map}add(e){if(this.findShortcut(e.on,e.name))throw Error(`Shortcut ${e.name} is already registered for ${e.on}. Please remove it before add a new handler.`);const n=new Mv({name:e.name,on:e.on,callback:e.handler}),r=this.registeredShortcuts.get(e.on)||[];this.registeredShortcuts.set(e.on,[...r,n])}remove(e,n){const r=this.findShortcut(e,n);if(!r)return;r.remove();const s=this.registeredShortcuts.get(e);this.registeredShortcuts.set(e,s.filter(c=>c!==r))}findShortcut(e,n){return(this.registeredShortcuts.get(e)||[]).find(({name:r})=>r===n)}}const Gn=new Ov;var Rv=Object.defineProperty,Nv=Object.getOwnPropertyDescriptor,xc=(l,e,n,r)=>{for(var s=r>1?void 0:r?Nv(e,n):e,c=l.length-1,h;c>=0;c--)(h=l[c])&&(s=(r?h(e,n,s):h(s))||s);return r&&s&&Rv(e,n,s),s},pi=(l=>(l.Opened="toolbox-opened",l.Closed="toolbox-closed",l.BlockAdded="toolbox-block-added",l))(pi||{});const yc=class extends ki{constructor({api:l,tools:e,i18nLabels:n}){super(),this.opened=!1,this.nodes={toolbox:null},this.onPopoverClose=()=>{this.opened=!1,this.emit("toolbox-closed")},this.api=l,this.tools=e,this.i18nLabels=n}get isEmpty(){return this.toolsToBeDisplayed.length===0}static get CSS(){return{toolbox:"ce-toolbox"}}make(){return this.popover=new is({scopeElement:this.api.ui.nodes.redactor,searchable:!0,messages:{nothingFound:this.i18nLabels.nothingFound,search:this.i18nLabels.filter},items:this.toolboxItemsToBeDisplayed}),this.popover.on(xo.Close,this.onPopoverClose),this.enableShortcuts(),this.nodes.toolbox=this.popover.getElement(),this.nodes.toolbox.classList.add(yc.CSS.toolbox),this.nodes.toolbox}hasFocus(){var l;return(l=this.popover)==null?void 0:l.hasFocus()}destroy(){var l;super.destroy(),this.nodes&&this.nodes.toolbox&&(this.nodes.toolbox.remove(),this.nodes.toolbox=null),this.removeAllShortcuts(),(l=this.popover)==null||l.off(xo.Close,this.onPopoverClose)}toolButtonActivated(l,e){this.insertNewBlock(l,e)}open(){var l;this.isEmpty||((l=this.popover)==null||l.show(),this.opened=!0,this.emit("toolbox-opened"))}close(){var l;(l=this.popover)==null||l.hide(),this.opened=!1,this.emit("toolbox-closed")}toggle(){this.opened?this.close():this.open()}get toolsToBeDisplayed(){const l=[];return this.tools.forEach(e=>{e.toolbox&&l.push(e)}),l}get toolboxItemsToBeDisplayed(){const l=(e,n)=>({icon:e.icon,title:de.t(De.toolNames,e.title||qn(n.name)),name:n.name,onActivate:()=>{this.toolButtonActivated(n.name,e.data)},secondaryLabel:n.shortcut?vi(n.shortcut):""});return this.toolsToBeDisplayed.reduce((e,n)=>(Array.isArray(n.toolbox)?n.toolbox.forEach(r=>{e.push(l(r,n))}):n.toolbox!==void 0&&e.push(l(n.toolbox,n)),e),[])}enableShortcuts(){this.toolsToBeDisplayed.forEach(l=>{const e=l.shortcut;e&&this.enableShortcutForTool(l.name,e)})}enableShortcutForTool(l,e){Gn.add({name:e,on:this.api.ui.nodes.redactor,handler:n=>{n.preventDefault();const r=this.api.blocks.getCurrentBlockIndex(),s=this.api.blocks.getBlockByIndex(r);if(s)try{this.api.blocks.convert(s.id,l),window.requestAnimationFrame(()=>{this.api.caret.setToBlock(r,"end")});return}catch{}this.insertNewBlock(l)}})}removeAllShortcuts(){this.toolsToBeDisplayed.forEach(l=>{const e=l.shortcut;e&&Gn.remove(this.api.ui.nodes.redactor,e)})}async insertNewBlock(l,e){const n=this.api.blocks.getCurrentBlockIndex(),r=this.api.blocks.getBlockByIndex(n);if(!r)return;const s=r.isEmpty?n:n+1;let c;if(e){const f=await this.api.blocks.composeBlockData(l);c=Object.assign(f,e)}const h=this.api.blocks.insert(l,c,void 0,s,void 0,r.isEmpty);h.call(Ze.APPEND_CALLBACK),this.api.caret.setToBlock(s),this.emit("toolbox-block-added",{block:h}),this.api.toolbar.close()}};let rs=yc;xc([jn],rs.prototype,"toolsToBeDisplayed",1);xc([jn],rs.prototype,"toolboxItemsToBeDisplayed",1);const Cc="block hovered";class Dv extends bt{constructor({config:e,eventsDispatcher:n}){super({config:e,eventsDispatcher:n}),this.toolboxInstance=null}get CSS(){return{toolbar:"ce-toolbar",content:"ce-toolbar__content",actions:"ce-toolbar__actions",actionsOpened:"ce-toolbar__actions--opened",toolbarOpened:"ce-toolbar--opened",openedToolboxHolderModifier:"codex-editor--toolbox-opened",plusButton:"ce-toolbar__plus",plusButtonShortcut:"ce-toolbar__plus-shortcut",settingsToggler:"ce-toolbar__settings-btn",settingsTogglerHidden:"ce-toolbar__settings-btn--hidden"}}get opened(){return this.nodes.wrapper.classList.contains(this.CSS.toolbarOpened)}get toolbox(){var e;return{opened:(e=this.toolboxInstance)==null?void 0:e.opened,close:()=>{var n;(n=this.toolboxInstance)==null||n.close()},open:()=>{if(this.toolboxInstance===null){yt("toolbox.open() called before initialization is finished","warn");return}this.Editor.BlockManager.currentBlock=this.hoveredBlock,this.toolboxInstance.open()},toggle:()=>{if(this.toolboxInstance===null){yt("toolbox.toggle() called before initialization is finished","warn");return}this.toolboxInstance.toggle()},hasFocus:()=>{var n;return(n=this.toolboxInstance)==null?void 0:n.hasFocus()}}}get blockActions(){return{hide:()=>{this.nodes.actions.classList.remove(this.CSS.actionsOpened)},show:()=>{this.nodes.actions.classList.add(this.CSS.actionsOpened)}}}get blockTunesToggler(){return{hide:()=>this.nodes.settingsToggler.classList.add(this.CSS.settingsTogglerHidden),show:()=>this.nodes.settingsToggler.classList.remove(this.CSS.settingsTogglerHidden)}}toggleReadOnly(e){e?(this.destroy(),this.Editor.BlockSettings.destroy(),this.disableModuleBindings()):window.requestIdleCallback(()=>{this.drawUI(),this.enableModuleBindings()},{timeout:2e3})}moveAndOpen(e=this.Editor.BlockManager.currentBlock){if(this.toolboxInstance===null){yt("Can't open Toolbar since Editor initialization is not finished yet","warn");return}if(this.toolboxInstance.opened&&this.toolboxInstance.close(),this.Editor.BlockSettings.opened&&this.Editor.BlockSettings.close(),!e)return;this.hoveredBlock=e;const n=e.holder,{isMobile:r}=this.Editor.UI,s=e.pluginsContent,c=window.getComputedStyle(s),h=parseInt(c.paddingTop,10),f=n.offsetHeight;let g;r?g=n.offsetTop+f:g=n.offsetTop+h,this.nodes.wrapper.style.top=`${Math.floor(g)}px`,this.Editor.BlockManager.blocks.length===1&&e.isEmpty?this.blockTunesToggler.hide():this.blockTunesToggler.show(),this.open()}close(){var e,n;this.Editor.ReadOnly.isEnabled||((e=this.nodes.wrapper)==null||e.classList.remove(this.CSS.toolbarOpened),this.blockActions.hide(),(n=this.toolboxInstance)==null||n.close(),this.Editor.BlockSettings.close(),this.reset())}reset(){this.nodes.wrapper.style.top="unset"}open(e=!0){this.nodes.wrapper.classList.add(this.CSS.toolbarOpened),e?this.blockActions.show():this.blockActions.hide()}make(){this.nodes.wrapper=C.make("div",this.CSS.toolbar),["content","actions"].forEach(s=>{this.nodes[s]=C.make("div",this.CSS[s])}),C.append(this.nodes.wrapper,this.nodes.content),C.append(this.nodes.content,this.nodes.actions),this.nodes.plusButton=C.make("div",this.CSS.plusButton,{innerHTML:Cv}),C.append(this.nodes.actions,this.nodes.plusButton),this.readOnlyMutableListeners.on(this.nodes.plusButton,"click",()=>{Vr(!0),this.plusButtonClicked()},!1);const e=C.make("div");e.appendChild(document.createTextNode(de.ui(De.ui.toolbar.toolbox,"Add"))),e.appendChild(C.make("div",this.CSS.plusButtonShortcut,{textContent:"/"})),wo(this.nodes.plusButton,e,{hidingDelay:400}),this.nodes.settingsToggler=C.make("span",this.CSS.settingsToggler,{innerHTML:yv}),C.append(this.nodes.actions,this.nodes.settingsToggler);const n=C.make("div"),r=C.text(de.ui(De.ui.blockTunes.toggler,"Click to tune"));n.appendChild(r),n.appendChild(C.make("div",this.CSS.plusButtonShortcut,{textContent:vi("CMD + /")})),wo(this.nodes.settingsToggler,n,{hidingDelay:400}),C.append(this.nodes.actions,this.makeToolbox()),C.append(this.nodes.actions,this.Editor.BlockSettings.getElement()),C.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper)}makeToolbox(){return this.toolboxInstance=new rs({api:this.Editor.API.methods,tools:this.Editor.Tools.blockTools,i18nLabels:{filter:de.ui(De.ui.popover,"Filter"),nothingFound:de.ui(De.ui.popover,"Nothing found")}}),this.toolboxInstance.on(pi.Opened,()=>{this.Editor.UI.nodes.wrapper.classList.add(this.CSS.openedToolboxHolderModifier)}),this.toolboxInstance.on(pi.Closed,()=>{this.Editor.UI.nodes.wrapper.classList.remove(this.CSS.openedToolboxHolderModifier)}),this.toolboxInstance.on(pi.BlockAdded,({block:e})=>{const{BlockManager:n,Caret:r}=this.Editor,s=n.getBlockById(e.id);s.inputs.length===0&&(s===n.lastBlock?(n.insertAtEnd(),r.setToBlock(n.lastBlock)):r.setToBlock(n.nextBlock))}),this.toolboxInstance.make()}plusButtonClicked(){var e;this.Editor.BlockManager.currentBlock=this.hoveredBlock,(e=this.toolboxInstance)==null||e.toggle()}enableModuleBindings(){this.readOnlyMutableListeners.on(this.nodes.settingsToggler,"mousedown",e=>{var n;e.stopPropagation(),this.settingsTogglerClicked(),(n=this.toolboxInstance)!=null&&n.opened&&this.toolboxInstance.close(),Vr(!0)},!0),Tn()||this.eventsDispatcher.on(Cc,e=>{var n;this.Editor.BlockSettings.opened||(n=this.toolboxInstance)!=null&&n.opened||this.moveAndOpen(e.block)})}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}settingsTogglerClicked(){this.Editor.BlockManager.currentBlock=this.hoveredBlock,this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.BlockSettings.open(this.hoveredBlock)}drawUI(){this.Editor.BlockSettings.make(),this.make()}destroy(){this.removeAllNodes(),this.toolboxInstance&&this.toolboxInstance.destroy()}}var wi=(l=>(l[l.Block=0]="Block",l[l.Inline=1]="Inline",l[l.Tune=2]="Tune",l))(wi||{}),fi=(l=>(l.Shortcut="shortcut",l.Toolbox="toolbox",l.EnabledInlineTools="inlineToolbar",l.EnabledBlockTunes="tunes",l.Config="config",l))(fi||{}),Ec=(l=>(l.Shortcut="shortcut",l.SanitizeConfig="sanitize",l))(Ec||{}),Kn=(l=>(l.IsEnabledLineBreaks="enableLineBreaks",l.Toolbox="toolbox",l.ConversionConfig="conversionConfig",l.IsReadOnlySupported="isReadOnlySupported",l.PasteConfig="pasteConfig",l))(Kn||{}),ss=(l=>(l.IsInline="isInline",l.Title="title",l))(ss||{}),Sc=(l=>(l.IsTune="isTune",l))(Sc||{});class as{constructor({name:e,constructable:n,config:r,api:s,isDefault:c,isInternal:h=!1,defaultPlaceholder:f}){this.api=s,this.name=e,this.constructable=n,this.config=r,this.isDefault=c,this.isInternal=h,this.defaultPlaceholder=f}get settings(){const e=this.config.config||{};return this.isDefault&&!("placeholder"in e)&&this.defaultPlaceholder&&(e.placeholder=this.defaultPlaceholder),e}reset(){if(Mt(this.constructable.reset))return this.constructable.reset()}prepare(){if(Mt(this.constructable.prepare))return this.constructable.prepare({toolName:this.name,config:this.settings})}get shortcut(){const e=this.constructable.shortcut;return this.config.shortcut||e}get sanitizeConfig(){return this.constructable.sanitize||{}}isInline(){return this.type===1}isBlock(){return this.type===0}isTune(){return this.type===2}}class Pv extends bt{constructor({config:e,eventsDispatcher:n}){super({config:e,eventsDispatcher:n}),this.CSS={inlineToolbar:"ce-inline-toolbar",inlineToolbarShowed:"ce-inline-toolbar--showed",inlineToolbarLeftOriented:"ce-inline-toolbar--left-oriented",inlineToolbarRightOriented:"ce-inline-toolbar--right-oriented",inlineToolbarShortcut:"ce-inline-toolbar__shortcut",buttonsWrapper:"ce-inline-toolbar__buttons",actionsWrapper:"ce-inline-toolbar__actions",inlineToolButton:"ce-inline-tool",inputField:"cdx-input",focusedButton:"ce-inline-tool--focused",conversionToggler:"ce-inline-toolbar__dropdown",conversionTogglerArrow:"ce-inline-toolbar__dropdown-arrow",conversionTogglerHidden:"ce-inline-toolbar__dropdown--hidden",conversionTogglerContent:"ce-inline-toolbar__dropdown-content",togglerAndButtonsWrapper:"ce-inline-toolbar__toggler-and-button-wrapper"},this.opened=!1,this.toolbarVerticalMargin=Tn()?20:6,this.buttonsList=null,this.width=0,this.flipper=null}toggleReadOnly(e){e?(this.destroy(),this.Editor.ConversionToolbar.destroy()):window.requestIdleCallback(()=>{this.make()},{timeout:2e3})}async tryToShow(e=!1,n=!0){e&&this.close(),this.allowedToShow()&&(await this.addToolsFiltered(n),this.move(),this.open(n),this.Editor.Toolbar.close())}close(){this.opened&&(this.Editor.ReadOnly.isEnabled||(this.nodes.wrapper.classList.remove(this.CSS.inlineToolbarShowed),Array.from(this.toolsInstances.entries()).forEach(([e,n])=>{const r=this.getToolShortcut(e);r&&Gn.remove(this.Editor.UI.nodes.redactor,r),Mt(n.clear)&&n.clear()}),this.reset(),this.opened=!1,this.flipper.deactivate(),this.Editor.ConversionToolbar.close()))}containsNode(e){return this.nodes.wrapper===void 0?!1:this.nodes.wrapper.contains(e)}destroy(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}make(){this.nodes.wrapper=C.make("div",[this.CSS.inlineToolbar,...this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]]),this.nodes.togglerAndButtonsWrapper=C.make("div",this.CSS.togglerAndButtonsWrapper),this.nodes.buttons=C.make("div",this.CSS.buttonsWrapper),this.nodes.actions=C.make("div",this.CSS.actionsWrapper),this.listeners.on(this.nodes.wrapper,"mousedown",e=>{e.target.closest(`.${this.CSS.actionsWrapper}`)||e.preventDefault()}),C.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),C.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper),this.addConversionToggler(),C.append(this.nodes.togglerAndButtonsWrapper,this.nodes.buttons),this.prepareConversionToolbar(),window.requestAnimationFrame(()=>{this.recalculateWidth()}),this.enableFlipper()}open(){if(this.opened)return;this.nodes.wrapper.classList.add(this.CSS.inlineToolbarShowed),this.buttonsList=this.nodes.buttons.querySelectorAll(`.${this.CSS.inlineToolButton}`),this.opened=!0;let e=Array.from(this.buttonsList);e.unshift(this.nodes.conversionToggler),e=e.filter(n=>!n.hidden),this.flipper.activate(e)}move(){const e=nt.rect,n=this.Editor.UI.nodes.wrapper.getBoundingClientRect(),r={x:e.x-n.x,y:e.y+e.height-n.top+this.toolbarVerticalMargin};r.x+this.width+n.x>this.Editor.UI.contentRect.right&&(r.x=this.Editor.UI.contentRect.right-this.width-n.x),this.nodes.wrapper.style.left=Math.floor(r.x)+"px",this.nodes.wrapper.style.top=Math.floor(r.y)+"px"}reset(){this.nodes.wrapper.classList.remove(this.CSS.inlineToolbarLeftOriented,this.CSS.inlineToolbarRightOriented),this.nodes.wrapper.style.left="0",this.nodes.wrapper.style.top="0"}allowedToShow(){const e=["IMG","INPUT"],n=nt.get(),r=nt.text;if(!n||!n.anchorNode||n.isCollapsed||r.length<1)return!1;const s=C.isElement(n.anchorNode)?n.anchorNode:n.anchorNode.parentElement;if(n&&e.includes(s.tagName)||s.closest('[contenteditable="true"]')===null)return!1;const c=this.Editor.BlockManager.getBlock(n.anchorNode);return c?c.tool.inlineTools.size!==0:!1}recalculateWidth(){this.width=this.nodes.wrapper.offsetWidth}addConversionToggler(){this.nodes.conversionToggler=C.make("div",this.CSS.conversionToggler),this.nodes.conversionTogglerContent=C.make("div",this.CSS.conversionTogglerContent);const e=C.make("div",this.CSS.conversionTogglerArrow,{innerHTML:kc});this.nodes.conversionToggler.appendChild(this.nodes.conversionTogglerContent),this.nodes.conversionToggler.appendChild(e),this.nodes.togglerAndButtonsWrapper.appendChild(this.nodes.conversionToggler),this.listeners.on(this.nodes.conversionToggler,"click",()=>{this.Editor.ConversionToolbar.toggle(n=>{!n&&this.opened?this.flipper.activate():this.opened&&this.flipper.deactivate()})}),Tn()===!1&&wo(this.nodes.conversionToggler,de.ui(De.ui.inlineToolbar.converter,"Convert to"),{placement:"top",hidingDelay:100})}async setConversionTogglerContent(){const{BlockManager:e}=this.Editor,{currentBlock:n}=e,r=n.name,s=n.tool.conversionConfig,c=s&&s.export;this.nodes.conversionToggler.hidden=!c,this.nodes.conversionToggler.classList.toggle(this.CSS.conversionTogglerHidden,!c);const h=await n.getActiveToolboxEntry()||{};this.nodes.conversionTogglerContent.innerHTML=h.icon||h.title||qn(r)}prepareConversionToolbar(){const e=this.Editor.ConversionToolbar.make();C.append(this.nodes.wrapper,e)}async addToolsFiltered(e=!0){const n=nt.get(),r=this.Editor.BlockManager.getBlock(n.anchorNode);this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this.toolsInstances=new Map,Array.from(r.tool.inlineTools.values()).forEach(s=>{this.addTool(s)}),e&&this.Editor.ConversionToolbar.hasTools()?await this.setConversionTogglerContent():this.nodes.conversionToggler.hidden=!0,this.recalculateWidth()}addTool(e){const n=e.create(),r=n.render();if(!r){yt("Render method must return an instance of Node","warn",e.name);return}if(r.dataset.tool=e.name,this.nodes.buttons.appendChild(r),this.toolsInstances.set(e.name,n),Mt(n.renderActions)){const f=n.renderActions();this.nodes.actions.appendChild(f)}this.listeners.on(r,"click",f=>{this.toolClicked(n),f.preventDefault()});const s=this.getToolShortcut(e.name);if(s)try{this.enableShortcuts(n,s)}catch{}const c=C.make("div"),h=de.t(De.toolNames,e.title||qn(e.name));c.appendChild(C.text(h)),s&&c.appendChild(C.make("div",this.CSS.inlineToolbarShortcut,{textContent:vi(s)})),Tn()===!1&&wo(r,c,{placement:"top",hidingDelay:100}),n.checkState(nt.get())}getToolShortcut(e){const{Tools:n}=this.Editor,r=n.inlineTools.get(e),s=n.internal.inlineTools;return Array.from(s.keys()).includes(e)?this.inlineTools[e][Ec.Shortcut]:r.shortcut}enableShortcuts(e,n){Gn.add({name:n,handler:r=>{const{currentBlock:s}=this.Editor.BlockManager;s&&s.tool.enabledInlineTools&&(r.preventDefault(),this.toolClicked(e))},on:this.Editor.UI.nodes.redactor})}toolClicked(e){const n=nt.range;e.surround(n),this.checkToolsState(),e.renderActions!==void 0&&this.flipper.deactivate()}checkToolsState(){this.toolsInstances.forEach(e=>{e.checkState(nt.get())})}get inlineTools(){const e={};return Array.from(this.Editor.Tools.inlineTools.entries()).forEach(([n,r])=>{e[n]=r.create()}),e}enableFlipper(){this.flipper=new Qe({focusedItemClass:this.CSS.focusedButton,allowedKeys:[ot.ENTER,ot.TAB]})}}class Hv extends bt{keydown(e){switch(this.beforeKeydownProcessing(e),e.keyCode){case ot.BACKSPACE:this.backspace(e);break;case ot.DELETE:this.delete(e);break;case ot.ENTER:this.enter(e);break;case ot.DOWN:case ot.RIGHT:this.arrowRightAndDown(e);break;case ot.UP:case ot.LEFT:this.arrowLeftAndUp(e);break;case ot.TAB:this.tabPressed(e);break;case ot.SLASH:e.ctrlKey||e.metaKey?this.commandSlashPressed():this.slashPressed();break}}beforeKeydownProcessing(e){this.needToolbarClosing(e)&&lc(e.keyCode)&&(this.Editor.Toolbar.close(),this.Editor.ConversionToolbar.close(),e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||this.Editor.BlockSelection.clearSelection(e))}keyup(e){e.shiftKey||this.Editor.UI.checkEmptiness()}dragOver(e){const n=this.Editor.BlockManager.getBlockByChildNode(e.target);n.dropTarget=!0}dragLeave(e){const n=this.Editor.BlockManager.getBlockByChildNode(e.target);n.dropTarget=!1}handleCommandC(e){const{BlockSelection:n}=this.Editor;n.anyBlockSelected&&n.copySelectedBlocks(e)}handleCommandX(e){const{BlockSelection:n,BlockManager:r,Caret:s}=this.Editor;n.anyBlockSelected&&n.copySelectedBlocks(e).then(()=>{const c=r.removeSelectedBlocks(),h=r.insertDefaultBlockAtIndex(c,!0);s.setToBlock(h,s.positions.START),n.clearSelection(e)})}tabPressed(e){const{InlineToolbar:n,ConversionToolbar:r,Caret:s}=this.Editor;r.opened||n.opened||(e.shiftKey?s.navigatePrevious(!0):s.navigateNext(!0))&&e.preventDefault()}commandSlashPressed(){this.Editor.BlockSelection.selectedBlocks.length>1||this.activateBlockSettings()}slashPressed(){this.Editor.BlockManager.currentBlock.isEmpty&&this.activateToolbox()}enter(e){const{BlockManager:n,UI:r}=this.Editor;if(n.currentBlock.tool.isLineBreaksEnabled||r.someToolbarOpened&&r.someFlipperButtonFocused||e.shiftKey)return;let s=this.Editor.BlockManager.currentBlock;this.Editor.Caret.isAtStart&&!this.Editor.BlockManager.currentBlock.hasMedia?this.Editor.BlockManager.insertDefaultBlockAtIndex(this.Editor.BlockManager.currentBlockIndex):this.Editor.Caret.isAtEnd?s=this.Editor.BlockManager.insertDefaultBlockAtIndex(this.Editor.BlockManager.currentBlockIndex+1):s=this.Editor.BlockManager.split(),this.Editor.Caret.setToBlock(s),this.Editor.Toolbar.moveAndOpen(s),e.preventDefault()}backspace(e){const{BlockManager:n,Caret:r}=this.Editor,{currentBlock:s,previousBlock:c}=n;if(!(!nt.isCollapsed||!r.isAtStart)){if(e.preventDefault(),this.Editor.Toolbar.close(),s.currentInput!==s.firstInput){r.navigatePrevious();return}if(c!==null){if(c.isEmpty){n.removeBlock(c);return}if(s.isEmpty){n.removeBlock(s);const h=n.currentBlock;r.setToBlock(h,r.positions.END);return}Gl(s,c)?this.mergeBlocks(c,s):r.setToBlock(c,r.positions.END)}}}delete(e){const{BlockManager:n,Caret:r}=this.Editor,{currentBlock:s,nextBlock:c}=n;if(!(!nt.isCollapsed||!r.isAtEnd)){if(e.preventDefault(),this.Editor.Toolbar.close(),s.currentInput!==s.lastInput){r.navigateNext();return}if(c!==null){if(c.isEmpty){n.removeBlock(c);return}if(s.isEmpty){n.removeBlock(s),r.setToBlock(c,r.positions.START);return}Gl(s,c)?this.mergeBlocks(s,c):r.setToBlock(c,r.positions.START)}}}mergeBlocks(e,n){const{BlockManager:r,Caret:s,Toolbar:c}=this.Editor;s.createShadow(e.pluginsContent),r.mergeBlocks(e,n).then(()=>{window.requestAnimationFrame(()=>{s.restoreCaret(e.pluginsContent),e.pluginsContent.normalize(),c.close()})})}arrowRightAndDown(e){const n=Qe.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===ot.TAB);if(this.Editor.UI.someToolbarOpened&&n)return;this.Editor.Toolbar.close();const r=this.Editor.Caret.isAtEnd||this.Editor.BlockSelection.anyBlockSelected;if(e.shiftKey&&e.keyCode===ot.DOWN&&r){this.Editor.CrossBlockSelection.toggleBlockSelectedState();return}if(e.keyCode===ot.DOWN||e.keyCode===ot.RIGHT&&!this.isRtl?this.Editor.Caret.navigateNext():this.Editor.Caret.navigatePrevious()){e.preventDefault();return}gi(()=>{this.Editor.BlockManager.currentBlock&&this.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(e)}arrowLeftAndUp(e){if(this.Editor.UI.someToolbarOpened){if(Qe.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===ot.TAB))return;this.Editor.UI.closeAllToolbars()}this.Editor.Toolbar.close();const n=this.Editor.Caret.isAtStart||this.Editor.BlockSelection.anyBlockSelected;if(e.shiftKey&&e.keyCode===ot.UP&&n){this.Editor.CrossBlockSelection.toggleBlockSelectedState(!1);return}if(e.keyCode===ot.UP||e.keyCode===ot.LEFT&&!this.isRtl?this.Editor.Caret.navigatePrevious():this.Editor.Caret.navigateNext()){e.preventDefault();return}gi(()=>{this.Editor.BlockManager.currentBlock&&this.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(e)}needToolbarClosing(e){const n=e.keyCode===ot.ENTER&&this.Editor.Toolbar.toolbox.opened,r=e.keyCode===ot.ENTER&&this.Editor.BlockSettings.opened,s=e.keyCode===ot.ENTER&&this.Editor.InlineToolbar.opened,c=e.keyCode===ot.ENTER&&this.Editor.ConversionToolbar.opened,h=e.keyCode===ot.TAB;return!(e.shiftKey||h||n||r||s||c)}activateToolbox(){this.Editor.Toolbar.opened||this.Editor.Toolbar.moveAndOpen(),this.Editor.Toolbar.toolbox.open()}activateBlockSettings(){this.Editor.Toolbar.opened||this.Editor.Toolbar.moveAndOpen(),this.Editor.BlockSettings.opened||this.Editor.BlockSettings.open()}}class $r{constructor(e){this.blocks=[],this.workingArea=e}get length(){return this.blocks.length}get array(){return this.blocks}get nodes(){return cc(this.workingArea.children)}static set(e,n,r){return isNaN(Number(n))?(Reflect.set(e,n,r),!0):(e.insert(+n,r),!0)}static get(e,n){return isNaN(Number(n))?Reflect.get(e,n):e.get(+n)}push(e){this.blocks.push(e),this.insertToDOM(e)}swap(e,n){const r=this.blocks[n];C.swap(this.blocks[e].holder,r.holder),this.blocks[n]=this.blocks[e],this.blocks[e]=r}move(e,n){const r=this.blocks.splice(n,1)[0],s=e-1,c=Math.max(0,s),h=this.blocks[c];e>0?this.insertToDOM(r,"afterend",h):this.insertToDOM(r,"beforebegin",h),this.blocks.splice(e,0,r);const f=this.composeBlockEvent("move",{fromIndex:n,toIndex:e});r.call(Ze.MOVED,f)}insert(e,n,r=!1){if(!this.length){this.push(n);return}e>this.length&&(e=this.length),r&&(this.blocks[e].holder.remove(),this.blocks[e].call(Ze.REMOVED));const s=r?1:0;if(this.blocks.splice(e,s,n),e>0){const c=this.blocks[e-1];this.insertToDOM(n,"afterend",c)}else{const c=this.blocks[e+1];c?this.insertToDOM(n,"beforebegin",c):this.insertToDOM(n)}}replace(e,n){if(this.blocks[e]===void 0)throw Error("Incorrect index");this.blocks[e].holder.replaceWith(n.holder),this.blocks[e]=n}insertMany(e,n){const r=new DocumentFragment;for(const s of e)r.appendChild(s.holder);if(this.length>0){if(n>0){const s=Math.min(n-1,this.length-1);this.blocks[s].holder.after(r)}else n===0&&this.workingArea.prepend(r);this.blocks.splice(n,0,...e)}else this.blocks.push(...e),this.workingArea.appendChild(r);e.forEach(s=>s.call(Ze.RENDERED))}remove(e){isNaN(e)&&(e=this.length-1),this.blocks[e].holder.remove(),this.blocks[e].call(Ze.REMOVED),this.blocks.splice(e,1)}removeAll(){this.workingArea.innerHTML="",this.blocks.forEach(e=>e.call(Ze.REMOVED)),this.blocks.length=0}insertAfter(e,n){const r=this.blocks.indexOf(e);this.insert(r+1,n)}get(e){return this.blocks[e]}indexOf(e){return this.blocks.indexOf(e)}insertToDOM(e,n,r){n?r.holder.insertAdjacentElement(n,e.holder):this.workingArea.appendChild(e.holder),e.call(Ze.RENDERED)}composeBlockEvent(e,n){return new CustomEvent(e,{detail:n})}}const Zl="block-removed",Vl="block-added",Fv="block-moved",Jl="block-changed";class Uv{constructor(){this.completed=Promise.resolve()}add(e){return new Promise((n,r)=>{this.completed=this.completed.then(e).then(n).catch(r)})}}class zv extends bt{constructor(){super(...arguments),this._currentBlockIndex=-1,this._blocks=null}get currentBlockIndex(){return this._currentBlockIndex}set currentBlockIndex(e){this._currentBlockIndex=e}get firstBlock(){return this._blocks[0]}get lastBlock(){return this._blocks[this._blocks.length-1]}get currentBlock(){return this._blocks[this.currentBlockIndex]}set currentBlock(e){this.currentBlockIndex=this.getBlockIndex(e)}get nextBlock(){return this.currentBlockIndex===this._blocks.length-1?null:this._blocks[this.currentBlockIndex+1]}get nextContentfulBlock(){return this.blocks.slice(this.currentBlockIndex+1).find(e=>!!e.inputs.length)}get previousContentfulBlock(){return this.blocks.slice(0,this.currentBlockIndex).reverse().find(e=>!!e.inputs.length)}get previousBlock(){return this.currentBlockIndex===0?null:this._blocks[this.currentBlockIndex-1]}get blocks(){return this._blocks.array}get isEditorEmpty(){return this.blocks.every(e=>e.isEmpty)}prepare(){const e=new $r(this.Editor.UI.nodes.redactor);this._blocks=new Proxy(e,{set:$r.set,get:$r.get}),this.listeners.on(document,"copy",n=>this.Editor.BlockEvents.handleCommandC(n))}toggleReadOnly(e){e?this.disableModuleBindings():this.enableModuleBindings()}composeBlock({tool:e,data:n={},id:r=void 0,tunes:s={}}){const c=this.Editor.ReadOnly.isEnabled,h=this.Editor.Tools.blockTools.get(e),f=new Ve({id:r,data:n,tool:h,api:this.Editor.API,readOnly:c,tunesData:s},this.eventsDispatcher);return c||window.requestIdleCallback(()=>{this.bindBlockEvents(f)},{timeout:2e3}),f}insert({id:e=void 0,tool:n=this.config.defaultBlock,data:r={},index:s,needToFocus:c=!0,replace:h=!1,tunes:f={}}={}){let g=s;g===void 0&&(g=this.currentBlockIndex+(h?0:1));const w=this.composeBlock({id:e,tool:n,data:r,tunes:f});return h&&this.blockDidMutated(Zl,this.getBlockByIndex(g),{index:g}),this._blocks.insert(g,w,h),this.blockDidMutated(Vl,w,{index:g}),c?this.currentBlockIndex=g:g<=this.currentBlockIndex&&this.currentBlockIndex++,w}insertMany(e,n=0){this._blocks.insertMany(e,n)}async update(e,n){const r=await e.data,s=this.composeBlock({id:e.id,tool:e.name,data:Object.assign({},r,n),tunes:e.tunes}),c=this.getBlockIndex(e);return this._blocks.replace(c,s),this.blockDidMutated(Jl,s,{index:c}),s}replace(e,n,r){const s=this.getBlockIndex(e);this.insert({tool:n,data:r,index:s,replace:!0})}paste(e,n,r=!1){const s=this.insert({tool:e,replace:r});try{window.requestIdleCallback(()=>{s.call(Ze.ON_PASTE,n)})}catch(c){yt(`${e}: onPaste callback call is failed`,"error",c)}return s}insertDefaultBlockAtIndex(e,n=!1){const r=this.composeBlock({tool:this.config.defaultBlock});return this._blocks[e]=r,this.blockDidMutated(Vl,r,{index:e}),n?this.currentBlockIndex=e:e<=this.currentBlockIndex&&this.currentBlockIndex++,r}insertAtEnd(){return this.currentBlockIndex=this.blocks.length-1,this.insert()}async mergeBlocks(e,n){const r=await n.data;Le(r)||await e.mergeWith(r),this.removeBlock(n),this.currentBlockIndex=this._blocks.indexOf(e)}removeBlock(e,n=!0){return new Promise(r=>{const s=this._blocks.indexOf(e);if(!this.validateIndex(s))throw new Error("Can't find a Block to remove");e.destroy(),this._blocks.remove(s),this.blockDidMutated(Zl,e,{index:s}),this.currentBlockIndex>=s&&this.currentBlockIndex--,this.blocks.length?s===0&&(this.currentBlockIndex=0):(this.currentBlockIndex=-1,n&&this.insert()),r()})}removeSelectedBlocks(){let e;for(let n=this.blocks.length-1;n>=0;n--)this.blocks[n].selected&&(this.removeBlock(this.blocks[n]),e=n);return e}removeAllBlocks(){for(let e=this.blocks.length-1;e>=0;e--)this._blocks.remove(e);this.currentBlockIndex=-1,this.insert(),this.currentBlock.firstInput.focus()}split(){const e=this.Editor.Caret.extractFragmentFromCaretPosition(),n=C.make("div");n.appendChild(e);const r={text:C.isEmpty(n)?"":n.innerHTML};return this.insert({data:r})}getBlockByIndex(e){return e===-1&&(e=this._blocks.length-1),this._blocks[e]}getBlockIndex(e){return this._blocks.indexOf(e)}getBlockById(e){return this._blocks.array.find(n=>n.id===e)}getBlock(e){C.isElement(e)||(e=e.parentNode);const n=this._blocks.nodes,r=e.closest(`.${Ve.CSS.wrapper}`),s=n.indexOf(r);if(s>=0)return this._blocks[s]}setCurrentBlockByChildNode(e){C.isElement(e)||(e=e.parentNode);const n=e.closest(`.${Ve.CSS.wrapper}`);if(!n)return;const r=n.closest(`.${this.Editor.UI.CSS.editorWrapper}`);if(r!=null&&r.isEqualNode(this.Editor.UI.nodes.wrapper))return this.currentBlockIndex=this._blocks.nodes.indexOf(n),this.currentBlock.updateCurrentInput(),this.currentBlock}getBlockByChildNode(e){if(!e||!(e instanceof Node))return;C.isElement(e)||(e=e.parentNode);const n=e.closest(`.${Ve.CSS.wrapper}`);return this.blocks.find(r=>r.holder===n)}swap(e,n){this._blocks.swap(e,n),this.currentBlockIndex=n}move(e,n=this.currentBlockIndex){if(isNaN(e)||isNaN(n)){yt("Warning during 'move' call: incorrect indices provided.","warn");return}if(!this.validateIndex(e)||!this.validateIndex(n)){yt("Warning during 'move' call: indices cannot be lower than 0 or greater than the amount of blocks.","warn");return}this._blocks.move(e,n),this.currentBlockIndex=e,this.blockDidMutated(Fv,this.currentBlock,{fromIndex:n,toIndex:e})}async convert(e,n,r){if(!await e.save())throw new Error("Could not convert Block. Failed to extract original Block data.");const s=this.Editor.Tools.blockTools.get(n);if(!s)throw new Error(`Could not convert Block. Tool «${n}» not found.`);const c=await e.exportDataAsString(),h=Je(c,s.sanitizeConfig);let f=zb(h,s.conversionConfig);r&&(f=Object.assign(f,r)),this.replace(e,s.name,f)}dropPointer(){this.currentBlockIndex=-1}async clear(e=!1){const n=new Uv;this.blocks.forEach(r=>{n.add(async()=>{await this.removeBlock(r,!1)})}),await n.completed,this.dropPointer(),e&&this.insert(),this.Editor.UI.checkEmptiness()}async destroy(){await Promise.all(this.blocks.map(e=>e.destroy()))}bindBlockEvents(e){const{BlockEvents:n}=this.Editor;this.readOnlyMutableListeners.on(e.holder,"keydown",r=>{n.keydown(r)}),this.readOnlyMutableListeners.on(e.holder,"keyup",r=>{n.keyup(r)}),this.readOnlyMutableListeners.on(e.holder,"dragover",r=>{n.dragOver(r)}),this.readOnlyMutableListeners.on(e.holder,"dragleave",r=>{n.dragLeave(r)}),e.on("didMutated",r=>this.blockDidMutated(Jl,r,{index:this.getBlockIndex(r)}))}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}enableModuleBindings(){this.readOnlyMutableListeners.on(document,"cut",e=>this.Editor.BlockEvents.handleCommandX(e)),this.blocks.forEach(e=>{this.bindBlockEvents(e)})}validateIndex(e){return!(e<0||e>=this._blocks.length)}blockDidMutated(e,n,r){const s=new CustomEvent(e,{detail:{target:new Sn(n),...r}});return this.eventsDispatcher.emit(fc,{event:s}),n}}class Wv extends bt{constructor(){super(...arguments),this.anyBlockSelectedCache=null,this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1}get sanitizerConfig(){return{p:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},ol:{},ul:{},li:{},br:!0,img:{src:!0,width:!0,height:!0},a:{href:!0},b:{},i:{},u:{}}}get allBlocksSelected(){const{BlockManager:e}=this.Editor;return e.blocks.every(n=>n.selected===!0)}set allBlocksSelected(e){const{BlockManager:n}=this.Editor;n.blocks.forEach(r=>{r.selected=e}),this.clearCache()}get anyBlockSelected(){const{BlockManager:e}=this.Editor;return this.anyBlockSelectedCache===null&&(this.anyBlockSelectedCache=e.blocks.some(n=>n.selected===!0)),this.anyBlockSelectedCache}get selectedBlocks(){return this.Editor.BlockManager.blocks.filter(e=>e.selected)}prepare(){this.selection=new nt,Gn.add({name:"CMD+A",handler:e=>{const{BlockManager:n,ReadOnly:r}=this.Editor;if(r.isEnabled){e.preventDefault(),this.selectAllBlocks();return}n.currentBlock&&this.handleCommandA(e)},on:this.Editor.UI.nodes.redactor})}toggleReadOnly(){nt.get().removeAllRanges(),this.allBlocksSelected=!1}unSelectBlockByIndex(e){const{BlockManager:n}=this.Editor;let r;isNaN(e)?r=n.currentBlock:r=n.getBlockByIndex(e),r.selected=!1,this.clearCache()}clearSelection(e,n=!1){const{BlockManager:r,Caret:s,RectangleSelection:c}=this.Editor;this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1;const h=e&&e instanceof KeyboardEvent,f=h&&lc(e.keyCode);if(this.anyBlockSelected&&h&&f&&!nt.isSelectionExists){const g=r.removeSelectedBlocks();r.insertDefaultBlockAtIndex(g,!0),s.setToBlock(r.currentBlock),gi(()=>{const w=e.key;s.insertContentAtCaretPosition(w.length>1?"":w)},20)()}if(this.Editor.CrossBlockSelection.clear(e),!this.anyBlockSelected||c.isRectActivated()){this.Editor.RectangleSelection.clearSelection();return}n&&this.selection.restore(),this.allBlocksSelected=!1}copySelectedBlocks(e){e.preventDefault();const n=C.make("div");this.selectedBlocks.forEach(c=>{const h=Je(c.holder.innerHTML,this.sanitizerConfig),f=C.make("p");f.innerHTML=h,n.appendChild(f)});const r=Array.from(n.childNodes).map(c=>c.textContent).join(`

`),s=n.innerHTML;return e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",s),Promise.all(this.selectedBlocks.map(c=>c.save())).then(c=>{try{e.clipboardData.setData(this.Editor.Paste.MIME_TYPE,JSON.stringify(c))}catch{}})}selectBlockByIndex(e){const{BlockManager:n}=this.Editor,r=n.getBlockByIndex(e);r!==void 0&&this.selectBlock(r)}selectBlock(e){this.selection.save(),nt.get().removeAllRanges(),e.selected=!0,this.clearCache(),this.Editor.InlineToolbar.close()}unselectBlock(e){e.selected=!1,this.clearCache()}clearCache(){this.anyBlockSelectedCache=null}destroy(){Gn.remove(this.Editor.UI.nodes.redactor,"CMD+A")}handleCommandA(e){if(this.Editor.RectangleSelection.clearSelection(),C.isNativeInput(e.target)&&!this.readyToBlockSelection){this.readyToBlockSelection=!0;return}const n=this.Editor.BlockManager.getBlock(e.target),r=n.inputs;if(r.length>1&&!this.readyToBlockSelection){this.readyToBlockSelection=!0;return}if(r.length===1&&!this.needToSelectAll){this.needToSelectAll=!0;return}this.needToSelectAll?(e.preventDefault(),this.selectAllBlocks(),this.needToSelectAll=!1,this.readyToBlockSelection=!1,this.Editor.ConversionToolbar.close()):this.readyToBlockSelection&&(e.preventDefault(),this.selectBlock(n),this.needToSelectAll=!0)}selectAllBlocks(){this.selection.save(),nt.get().removeAllRanges(),this.allBlocksSelected=!0,this.Editor.InlineToolbar.close()}}class mi extends bt{get positions(){return{START:"start",END:"end",DEFAULT:"default"}}static get CSS(){return{shadowCaret:"cdx-shadow-caret"}}get isAtStart(){const{currentBlock:e}=this.Editor.BlockManager;if(!e.focusable)return!0;const n=nt.get(),r=C.getDeepestNode(e.currentInput);let s=n.focusNode;if(C.isNativeInput(r))return r.selectionEnd===0;if(!n.anchorNode)return!1;let c=s.textContent.search(/\S/);c===-1&&(c=0);let h=n.focusOffset;return s.nodeType!==Node.TEXT_NODE&&s.childNodes.length&&(s.childNodes[h]?(s=s.childNodes[h],h=0):(s=s.childNodes[h-1],h=s.textContent.length)),(C.isLineBreakTag(r)||C.isEmpty(r))&&this.getHigherLevelSiblings(s,"left").every(f=>{const g=C.isLineBreakTag(f),w=f.children.length===1&&C.isLineBreakTag(f.children[0]),I=g||w;return C.isEmpty(f)&&!I})&&h===c?!0:r===null||s===r&&h<=c}get isAtEnd(){const{currentBlock:e}=this.Editor.BlockManager;if(!e.focusable)return!0;const n=nt.get();let r=n.focusNode;const s=C.getDeepestNode(e.currentInput,!0);if(C.isNativeInput(s))return s.selectionEnd===s.value.length;if(!n.focusNode)return!1;let c=n.focusOffset;if(r.nodeType!==Node.TEXT_NODE&&r.childNodes.length&&(r.childNodes[c-1]?(r=r.childNodes[c-1],c=r.textContent.length):(r=r.childNodes[0],c=0)),C.isLineBreakTag(s)||C.isEmpty(s)){const f=this.getHigherLevelSiblings(r,"right");if(f.every((g,w)=>w===f.length-1&&C.isLineBreakTag(g)||C.isEmpty(g)&&!C.isLineBreakTag(g))&&c===r.textContent.length)return!0}const h=s.textContent.replace(/\s+$/,"");return r===s&&c>=h.length}setToBlock(e,n=this.positions.DEFAULT,r=0){var s;const{BlockManager:c,BlockSelection:h}=this.Editor;if(h.clearSelection(),!e.focusable){(s=window.getSelection())==null||s.removeAllRanges(),h.selectBlock(e),c.currentBlock=e;return}let f;switch(n){case this.positions.START:f=e.firstInput;break;case this.positions.END:f=e.lastInput;break;default:f=e.currentInput}if(!f)return;const g=C.getDeepestNode(f,n===this.positions.END),w=C.getContentLength(g);switch(!0){case n===this.positions.START:r=0;break;case n===this.positions.END:case r>w:r=w;break}this.set(g,r),c.setCurrentBlockByChildNode(e.holder),c.currentBlock.currentInput=f}setToInput(e,n=this.positions.DEFAULT,r=0){const{currentBlock:s}=this.Editor.BlockManager,c=C.getDeepestNode(e);switch(n){case this.positions.START:this.set(c,0);break;case this.positions.END:this.set(c,C.getContentLength(c));break;default:r&&this.set(c,r)}s.currentInput=e}set(e,n=0){const{top:r,bottom:s}=nt.setCursor(e,n),{innerHeight:c}=window;r<0?window.scrollBy(0,r-30):s>c&&window.scrollBy(0,s-c+30)}setToTheLastBlock(){const e=this.Editor.BlockManager.lastBlock;if(e)if(e.tool.isDefault&&e.isEmpty)this.setToBlock(e);else{const n=this.Editor.BlockManager.insertAtEnd();this.setToBlock(n)}}extractFragmentFromCaretPosition(){const e=nt.get();if(e.rangeCount){const n=e.getRangeAt(0),r=this.Editor.BlockManager.currentBlock.currentInput;if(n.deleteContents(),r)if(C.isNativeInput(r)){const s=r,c=document.createDocumentFragment(),h=s.value.substring(0,s.selectionStart),f=s.value.substring(s.selectionStart);return c.textContent=f,s.value=h,c}else{const s=n.cloneRange();return s.selectNodeContents(r),s.setStart(n.endContainer,n.endOffset),s.extractContents()}}}navigateNext(e=!1){const{BlockManager:n}=this.Editor,{currentBlock:r,nextBlock:s}=n,{nextInput:c}=r,h=this.isAtEnd;let f=s;const g=e||h;if(c&&g)return this.setToInput(c,this.positions.START),!0;if(f===null){if(r.tool.isDefault||!g)return!1;f=n.insertAtEnd()}return g?(this.setToBlock(f,this.positions.START),!0):!1}navigatePrevious(e=!1){const{currentBlock:n,previousBlock:r}=this.Editor.BlockManager;if(!n)return!1;const{previousInput:s}=n,c=e||this.isAtStart;return s&&c?(this.setToInput(s,this.positions.END),!0):r!==null&&c?(this.setToBlock(r,this.positions.END),!0):!1}createShadow(e){const n=document.createElement("span");n.classList.add(mi.CSS.shadowCaret),e.insertAdjacentElement("beforeend",n)}restoreCaret(e){const n=e.querySelector(`.${mi.CSS.shadowCaret}`);if(!n)return;new nt().expandToTag(n);const r=document.createRange();r.selectNode(n),r.extractContents()}insertContentAtCaretPosition(e){const n=document.createDocumentFragment(),r=document.createElement("div"),s=nt.get(),c=nt.range;r.innerHTML=e,Array.from(r.childNodes).forEach(w=>n.appendChild(w)),n.childNodes.length===0&&n.appendChild(new Text);const h=n.lastChild;c.deleteContents(),c.insertNode(n);const f=document.createRange(),g=h.nodeType===Node.TEXT_NODE?h:h.firstChild;g!==null&&g.textContent!==null&&f.setStart(g,g.textContent.length),s.removeAllRanges(),s.addRange(f)}getHigherLevelSiblings(e,n){let r=e;const s=[];for(;r.parentNode&&r.parentNode.contentEditable!=="true";)r=r.parentNode;const c=n==="left"?"previousSibling":"nextSibling";for(;r[c];)r=r[c],s.push(r);return s}}class $v extends bt{constructor(){super(...arguments),this.onMouseUp=()=>{this.listeners.off(document,"mouseover",this.onMouseOver),this.listeners.off(document,"mouseup",this.onMouseUp)},this.onMouseOver=e=>{const{BlockManager:n,BlockSelection:r}=this.Editor;if(e.relatedTarget===null&&e.target===null)return;const s=n.getBlockByChildNode(e.relatedTarget)||this.lastSelectedBlock,c=n.getBlockByChildNode(e.target);if(!(!s||!c)&&c!==s){if(s===this.firstSelectedBlock){nt.get().removeAllRanges(),s.selected=!0,c.selected=!0,r.clearCache();return}if(c===this.firstSelectedBlock){s.selected=!1,c.selected=!1,r.clearCache();return}this.Editor.InlineToolbar.close(),this.toggleBlocksSelectedState(s,c),this.lastSelectedBlock=c}}}async prepare(){this.listeners.on(document,"mousedown",e=>{this.enableCrossBlockSelection(e)})}watchSelection(e){if(e.button!==Cb.LEFT)return;const{BlockManager:n}=this.Editor;this.firstSelectedBlock=n.getBlock(e.target),this.lastSelectedBlock=this.firstSelectedBlock,this.listeners.on(document,"mouseover",this.onMouseOver),this.listeners.on(document,"mouseup",this.onMouseUp)}get isCrossBlockSelectionStarted(){return!!this.firstSelectedBlock&&!!this.lastSelectedBlock}toggleBlockSelectedState(e=!0){const{BlockManager:n,BlockSelection:r}=this.Editor;this.lastSelectedBlock||(this.lastSelectedBlock=this.firstSelectedBlock=n.currentBlock),this.firstSelectedBlock===this.lastSelectedBlock&&(this.firstSelectedBlock.selected=!0,r.clearCache(),nt.get().removeAllRanges());const s=n.blocks.indexOf(this.lastSelectedBlock)+(e?1:-1),c=n.blocks[s];c&&(this.lastSelectedBlock.selected!==c.selected?(c.selected=!0,r.clearCache()):(this.lastSelectedBlock.selected=!1,r.clearCache()),this.lastSelectedBlock=c,this.Editor.InlineToolbar.close(),c.holder.scrollIntoView({block:"nearest"}))}clear(e){const{BlockManager:n,BlockSelection:r,Caret:s}=this.Editor,c=n.blocks.indexOf(this.firstSelectedBlock),h=n.blocks.indexOf(this.lastSelectedBlock);if(r.anyBlockSelected&&c>-1&&h>-1&&e&&e instanceof KeyboardEvent)switch(e.keyCode){case ot.DOWN:case ot.RIGHT:s.setToBlock(n.blocks[Math.max(c,h)],s.positions.END);break;case ot.UP:case ot.LEFT:s.setToBlock(n.blocks[Math.min(c,h)],s.positions.START);break;default:s.setToBlock(n.blocks[Math.max(c,h)],s.positions.END)}this.firstSelectedBlock=this.lastSelectedBlock=null}enableCrossBlockSelection(e){const{UI:n}=this.Editor;nt.isCollapsed||this.Editor.BlockSelection.clearSelection(e),n.nodes.redactor.contains(e.target)?this.watchSelection(e):this.Editor.BlockSelection.clearSelection(e)}toggleBlocksSelectedState(e,n){const{BlockManager:r,BlockSelection:s}=this.Editor,c=r.blocks.indexOf(e),h=r.blocks.indexOf(n),f=e.selected!==n.selected;for(let g=Math.min(c,h);g<=Math.max(c,h);g++){const w=r.blocks[g];w!==this.firstSelectedBlock&&w!==(f?e:n)&&(r.blocks[g].selected=!r.blocks[g].selected,s.clearCache())}}}class Yv extends bt{constructor(){super(...arguments),this.isStartedAtEditor=!1}toggleReadOnly(e){e?this.disableModuleBindings():this.enableModuleBindings()}enableModuleBindings(){const{UI:e}=this.Editor;this.readOnlyMutableListeners.on(e.nodes.holder,"drop",async n=>{await this.processDrop(n)},!0),this.readOnlyMutableListeners.on(e.nodes.holder,"dragstart",()=>{this.processDragStart()}),this.readOnlyMutableListeners.on(e.nodes.holder,"dragover",n=>{this.processDragOver(n)},!0)}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}async processDrop(e){const{BlockManager:n,Caret:r,Paste:s}=this.Editor;e.preventDefault(),n.blocks.forEach(h=>{h.dropTarget=!1}),nt.isAtEditor&&!nt.isCollapsed&&this.isStartedAtEditor&&document.execCommand("delete"),this.isStartedAtEditor=!1;const c=n.setCurrentBlockByChildNode(e.target);if(c)this.Editor.Caret.setToBlock(c,r.positions.END);else{const h=n.setCurrentBlockByChildNode(n.lastBlock.holder);this.Editor.Caret.setToBlock(h,r.positions.END)}await s.processDataTransfer(e.dataTransfer,!0)}processDragStart(){nt.isAtEditor&&!nt.isCollapsed&&(this.isStartedAtEditor=!0),this.Editor.InlineToolbar.close()}processDragOver(e){e.preventDefault()}}class Kv extends bt{constructor({config:e,eventsDispatcher:n}){super({config:e,eventsDispatcher:n}),this.disabled=!1,this.batchingTimeout=null,this.batchingOnChangeQueue=new Map,this.batchTime=400,this.mutationObserver=new MutationObserver(r=>{this.redactorChanged(r)}),this.eventsDispatcher.on(fc,r=>{this.particularBlockChanged(r.event)}),this.eventsDispatcher.on(gc,()=>{this.disable()}),this.eventsDispatcher.on(mc,()=>{this.enable()})}enable(){this.mutationObserver.observe(this.Editor.UI.nodes.redactor,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.disabled=!1}disable(){this.mutationObserver.disconnect(),this.disabled=!0}particularBlockChanged(e){this.disabled||!Mt(this.config.onChange)||(this.batchingOnChangeQueue.set(`block:${e.detail.target.id}:event:${e.type}`,e),this.batchingTimeout&&clearTimeout(this.batchingTimeout),this.batchingTimeout=setTimeout(()=>{let n;this.batchingOnChangeQueue.size===1?n=this.batchingOnChangeQueue.values().next().value:n=Array.from(this.batchingOnChangeQueue.values()),this.config.onChange&&this.config.onChange(this.Editor.API.methods,n),this.batchingOnChangeQueue.clear()},this.batchTime))}redactorChanged(e){this.eventsDispatcher.emit(Gr,{mutations:e})}}const Tc=class extends bt{constructor(){super(...arguments),this.MIME_TYPE="application/x-editor-js",this.toolsTags={},this.tagsByTool={},this.toolsPatterns=[],this.toolsFiles={},this.exceptionList=[],this.processTool=l=>{try{const e=l.create({},{},!1);if(l.pasteConfig===!1){this.exceptionList.push(l.name);return}if(!Mt(e.onPaste))return;this.getTagsConfig(l),this.getFilesConfig(l),this.getPatternsConfig(l)}catch(e){yt(`Paste handling for «${l.name}» Tool hasn't been set up because of the error`,"warn",e)}},this.handlePasteEvent=async l=>{const{BlockManager:e,Toolbar:n}=this.Editor,r=e.setCurrentBlockByChildNode(l.target);!r||this.isNativeBehaviour(l.target)&&!l.clipboardData.types.includes("Files")||r&&this.exceptionList.includes(r.name)||(l.preventDefault(),this.processDataTransfer(l.clipboardData),n.close())}}async prepare(){this.processTools()}toggleReadOnly(l){l?this.unsetCallback():this.setCallback()}async processDataTransfer(l,e=!1){const{Tools:n}=this.Editor,r=l.types;if((r.includes?r.includes("Files"):r.contains("Files"))&&!Le(this.toolsFiles)){await this.processFiles(l.files);return}const s=l.getData(this.MIME_TYPE),c=l.getData("text/plain");let h=l.getData("text/html");if(s)try{this.insertEditorJSData(JSON.parse(s));return}catch{}e&&c.trim()&&h.trim()&&(h="<p>"+(h.trim()?h:c)+"</p>");const f=Object.keys(this.toolsTags).reduce((I,E)=>(I[E.toLowerCase()]=this.toolsTags[E].sanitizationConfig??{},I),{}),g=Object.assign({},f,n.getAllInlineToolsSanitizeConfig(),{br:{}}),w=Je(h,g);!w.trim()||w.trim()===c||!C.isHTMLString(w)?await this.processText(c):await this.processText(w,!0)}async processText(l,e=!1){const{Caret:n,BlockManager:r}=this.Editor,s=e?this.processHTML(l):this.processPlain(l);if(!s.length)return;if(s.length===1){s[0].isBlock?this.processSingleBlock(s.pop()):this.processInlinePaste(s.pop());return}const c=r.currentBlock&&r.currentBlock.tool.isDefault&&r.currentBlock.isEmpty;s.map(async(h,f)=>this.insertBlock(h,f===0&&c)),r.currentBlock&&n.setToBlock(r.currentBlock,n.positions.END)}setCallback(){this.listeners.on(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}unsetCallback(){this.listeners.off(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}processTools(){const l=this.Editor.Tools.blockTools;Array.from(l.values()).forEach(this.processTool)}collectTagNames(l){return gn(l)?[l]:jt(l)?Object.keys(l):[]}getTagsConfig(l){if(l.pasteConfig===!1)return;const e=l.pasteConfig.tags||[],n=[];e.forEach(r=>{const s=this.collectTagNames(r);n.push(...s),s.forEach(c=>{if(Object.prototype.hasOwnProperty.call(this.toolsTags,c)){yt(`Paste handler for «${l.name}» Tool on «${c}» tag is skipped because it is already used by «${this.toolsTags[c].tool.name}» Tool.`,"warn");return}const h=jt(r)?r[c]:null;this.toolsTags[c.toUpperCase()]={tool:l,sanitizationConfig:h}})}),this.tagsByTool[l.name]=n.map(r=>r.toUpperCase())}getFilesConfig(l){if(l.pasteConfig===!1)return;const{files:e={}}=l.pasteConfig;let{extensions:n,mimeTypes:r}=e;!n&&!r||(n&&!Array.isArray(n)&&(yt(`«extensions» property of the onDrop config for «${l.name}» Tool should be an array`),n=[]),r&&!Array.isArray(r)&&(yt(`«mimeTypes» property of the onDrop config for «${l.name}» Tool should be an array`),r=[]),r&&(r=r.filter(s=>Bb(s)?!0:(yt(`MIME type value «${s}» for the «${l.name}» Tool is not a valid MIME type`,"warn"),!1))),this.toolsFiles[l.name]={extensions:n||[],mimeTypes:r||[]})}getPatternsConfig(l){l.pasteConfig===!1||!l.pasteConfig.patterns||Le(l.pasteConfig.patterns)||Object.entries(l.pasteConfig.patterns).forEach(([e,n])=>{n instanceof RegExp||yt(`Pattern ${n} for «${l.name}» Tool is skipped because it should be a Regexp instance.`,"warn"),this.toolsPatterns.push({key:e,pattern:n,tool:l})})}isNativeBehaviour(l){return C.isNativeInput(l)}async processFiles(l){const{BlockManager:e}=this.Editor;let n;n=await Promise.all(Array.from(l).map(s=>this.processFile(s))),n=n.filter(s=>!!s);const r=e.currentBlock.tool.isDefault&&e.currentBlock.isEmpty;n.forEach((s,c)=>{e.paste(s.type,s.event,c===0&&r)})}async processFile(l){const e=_b(l),n=Object.entries(this.toolsFiles).find(([s,{mimeTypes:c,extensions:h}])=>{const[f,g]=l.type.split("/"),w=h.find(E=>E.toLowerCase()===e.toLowerCase()),I=c.find(E=>{const[D,U]=E.split("/");return D===f&&(U===g||U==="*")});return!!w||!!I});if(!n)return;const[r]=n;return{event:this.composePasteEvent("file",{file:l}),type:r}}processHTML(l){const{Tools:e}=this.Editor,n=C.make("DIV");return n.innerHTML=l,this.getNodes(n).map(r=>{let s,c=e.defaultTool,h=!1;switch(r.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:s=C.make("div"),s.appendChild(r);break;case Node.ELEMENT_NODE:s=r,h=!0,this.toolsTags[s.tagName]&&(c=this.toolsTags[s.tagName].tool);break}const{tags:f}=c.pasteConfig||{tags:[]},g=f.reduce((E,D)=>(this.collectTagNames(D).forEach(U=>{const T=jt(D)?D[U]:null;E[U.toLowerCase()]=T||{}}),E),{}),w=Object.assign({},g,c.baseSanitizeConfig);if(s.tagName.toLowerCase()==="table"){const E=Je(s.outerHTML,w);s=C.make("div",void 0,{innerHTML:E}).firstChild}else s.innerHTML=Je(s.innerHTML,w);const I=this.composePasteEvent("tag",{data:s});return{content:s,isBlock:h,tool:c.name,event:I}}).filter(r=>{const s=C.isEmpty(r.content),c=C.isSingleTag(r.content);return!s||c})}processPlain(l){const{defaultBlock:e}=this.config;if(!l)return[];const n=e;return l.split(/\r?\n/).filter(r=>r.trim()).map(r=>{const s=C.make("div");s.textContent=r;const c=this.composePasteEvent("tag",{data:s});return{content:s,tool:n,isBlock:!1,event:c}})}async processSingleBlock(l){const{Caret:e,BlockManager:n}=this.Editor,{currentBlock:r}=n;if(!r||l.tool!==r.name||!C.containsOnlyInlineElements(l.content.innerHTML)){this.insertBlock(l,(r==null?void 0:r.tool.isDefault)&&r.isEmpty);return}e.insertContentAtCaretPosition(l.content.innerHTML)}async processInlinePaste(l){const{BlockManager:e,Caret:n}=this.Editor,{content:r}=l;if(e.currentBlock&&e.currentBlock.tool.isDefault&&r.textContent.length<Tc.PATTERN_PROCESSING_MAX_LENGTH){const s=await this.processPattern(r.textContent);if(s){const c=e.currentBlock&&e.currentBlock.tool.isDefault&&e.currentBlock.isEmpty,h=e.paste(s.tool,s.event,c);n.setToBlock(h,n.positions.END);return}}if(e.currentBlock&&e.currentBlock.currentInput){const s=e.currentBlock.tool.baseSanitizeConfig;document.execCommand("insertHTML",!1,Je(r.innerHTML,s))}else this.insertBlock(l)}async processPattern(l){const e=this.toolsPatterns.find(n=>{const r=n.pattern.exec(l);return r?l===r.shift():!1});return e?{event:this.composePasteEvent("pattern",{key:e.key,data:l}),tool:e.tool.name}:void 0}insertBlock(l,e=!1){const{BlockManager:n,Caret:r}=this.Editor,{currentBlock:s}=n;let c;if(e&&s&&s.isEmpty){c=n.paste(l.tool,l.event,!0),r.setToBlock(c,r.positions.END);return}c=n.paste(l.tool,l.event),r.setToBlock(c,r.positions.END)}insertEditorJSData(l){const{BlockManager:e,Caret:n,Tools:r}=this.Editor;bc(l,s=>r.blockTools.get(s).sanitizeConfig).forEach(({tool:s,data:c},h)=>{let f=!1;h===0&&(f=e.currentBlock&&e.currentBlock.tool.isDefault&&e.currentBlock.isEmpty);const g=e.insert({tool:s,data:c,replace:f});n.setToBlock(g,n.positions.END)})}processElementNode(l,e,n){const r=Object.keys(this.toolsTags),s=l,{tool:c}=this.toolsTags[s.tagName]||{},h=this.tagsByTool[c==null?void 0:c.name]||[],f=r.includes(s.tagName),g=C.blockElements.includes(s.tagName.toLowerCase()),w=Array.from(s.children).some(({tagName:E})=>r.includes(E)&&!h.includes(E)),I=Array.from(s.children).some(({tagName:E})=>C.blockElements.includes(E.toLowerCase()));if(!g&&!f&&!w)return n.appendChild(s),[...e,n];if(f&&!w||g&&!I&&!w)return[...e,n,s]}getNodes(l){const e=Array.from(l.childNodes);let n;const r=(s,c)=>{if(C.isEmpty(c)&&!C.isSingleTag(c))return s;const h=s[s.length-1];let f=new DocumentFragment;switch(h&&C.isFragment(h)&&(f=s.pop()),c.nodeType){case Node.ELEMENT_NODE:if(n=this.processElementNode(c,s,f),n)return n;break;case Node.TEXT_NODE:return f.appendChild(c),[...s,f];default:return[...s,f]}return[...s,...Array.from(c.childNodes).reduce(r,[])]};return e.reduce(r,[])}composePasteEvent(l,e){return new CustomEvent(l,{detail:e})}};let _c=Tc;_c.PATTERN_PROCESSING_MAX_LENGTH=450;class qv extends bt{constructor(){super(...arguments),this.toolsDontSupportReadOnly=[],this.readOnlyEnabled=!1}get isEnabled(){return this.readOnlyEnabled}async prepare(){const{Tools:e}=this.Editor,{blockTools:n}=e,r=[];Array.from(n.entries()).forEach(([s,c])=>{c.isReadOnlySupported||r.push(s)}),this.toolsDontSupportReadOnly=r,this.config.readOnly&&r.length>0&&this.throwCriticalError(),this.toggle(this.config.readOnly)}async toggle(e=!this.readOnlyEnabled){e&&this.toolsDontSupportReadOnly.length>0&&this.throwCriticalError();const n=this.readOnlyEnabled;this.readOnlyEnabled=e;for(const s in this.Editor)this.Editor[s].toggleReadOnly&&this.Editor[s].toggleReadOnly(e);if(n===e)return this.readOnlyEnabled;const r=await this.Editor.Saver.save();return await this.Editor.BlockManager.clear(),await this.Editor.Renderer.render(r.blocks),this.readOnlyEnabled}throwCriticalError(){throw new uc(`To enable read-only mode all connected tools should support it. Tools ${this.toolsDontSupportReadOnly.join(", ")} don't support read-only mode.`)}}class ko extends bt{constructor(){super(...arguments),this.isRectSelectionActivated=!1,this.SCROLL_SPEED=3,this.HEIGHT_OF_SCROLL_ZONE=40,this.BOTTOM_SCROLL_ZONE=1,this.TOP_SCROLL_ZONE=2,this.MAIN_MOUSE_BUTTON=0,this.mousedown=!1,this.isScrolling=!1,this.inScrollZone=null,this.startX=0,this.startY=0,this.mouseX=0,this.mouseY=0,this.stackOfSelected=[],this.listenerIds=[]}static get CSS(){return{overlay:"codex-editor-overlay",overlayContainer:"codex-editor-overlay__container",rect:"codex-editor-overlay__rectangle",topScrollZone:"codex-editor-overlay__scroll-zone--top",bottomScrollZone:"codex-editor-overlay__scroll-zone--bottom"}}prepare(){this.enableModuleBindings()}startSelection(e,n){const r=document.elementFromPoint(e-window.pageXOffset,n-window.pageYOffset);r.closest(`.${this.Editor.Toolbar.CSS.toolbar}`)||(this.Editor.BlockSelection.allBlocksSelected=!1,this.clearSelection(),this.stackOfSelected=[]);const s=[`.${Ve.CSS.content}`,`.${this.Editor.Toolbar.CSS.toolbar}`,`.${this.Editor.InlineToolbar.CSS.inlineToolbar}`],c=r.closest("."+this.Editor.UI.CSS.editorWrapper),h=s.some(f=>!!r.closest(f));!c||h||(this.mousedown=!0,this.startX=e,this.startY=n)}endSelection(){this.mousedown=!1,this.startX=0,this.startY=0,this.overlayRectangle.style.display="none"}isRectActivated(){return this.isRectSelectionActivated}clearSelection(){this.isRectSelectionActivated=!1}enableModuleBindings(){const{container:e}=this.genHTML();this.listeners.on(e,"mousedown",n=>{this.processMouseDown(n)},!1),this.listeners.on(document.body,"mousemove",Yr(n=>{this.processMouseMove(n)},10),{passive:!0}),this.listeners.on(document.body,"mouseleave",()=>{this.processMouseLeave()}),this.listeners.on(window,"scroll",Yr(n=>{this.processScroll(n)},10),{passive:!0}),this.listeners.on(document.body,"mouseup",()=>{this.processMouseUp()},!1)}processMouseDown(e){e.button===this.MAIN_MOUSE_BUTTON&&(e.target.closest(C.allInputsSelector)!==null||this.startSelection(e.pageX,e.pageY))}processMouseMove(e){this.changingRectangle(e),this.scrollByZones(e.clientY)}processMouseLeave(){this.clearSelection(),this.endSelection()}processScroll(e){this.changingRectangle(e)}processMouseUp(){this.clearSelection(),this.endSelection()}scrollByZones(e){if(this.inScrollZone=null,e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.TOP_SCROLL_ZONE),document.documentElement.clientHeight-e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.BOTTOM_SCROLL_ZONE),!this.inScrollZone){this.isScrolling=!1;return}this.isScrolling||(this.scrollVertical(this.inScrollZone===this.TOP_SCROLL_ZONE?-this.SCROLL_SPEED:this.SCROLL_SPEED),this.isScrolling=!0)}genHTML(){const{UI:e}=this.Editor,n=e.nodes.holder.querySelector("."+e.CSS.editorWrapper),r=C.make("div",ko.CSS.overlay,{}),s=C.make("div",ko.CSS.overlayContainer,{}),c=C.make("div",ko.CSS.rect,{});return s.appendChild(c),r.appendChild(s),n.appendChild(r),this.overlayRectangle=c,{container:n,overlay:r}}scrollVertical(e){if(!(this.inScrollZone&&this.mousedown))return;const n=window.pageYOffset;window.scrollBy(0,e),this.mouseY+=window.pageYOffset-n,setTimeout(()=>{this.scrollVertical(e)},0)}changingRectangle(e){if(!this.mousedown)return;e.pageY!==void 0&&(this.mouseX=e.pageX,this.mouseY=e.pageY);const{rightPos:n,leftPos:r,index:s}=this.genInfoForMouseSelection(),c=this.startX>n&&this.mouseX>n,h=this.startX<r&&this.mouseX<r;this.rectCrossesBlocks=!(c||h),this.isRectSelectionActivated||(this.rectCrossesBlocks=!1,this.isRectSelectionActivated=!0,this.shrinkRectangleToPoint(),this.overlayRectangle.style.display="block"),this.updateRectangleSize(),this.Editor.Toolbar.close(),s!==void 0&&(this.trySelectNextBlock(s),this.inverseSelection(),nt.get().removeAllRanges())}shrinkRectangleToPoint(){this.overlayRectangle.style.left=`${this.startX-window.pageXOffset}px`,this.overlayRectangle.style.top=`${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.bottom=`calc(100% - ${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.right=`calc(100% - ${this.startX-window.pageXOffset}px`}inverseSelection(){const e=this.Editor.BlockManager.getBlockByIndex(this.stackOfSelected[0]).selected;if(this.rectCrossesBlocks&&!e)for(const n of this.stackOfSelected)this.Editor.BlockSelection.selectBlockByIndex(n);if(!this.rectCrossesBlocks&&e)for(const n of this.stackOfSelected)this.Editor.BlockSelection.unSelectBlockByIndex(n)}updateRectangleSize(){this.mouseY>=this.startY?(this.overlayRectangle.style.top=`${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.bottom=`calc(100% - ${this.mouseY-window.pageYOffset}px`):(this.overlayRectangle.style.bottom=`calc(100% - ${this.startY-window.pageYOffset}px`,this.overlayRectangle.style.top=`${this.mouseY-window.pageYOffset}px`),this.mouseX>=this.startX?(this.overlayRectangle.style.left=`${this.startX-window.pageXOffset}px`,this.overlayRectangle.style.right=`calc(100% - ${this.mouseX-window.pageXOffset}px`):(this.overlayRectangle.style.right=`calc(100% - ${this.startX-window.pageXOffset}px`,this.overlayRectangle.style.left=`${this.mouseX-window.pageXOffset}px`)}genInfoForMouseSelection(){const e=document.body.offsetWidth/2,n=this.mouseY-window.pageYOffset,r=document.elementFromPoint(e,n),s=this.Editor.BlockManager.getBlockByChildNode(r);let c;s!==void 0&&(c=this.Editor.BlockManager.blocks.findIndex(I=>I.holder===s.holder));const h=this.Editor.BlockManager.lastBlock.holder.querySelector("."+Ve.CSS.content),f=Number.parseInt(window.getComputedStyle(h).width,10)/2,g=e-f,w=e+f;return{index:c,leftPos:g,rightPos:w}}addBlockInSelection(e){this.rectCrossesBlocks&&this.Editor.BlockSelection.selectBlockByIndex(e),this.stackOfSelected.push(e)}trySelectNextBlock(e){const n=this.stackOfSelected[this.stackOfSelected.length-1]===e,r=this.stackOfSelected.length,s=1,c=-1,h=0;if(n)return;const f=this.stackOfSelected[r-1]-this.stackOfSelected[r-2]>0;let g=h;r>1&&(g=f?s:c);const w=e>this.stackOfSelected[r-1]&&g===s,I=e<this.stackOfSelected[r-1]&&g===c,E=!(w||I||g===h);if(!E&&(e>this.stackOfSelected[r-1]||this.stackOfSelected[r-1]===void 0)){let T=this.stackOfSelected[r-1]+1||e;for(T;T<=e;T++)this.addBlockInSelection(T);return}if(!E&&e<this.stackOfSelected[r-1]){for(let T=this.stackOfSelected[r-1]-1;T>=e;T--)this.addBlockInSelection(T);return}if(!E)return;let D=r-1,U;for(e>this.stackOfSelected[r-1]?U=()=>e>this.stackOfSelected[D]:U=()=>e<this.stackOfSelected[D];U();)this.rectCrossesBlocks&&this.Editor.BlockSelection.unSelectBlockByIndex(this.stackOfSelected[D]),this.stackOfSelected.pop(),D--}}class Gv extends bt{async render(e){return new Promise(n=>{const{Tools:r,BlockManager:s}=this.Editor;if(e.length===0)s.insert();else{const c=e.map(({type:h,data:f,tunes:g,id:w})=>{r.available.has(h)===!1&&(Ne(`Tool «${h}» is not found. Check 'tools' property at the Editor.js config.`,"warn"),f=this.composeStubDataForTool(h,f,w),h=r.stubTool);let I;try{I=s.composeBlock({id:w,tool:h,data:f,tunes:g})}catch(E){yt(`Block «${h}» skipped because of plugins error`,"error",{data:f,error:E}),f=this.composeStubDataForTool(h,f,w),h=r.stubTool,I=s.composeBlock({id:w,tool:h,data:f,tunes:g})}return I});s.insertMany(c)}window.requestIdleCallback(()=>{n()},{timeout:2e3})})}composeStubDataForTool(e,n,r){const{Tools:s}=this.Editor;let c=e;if(s.unavailable.has(e)){const h=s.unavailable.get(e).toolbox;h!==void 0&&h[0].title!==void 0&&(c=h[0].title)}return{savedData:{id:r,type:e,data:n},title:c}}}class jv extends bt{async save(){const{BlockManager:e,Tools:n}=this.Editor,r=e.blocks,s=[];try{r.forEach(f=>{s.push(this.getSavedData(f))});const c=await Promise.all(s),h=await bc(c,f=>n.blockTools.get(f).sanitizeConfig);return this.makeOutput(h)}catch(c){Ne("Saving failed due to the Error %o","error",c)}}async getSavedData(e){const n=await e.save(),r=n&&await e.validate(n.data);return{...n,isValid:r}}makeOutput(e){const n=[];return e.forEach(({id:r,tool:s,data:c,tunes:h,isValid:f})=>{if(!f){yt(`Block «${s}» skipped because saved data is invalid`);return}if(s===this.Editor.Tools.stubTool){n.push(c);return}const g={id:r,type:s,data:c,...!Le(h)&&{tunes:h}};n.push(g)}),{time:+new Date,blocks:n,version:"2.29.0"}}}(function(){try{if(typeof document<"u"){var l=document.createElement("style");l.appendChild(document.createTextNode(".ce-paragraph{line-height:1.6em;outline:none}.ce-paragraph[data-placeholder]:empty:before{content:attr(data-placeholder);color:#707684;font-weight:400;opacity:0}.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty:before{opacity:1}.codex-editor--toolbox-opened .ce-block:first-child .ce-paragraph[data-placeholder]:empty:before,.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty:focus:before{opacity:0}.ce-paragraph p:first-of-type{margin-top:0}.ce-paragraph p:last-of-type{margin-bottom:0}")),document.head.appendChild(l)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const Xv='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 9V7.2C8 7.08954 8.08954 7 8.2 7L12 7M16 9V7.2C16 7.08954 15.9105 7 15.8 7L12 7M12 7L12 17M12 17H10M12 17H14"/></svg>';/**
 * Base Paragraph Block for the Editor.js.
 * Represents a regular text block
 *
 * @author CodeX (team@codex.so)
 * @copyright CodeX 2018
 * @license The MIT License (MIT)
 */class ls{static get DEFAULT_PLACEHOLDER(){return""}constructor({data:e,config:n,api:r,readOnly:s}){this.api=r,this.readOnly=s,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this)),this._placeholder=n.placeholder?n.placeholder:ls.DEFAULT_PLACEHOLDER,this._data={},this._element=null,this._preserveBlank=n.preserveBlank!==void 0?n.preserveBlank:!1,this.data=e}onKeyUp(e){if(e.code!=="Backspace"&&e.code!=="Delete")return;const{textContent:n}=this._element;n===""&&(this._element.innerHTML="")}drawView(){const e=document.createElement("DIV");return e.classList.add(this._CSS.wrapper,this._CSS.block),e.contentEditable=!1,e.dataset.placeholder=this.api.i18n.t(this._placeholder),this._data.text&&(e.innerHTML=this._data.text),this.readOnly||(e.contentEditable=!0,e.addEventListener("keyup",this.onKeyUp)),e}render(){return this._element=this.drawView(),this._element}merge(e){const n={text:this.data.text+e.text};this.data=n}validate(e){return!(e.text.trim()===""&&!this._preserveBlank)}save(e){return{text:e.innerHTML}}onPaste(e){const n={text:e.detail.data.innerHTML};this.data=n}static get conversionConfig(){return{export:"text",import:"text"}}static get sanitize(){return{text:{br:!0}}}static get isReadOnlySupported(){return!0}get data(){if(this._element!==null){const e=this._element.innerHTML;this._data.text=e}return this._data}set data(e){this._data=e||{},this._element!==null&&this.hydrate()}hydrate(){window.requestAnimationFrame(()=>{this._element.innerHTML=this._data.text||""})}static get pasteConfig(){return{tags:["P"]}}static get toolbox(){return{icon:Xv,title:"Text"}}}class cs{constructor(){this.commandName="bold",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--bold"},this.nodes={button:void 0}}static get sanitize(){return{b:{}}}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.innerHTML=bv,this.nodes.button}surround(){document.execCommand(this.commandName)}checkState(){const e=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,e),e}get shortcut(){return"CMD+B"}}cs.isInline=!0;cs.title="Bold";class ds{constructor(){this.commandName="italic",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--italic"},this.nodes={button:null}}static get sanitize(){return{i:{}}}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.innerHTML=xv,this.nodes.button}surround(){document.execCommand(this.commandName)}checkState(){const e=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,e),e}get shortcut(){return"CMD+I"}}ds.isInline=!0;ds.title="Italic";class hs{constructor({api:e}){this.commandLink="createLink",this.commandUnlink="unlink",this.ENTER_KEY=13,this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--link",buttonUnlink:"ce-inline-tool--unlink",input:"ce-inline-tool-input",inputShowed:"ce-inline-tool-input--showed"},this.nodes={button:null,input:null},this.inputOpened=!1,this.toolbar=e.toolbar,this.inlineToolbar=e.inlineToolbar,this.notifier=e.notifier,this.i18n=e.i18n,this.selection=new nt}static get sanitize(){return{a:{href:!0,target:"_blank",rel:"nofollow"}}}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.innerHTML=jl,this.nodes.button}renderActions(){return this.nodes.input=document.createElement("input"),this.nodes.input.placeholder=this.i18n.t("Add a link"),this.nodes.input.classList.add(this.CSS.input),this.nodes.input.addEventListener("keydown",e=>{e.keyCode===this.ENTER_KEY&&this.enterPressed(e)}),this.nodes.input}surround(e){if(e){this.inputOpened?(this.selection.restore(),this.selection.removeFakeBackground()):(this.selection.setFakeBackground(),this.selection.save());const n=this.selection.findParentTag("A");if(n){this.selection.expandToTag(n),this.unlink(),this.closeActions(),this.checkState(),this.toolbar.close();return}}this.toggleActions()}checkState(){const e=this.selection.findParentTag("A");if(e){this.nodes.button.innerHTML=Sv,this.nodes.button.classList.add(this.CSS.buttonUnlink),this.nodes.button.classList.add(this.CSS.buttonActive),this.openActions();const n=e.getAttribute("href");this.nodes.input.value=n!=="null"?n:"",this.selection.save()}else this.nodes.button.innerHTML=jl,this.nodes.button.classList.remove(this.CSS.buttonUnlink),this.nodes.button.classList.remove(this.CSS.buttonActive);return!!e}clear(){this.closeActions()}get shortcut(){return"CMD+K"}toggleActions(){this.inputOpened?this.closeActions(!1):this.openActions(!0)}openActions(e=!1){this.nodes.input.classList.add(this.CSS.inputShowed),e&&this.nodes.input.focus(),this.inputOpened=!0}closeActions(e=!0){if(this.selection.isFakeBackgroundEnabled){const n=new nt;n.save(),this.selection.restore(),this.selection.removeFakeBackground(),n.restore()}this.nodes.input.classList.remove(this.CSS.inputShowed),this.nodes.input.value="",e&&this.selection.clearSaved(),this.inputOpened=!1}enterPressed(e){let n=this.nodes.input.value||"";if(!n.trim()){this.selection.restore(),this.unlink(),e.preventDefault(),this.closeActions();return}if(!this.validateURL(n)){this.notifier.show({message:"Pasted link is not valid.",style:"error"}),yt("Incorrect Link pasted","warn",n);return}n=this.prepareLink(n),this.selection.restore(),this.selection.removeFakeBackground(),this.insertLink(n),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.selection.collapseToEnd(),this.inlineToolbar.close()}validateURL(e){return!/\s/.test(e)}prepareLink(e){return e=e.trim(),e=this.addProtocol(e),e}addProtocol(e){if(/^(\w+):(\/\/)?/.test(e))return e;const n=/^\/[^/\s]/.test(e),r=e.substring(0,1)==="#",s=/^\/\/[^/\s]/.test(e);return!n&&!r&&!s&&(e="http://"+e),e}insertLink(e){const n=this.selection.findParentTag("A");n&&this.selection.expandToTag(n),document.execCommand(this.commandLink,!1,e)}unlink(){document.execCommand(this.commandUnlink)}}hs.isInline=!0;hs.title="Link";class Bc{constructor({data:e,api:n}){this.CSS={wrapper:"ce-stub",info:"ce-stub__info",title:"ce-stub__title",subtitle:"ce-stub__subtitle"},this.api=n,this.title=e.title||this.api.i18n.t("Error"),this.subtitle=this.api.i18n.t("The block can not be displayed correctly."),this.savedData=e.savedData,this.wrapper=this.make()}render(){return this.wrapper}save(){return this.savedData}make(){const e=C.make("div",this.CSS.wrapper),n=Tv,r=C.make("div",this.CSS.info),s=C.make("div",this.CSS.title,{textContent:this.title}),c=C.make("div",this.CSS.subtitle,{textContent:this.subtitle});return e.innerHTML=n,r.appendChild(s),r.appendChild(c),e.appendChild(r),e}}Bc.isReadOnlySupported=!0;class Zv extends as{constructor(){super(...arguments),this.type=wi.Inline}get title(){return this.constructable[ss.Title]}create(){return new this.constructable({api:this.api.getMethodsForTool(this),config:this.settings})}}class Vv extends as{constructor(){super(...arguments),this.type=wi.Tune}create(e,n){return new this.constructable({api:this.api.getMethodsForTool(this),config:this.settings,block:n,data:e})}}class Jt extends Map{get blockTools(){const e=Array.from(this.entries()).filter(([,n])=>n.isBlock());return new Jt(e)}get inlineTools(){const e=Array.from(this.entries()).filter(([,n])=>n.isInline());return new Jt(e)}get blockTunes(){const e=Array.from(this.entries()).filter(([,n])=>n.isTune());return new Jt(e)}get internalTools(){const e=Array.from(this.entries()).filter(([,n])=>n.isInternal);return new Jt(e)}get externalTools(){const e=Array.from(this.entries()).filter(([,n])=>!n.isInternal);return new Jt(e)}}var Jv=Object.defineProperty,Qv=Object.getOwnPropertyDescriptor,Lc=(l,e,n,r)=>{for(var s=r>1?void 0:r?Qv(e,n):e,c=l.length-1,h;c>=0;c--)(h=l[c])&&(s=(r?h(e,n,s):h(s))||s);return r&&s&&Jv(e,n,s),s};class us extends as{constructor(){super(...arguments),this.type=wi.Block,this.inlineTools=new Jt,this.tunes=new Jt}create(e,n,r){return new this.constructable({data:e,block:n,readOnly:r,api:this.api.getMethodsForTool(this),config:this.settings})}get isReadOnlySupported(){return this.constructable[Kn.IsReadOnlySupported]===!0}get isLineBreaksEnabled(){return this.constructable[Kn.IsEnabledLineBreaks]}get toolbox(){const e=this.constructable[Kn.Toolbox],n=this.config[fi.Toolbox];if(!Le(e)&&n!==!1)return n?Array.isArray(e)?Array.isArray(n)?n.map((r,s)=>{const c=e[s];return c?{...c,...r}:r}):[n]:Array.isArray(n)?n:[{...e,...n}]:Array.isArray(e)?e:[e]}get conversionConfig(){return this.constructable[Kn.ConversionConfig]}get enabledInlineTools(){return this.config[fi.EnabledInlineTools]||!1}get enabledBlockTunes(){return this.config[fi.EnabledBlockTunes]}get pasteConfig(){return this.constructable[Kn.PasteConfig]??{}}get sanitizeConfig(){const e=super.sanitizeConfig,n=this.baseSanitizeConfig;if(Le(e))return n;const r={};for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const c=e[s];jt(c)?r[s]=Object.assign({},n,c):r[s]=c}return r}get baseSanitizeConfig(){const e={};return Array.from(this.inlineTools.values()).forEach(n=>Object.assign(e,n.sanitizeConfig)),Array.from(this.tunes.values()).forEach(n=>Object.assign(e,n.sanitizeConfig)),e}}Lc([jn],us.prototype,"sanitizeConfig",1);Lc([jn],us.prototype,"baseSanitizeConfig",1);class t1{constructor(e,n,r){this.api=r,this.config=e,this.editorConfig=n}get(e){const{class:n,isInternal:r=!1,...s}=this.config[e],c=this.getConstructor(n);return new c({name:e,constructable:n,config:s,api:this.api,isDefault:e===this.editorConfig.defaultBlock,defaultPlaceholder:this.editorConfig.placeholder,isInternal:r})}getConstructor(e){switch(!0){case e[ss.IsInline]:return Zv;case e[Sc.IsTune]:return Vv;default:return us}}}class Ic{constructor({api:e}){this.CSS={animation:"wobble"},this.api=e}render(){return{icon:kc,title:this.api.i18n.t("Move down"),onActivate:()=>this.handleClick(),name:"move-down"}}handleClick(){const e=this.api.blocks.getCurrentBlockIndex(),n=this.api.blocks.getBlockByIndex(e+1);if(!n)throw new Error("Unable to move Block down since it is already the last");const r=n.holder,s=r.getBoundingClientRect();let c=Math.abs(window.innerHeight-r.offsetHeight);s.top<window.innerHeight&&(c=window.scrollY+r.offsetHeight),window.scrollTo(0,c),this.api.blocks.move(e+1),this.api.toolbar.toggleBlockSettings(!0)}}Ic.isTune=!0;class Ac{constructor({api:e}){this.api=e}render(){return{icon:kv,title:this.api.i18n.t("Delete"),name:"delete",confirmation:{title:this.api.i18n.t("Click to delete"),onActivate:()=>this.handleClick()}}}handleClick(){this.api.blocks.delete()}}Ac.isTune=!0;class Mc{constructor({api:e}){this.CSS={animation:"wobble"},this.api=e}render(){return{icon:vv,title:this.api.i18n.t("Move up"),onActivate:()=>this.handleClick(),name:"move-up"}}handleClick(){const e=this.api.blocks.getCurrentBlockIndex(),n=this.api.blocks.getBlockByIndex(e),r=this.api.blocks.getBlockByIndex(e-1);if(e===0||!n||!r)throw new Error("Unable to move Block up since it is already the first");const s=n.holder,c=r.holder,h=s.getBoundingClientRect(),f=c.getBoundingClientRect();let g;f.top>0?g=Math.abs(h.top)-Math.abs(f.top):g=Math.abs(h.top)+f.height,window.scrollBy(0,-1*g),this.api.blocks.move(e-1),this.api.toolbar.toggleBlockSettings(!0)}}Mc.isTune=!0;var e1=Object.defineProperty,n1=Object.getOwnPropertyDescriptor,o1=(l,e,n,r)=>{for(var s=r>1?void 0:r?n1(e,n):e,c=l.length-1,h;c>=0;c--)(h=l[c])&&(s=(r?h(e,n,s):h(s))||s);return r&&s&&e1(e,n,s),s};class Oc extends bt{constructor(){super(...arguments),this.stubTool="stub",this.toolsAvailable=new Jt,this.toolsUnavailable=new Jt}get available(){return this.toolsAvailable}get unavailable(){return this.toolsUnavailable}get inlineTools(){return this.available.inlineTools}get blockTools(){return this.available.blockTools}get blockTunes(){return this.available.blockTunes}get defaultTool(){return this.blockTools.get(this.config.defaultBlock)}get internal(){return this.available.internalTools}async prepare(){if(this.validateTools(),this.config.tools=Kr({},this.internalTools,this.config.tools),!Object.prototype.hasOwnProperty.call(this.config,"tools")||Object.keys(this.config.tools).length===0)throw Error("Can't start without tools");const e=this.prepareConfig();this.factory=new t1(e,this.config,this.Editor.API);const n=this.getListOfPrepareFunctions(e);if(n.length===0)return Promise.resolve();await Tb(n,r=>{this.toolPrepareMethodSuccess(r)},r=>{this.toolPrepareMethodFallback(r)}),this.prepareBlockTools()}getAllInlineToolsSanitizeConfig(){const e={};return Array.from(this.inlineTools.values()).forEach(n=>{Object.assign(e,n.sanitizeConfig)}),e}destroy(){Object.values(this.available).forEach(async e=>{Mt(e.reset)&&await e.reset()})}get internalTools(){return{bold:{class:cs,isInternal:!0},italic:{class:ds,isInternal:!0},link:{class:hs,isInternal:!0},paragraph:{class:ls,inlineToolbar:!0,isInternal:!0},stub:{class:Bc,isInternal:!0},moveUp:{class:Mc,isInternal:!0},delete:{class:Ac,isInternal:!0},moveDown:{class:Ic,isInternal:!0}}}toolPrepareMethodSuccess(e){const n=this.factory.get(e.toolName);if(n.isInline()){const r=["render","surround","checkState"].filter(s=>!n.create()[s]);if(r.length){yt(`Incorrect Inline Tool: ${n.name}. Some of required methods is not implemented %o`,"warn",r),this.toolsUnavailable.set(n.name,n);return}}this.toolsAvailable.set(n.name,n)}toolPrepareMethodFallback(e){this.toolsUnavailable.set(e.toolName,this.factory.get(e.toolName))}getListOfPrepareFunctions(e){const n=[];return Object.entries(e).forEach(([r,s])=>{n.push({function:Mt(s.class.prepare)?s.class.prepare:()=>{},data:{toolName:r,config:s.config}})}),n}prepareBlockTools(){Array.from(this.blockTools.values()).forEach(e=>{this.assignInlineToolsToBlockTool(e),this.assignBlockTunesToBlockTool(e)})}assignInlineToolsToBlockTool(e){if(this.config.inlineToolbar!==!1){if(e.enabledInlineTools===!0){e.inlineTools=new Jt(Array.isArray(this.config.inlineToolbar)?this.config.inlineToolbar.map(n=>[n,this.inlineTools.get(n)]):Array.from(this.inlineTools.entries()));return}Array.isArray(e.enabledInlineTools)&&(e.inlineTools=new Jt(e.enabledInlineTools.map(n=>[n,this.inlineTools.get(n)])))}}assignBlockTunesToBlockTool(e){if(e.enabledBlockTunes!==!1){if(Array.isArray(e.enabledBlockTunes)){const n=new Jt(e.enabledBlockTunes.map(r=>[r,this.blockTunes.get(r)]));e.tunes=new Jt([...n,...this.blockTunes.internalTools]);return}if(Array.isArray(this.config.tunes)){const n=new Jt(this.config.tunes.map(r=>[r,this.blockTunes.get(r)]));e.tunes=new Jt([...n,...this.blockTunes.internalTools]);return}e.tunes=this.blockTunes.internalTools}}validateTools(){for(const e in this.config.tools)if(Object.prototype.hasOwnProperty.call(this.config.tools,e)){if(e in this.internalTools)return;const n=this.config.tools[e];if(!Mt(n)&&!Mt(n.class))throw Error(`Tool «${e}» must be a constructor function or an object with function in the «class» property`)}}prepareConfig(){const e={};for(const n in this.config.tools)jt(this.config.tools[n])?e[n]=this.config.tools[n]:e[n]={class:this.config.tools[n]};return e}}o1([jn],Oc.prototype,"getAllInlineToolsSanitizeConfig",1);const i1=`:root{--selectionColor: #e1f2ff;--inlineSelectionColor: #d4ecff;--bg-light: #eff2f5;--grayText: #707684;--color-dark: #1D202B;--color-active-icon: #388AE5;--color-gray-border: rgba(201, 201, 204, .48);--content-width: 650px;--narrow-mode-right-padding: 50px;--toolbox-buttons-size: 26px;--toolbox-buttons-size--mobile: 36px;--icon-size: 20px;--icon-size--mobile: 28px;--block-padding-vertical: .4em;--color-line-gray: #EFF0F1 }.codex-editor{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.codex-editor .hide{display:none}.codex-editor__redactor [contenteditable]:empty:after{content:"\\feff"}@media (min-width: 651px){.codex-editor--narrow .codex-editor__redactor{margin-right:50px}}@media (min-width: 651px){.codex-editor--narrow.codex-editor--rtl .codex-editor__redactor{margin-left:50px;margin-right:0}}@media (min-width: 651px){.codex-editor--narrow .ce-toolbar__actions{right:-5px}}.codex-editor-copyable{position:absolute;height:1px;width:1px;top:-400%;opacity:.001}.codex-editor-overlay{position:fixed;top:0px;left:0px;right:0px;bottom:0px;z-index:999;pointer-events:none;overflow:hidden}.codex-editor-overlay__container{position:relative;pointer-events:auto;z-index:0}.codex-editor-overlay__rectangle{position:absolute;pointer-events:none;background-color:#2eaadc33;border:1px solid transparent}.codex-editor svg{max-height:100%}.codex-editor path{stroke:currentColor}.codex-editor ::-moz-selection{background-color:#d4ecff}.codex-editor ::selection{background-color:#d4ecff}.codex-editor--toolbox-opened [contentEditable=true][data-placeholder]:focus:before{opacity:0!important}.ce-scroll-locked{overflow:hidden}.ce-scroll-locked--hard{overflow:hidden;top:calc(-1 * var(--window-scroll-offset));position:fixed;width:100%}.ce-toolbar{position:absolute;left:0;right:0;top:0;-webkit-transition:opacity .1s ease;transition:opacity .1s ease;will-change:opacity,top;display:none}.ce-toolbar--opened{display:block}.ce-toolbar__content{max-width:650px;margin:0 auto;position:relative}.ce-toolbar__plus{color:#1d202b;cursor:pointer;width:26px;height:26px;border-radius:7px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-ms-flex-negative:0;flex-shrink:0}@media (max-width: 650px){.ce-toolbar__plus{width:36px;height:36px}}@media (hover: hover){.ce-toolbar__plus:hover{background-color:#eff2f5}}.ce-toolbar__plus--active{background-color:#eff2f5;-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-toolbar__plus-shortcut{opacity:.6;word-spacing:-2px;margin-top:5px}@media (max-width: 650px){.ce-toolbar__plus{position:absolute;background-color:#fff;border:1px solid #E8E8EB;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;z-index:2;position:static}.ce-toolbar__plus--left-oriented:before{left:15px;margin-left:0}.ce-toolbar__plus--right-oriented:before{left:auto;right:15px;margin-left:0}}.ce-toolbar__actions{position:absolute;right:100%;opacity:0;display:-webkit-box;display:-ms-flexbox;display:flex;padding-right:5px}.ce-toolbar__actions--opened{opacity:1}@media (max-width: 650px){.ce-toolbar__actions{right:auto}}.ce-toolbar__settings-btn{color:#1d202b;width:26px;height:26px;border-radius:7px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;margin-left:3px;cursor:pointer;user-select:none}@media (max-width: 650px){.ce-toolbar__settings-btn{width:36px;height:36px}}@media (hover: hover){.ce-toolbar__settings-btn:hover{background-color:#eff2f5}}.ce-toolbar__settings-btn--active{background-color:#eff2f5;-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@media (min-width: 651px){.ce-toolbar__settings-btn{width:24px}}.ce-toolbar__settings-btn--hidden{display:none}@media (max-width: 650px){.ce-toolbar__settings-btn{position:absolute;background-color:#fff;border:1px solid #E8E8EB;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;z-index:2;position:static}.ce-toolbar__settings-btn--left-oriented:before{left:15px;margin-left:0}.ce-toolbar__settings-btn--right-oriented:before{left:auto;right:15px;margin-left:0}}.ce-toolbar__plus svg,.ce-toolbar__settings-btn svg{width:24px;height:24px}@media (min-width: 651px){.codex-editor--narrow .ce-toolbar__plus{left:5px}}@media (min-width: 651px){.codex-editor--narrow .ce-toolbox .ce-popover{right:0;left:auto;left:initial}}.ce-inline-toolbar{--y-offset: 8px;position:absolute;background-color:#fff;border:1px solid #E8E8EB;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;z-index:2;opacity:0;visibility:hidden;-webkit-transition:opacity .25s ease;transition:opacity .25s ease;will-change:opacity,left,top;top:0;left:0;z-index:3}.ce-inline-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-inline-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}.ce-inline-toolbar--showed{opacity:1;visibility:visible}.ce-inline-toolbar [hidden]{display:none!important}.ce-inline-toolbar__toggler-and-button-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;padding:0 6px}.ce-inline-toolbar__buttons{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-inline-toolbar__dropdown{display:-webkit-box;display:-ms-flexbox;display:flex;padding:6px;margin:0 6px 0 -6px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;border-right:1px solid rgba(201,201,204,.48);-webkit-box-sizing:border-box;box-sizing:border-box}@media (hover: hover){.ce-inline-toolbar__dropdown:hover{background:#eff2f5}}.ce-inline-toolbar__dropdown--hidden{display:none}.ce-inline-toolbar__dropdown-content,.ce-inline-toolbar__dropdown-arrow{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-inline-toolbar__dropdown-content svg,.ce-inline-toolbar__dropdown-arrow svg{width:20px;height:20px}.ce-inline-toolbar__shortcut{opacity:.6;word-spacing:-3px;margin-top:3px}.ce-inline-tool{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:6px 1px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:inherit;margin:0;border-radius:0;line-height:normal}.ce-inline-tool svg{width:20px;height:20px}@media (max-width: 650px){.ce-inline-tool svg{width:28px;height:28px}}@media (hover: hover){.ce-inline-tool:hover{background-color:#eff2f5}}.ce-inline-tool--active{color:#388ae5}.ce-inline-tool--focused{background:rgba(34,186,255,.08)!important}.ce-inline-tool--focused{-webkit-box-shadow:inset 0 0 0px 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px #07a1e314}.ce-inline-tool--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-inline-tool--link .icon--unlink,.ce-inline-tool--unlink .icon--link{display:none}.ce-inline-tool--unlink .icon--unlink{display:inline-block;margin-bottom:-1px}.ce-inline-tool-input{outline:none;border:0;border-radius:0 0 4px 4px;margin:0;font-size:13px;padding:10px;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:none;font-weight:500;border-top:1px solid rgba(201,201,204,.48);-webkit-appearance:none;font-family:inherit}@media (max-width: 650px){.ce-inline-tool-input{font-size:15px;font-weight:500}}.ce-inline-tool-input::-webkit-input-placeholder{color:#707684}.ce-inline-tool-input::-moz-placeholder{color:#707684}.ce-inline-tool-input:-ms-input-placeholder{color:#707684}.ce-inline-tool-input::-ms-input-placeholder{color:#707684}.ce-inline-tool-input::placeholder{color:#707684}.ce-inline-tool-input--showed{display:block}.ce-conversion-toolbar{position:absolute;background-color:#fff;border:1px solid #E8E8EB;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;z-index:2;opacity:0;visibility:hidden;will-change:transform,opacity;-webkit-transition:opacity .1s ease,-webkit-transform .1s ease;transition:opacity .1s ease,-webkit-transform .1s ease;transition:transform .1s ease,opacity .1s ease;transition:transform .1s ease,opacity .1s ease,-webkit-transform .1s ease;-webkit-transform:translateY(-8px);transform:translateY(-8px);left:-1px;width:190px;margin-top:5px;-webkit-box-sizing:content-box;box-sizing:content-box}.ce-conversion-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-conversion-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}.ce-conversion-toolbar--showed{opacity:1;visibility:visible;-webkit-transform:none;transform:none}.ce-conversion-toolbar [hidden]{display:none!important}.ce-conversion-toolbar__buttons{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-conversion-toolbar__label{color:#707684;font-size:11px;font-weight:500;letter-spacing:.33px;padding:10px 10px 5px;text-transform:uppercase}.ce-conversion-tool{display:-webkit-box;display:-ms-flexbox;display:flex;padding:5px 10px;font-size:14px;line-height:20px;font-weight:500;cursor:pointer;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ce-conversion-tool--hidden{display:none}.ce-conversion-tool--focused{background:rgba(34,186,255,.08)!important}.ce-conversion-tool--focused{-webkit-box-shadow:inset 0 0 0px 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px #07a1e314}.ce-conversion-tool--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-conversion-tool:hover{background:#eff2f5}.ce-conversion-tool__icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:26px;height:26px;-webkit-box-shadow:0 0 0 1px rgba(201,201,204,.48);box-shadow:0 0 0 1px #c9c9cc7a;border-radius:5px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;background:#fff;-webkit-box-sizing:content-box;box-sizing:content-box;-ms-flex-negative:0;flex-shrink:0;margin-right:10px}.ce-conversion-tool__icon svg{width:20px;height:20px}@media (max-width: 650px){.ce-conversion-tool__icon{width:36px;height:36px;border-radius:8px}.ce-conversion-tool__icon svg{width:28px;height:28px}}.ce-conversion-tool--last{margin-right:0!important}.ce-conversion-tool--active{color:#388ae5!important}.ce-conversion-tool--active{-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-conversion-tool__secondary-label{color:#707684;font-size:12px;margin-left:auto;white-space:nowrap;letter-spacing:-.1em;padding-right:5px;margin-bottom:-2px;opacity:.6}@media (max-width: 650px){.ce-conversion-tool__secondary-label{display:none}}.ce-settings__button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:6px 1px;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:inherit;margin:0;line-height:32px}.ce-settings__button svg{width:20px;height:20px}@media (max-width: 650px){.ce-settings__button svg{width:28px;height:28px}}@media (hover: hover){.ce-settings__button:hover{background-color:#eff2f5}}.ce-settings__button--active{color:#388ae5}.ce-settings__button--focused{background:rgba(34,186,255,.08)!important}.ce-settings__button--focused{-webkit-box-shadow:inset 0 0 0px 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px #07a1e314}.ce-settings__button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-settings__button:not(:nth-child(3n+3)){margin-right:3px}.ce-settings__button:nth-child(n+4){margin-top:3px}.ce-settings__button--disabled{cursor:not-allowed!important}.ce-settings__button--disabled{opacity:.3}.ce-settings__button--selected{color:#388ae5}@media (min-width: 651px){.codex-editor--narrow .ce-settings .ce-popover{right:0;left:auto;left:initial}}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}.ce-block{-webkit-animation:fade-in .3s ease;animation:fade-in .3s ease;-webkit-animation-fill-mode:none;animation-fill-mode:none;-webkit-animation-fill-mode:initial;animation-fill-mode:initial}.ce-block:first-of-type{margin-top:0}.ce-block--selected .ce-block__content{background:#e1f2ff}.ce-block--selected .ce-block__content [contenteditable]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce-block--selected .ce-block__content img,.ce-block--selected .ce-block__content .ce-stub{opacity:.55}.ce-block--stretched .ce-block__content{max-width:none}.ce-block__content{position:relative;max-width:650px;margin:0 auto;-webkit-transition:background-color .15s ease;transition:background-color .15s ease}.ce-block--drop-target .ce-block__content:before{content:"";position:absolute;top:100%;left:-20px;margin-top:-1px;height:8px;width:8px;border:solid #388AE5;border-width:1px 1px 0 0;-webkit-transform-origin:right;transform-origin:right;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ce-block--drop-target .ce-block__content:after{content:"";position:absolute;top:100%;height:1px;width:100%;color:#388ae5;background:repeating-linear-gradient(90deg,#388AE5,#388AE5 1px,#fff 1px,#fff 6px)}.ce-block a{cursor:pointer;-webkit-text-decoration:underline;text-decoration:underline}.ce-block b{font-weight:700}.ce-block i{font-style:italic}@-webkit-keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@-webkit-keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@-webkit-keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}@keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scale3d(1,1,1);transform:scaleZ(1)}}.cdx-block{padding:.4em 0}.cdx-block::-webkit-input-placeholder{line-height:normal!important}.cdx-input{border:1px solid rgba(201,201,204,.48);-webkit-box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);box-shadow:inset 0 1px 2px #232c480f;border-radius:3px;padding:10px 12px;outline:none;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.cdx-input[data-placeholder]:before{position:static!important}.cdx-input[data-placeholder]:before{display:inline-block;width:0;white-space:nowrap;pointer-events:none}.cdx-settings-button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:6px 1px;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:inherit;margin:0;min-width:26px;min-height:26px}.cdx-settings-button svg{width:20px;height:20px}@media (max-width: 650px){.cdx-settings-button svg{width:28px;height:28px}}@media (hover: hover){.cdx-settings-button:hover{background-color:#eff2f5}}.cdx-settings-button--focused{background:rgba(34,186,255,.08)!important}.cdx-settings-button--focused{-webkit-box-shadow:inset 0 0 0px 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px #07a1e314}.cdx-settings-button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.cdx-settings-button--active{color:#388ae5}.cdx-settings-button svg{width:auto;height:auto}@media (max-width: 650px){.cdx-settings-button{width:36px;height:36px;border-radius:8px}}.cdx-loader{position:relative;border:1px solid rgba(201,201,204,.48)}.cdx-loader:before{content:"";position:absolute;left:50%;top:50%;width:18px;height:18px;margin:-11px 0 0 -11px;border:2px solid rgba(201,201,204,.48);border-left-color:#388ae5;border-radius:50%;-webkit-animation:cdxRotation 1.2s infinite linear;animation:cdxRotation 1.2s infinite linear}@-webkit-keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.cdx-button{padding:13px;border-radius:3px;border:1px solid rgba(201,201,204,.48);font-size:14.9px;background:#fff;-webkit-box-shadow:0 2px 2px 0 rgba(18,30,57,.04);box-shadow:0 2px 2px #121e390a;color:#707684;text-align:center;cursor:pointer}@media (hover: hover){.cdx-button:hover{background:#FBFCFE;-webkit-box-shadow:0 1px 3px 0 rgba(18,30,57,.08);box-shadow:0 1px 3px #121e3914}}.cdx-button svg{height:20px;margin-right:.2em;margin-top:-2px}.ce-stub{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:12px 18px;margin:10px 0;border-radius:10px;background:#eff2f5;border:1px solid #EFF0F1;color:#707684;font-size:14px}.ce-stub svg{width:20px;height:20px}.ce-stub__info{margin-left:14px}.ce-stub__title{font-weight:500;text-transform:capitalize}.codex-editor.codex-editor--rtl{direction:rtl}.codex-editor.codex-editor--rtl .cdx-list{padding-left:0;padding-right:40px}.codex-editor.codex-editor--rtl .ce-toolbar__plus{right:-26px;left:auto}.codex-editor.codex-editor--rtl .ce-toolbar__actions{right:auto;left:-26px}@media (max-width: 650px){.codex-editor.codex-editor--rtl .ce-toolbar__actions{margin-left:0;margin-right:auto;padding-right:0;padding-left:10px}}.codex-editor.codex-editor--rtl .ce-settings{left:5px;right:auto}.codex-editor.codex-editor--rtl .ce-settings:before{right:auto;left:25px}.codex-editor.codex-editor--rtl .ce-settings__button:not(:nth-child(3n+3)){margin-left:3px;margin-right:0}.codex-editor.codex-editor--rtl .ce-conversion-tool__icon{margin-right:0;margin-left:10px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown{border-right:0px solid transparent;border-left:1px solid rgba(201,201,204,.48);margin:0 -6px 0 6px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown .icon--toggler-down{margin-left:0;margin-right:4px}@media (min-width: 651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__plus{left:0px;right:5px}}@media (min-width: 651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__actions{left:-5px}}.cdx-search-field{--icon-margin-right: 10px;background:rgba(232,232,235,.49);border:1px solid rgba(226,226,229,.2);border-radius:6px;padding:2px;display:grid;grid-template-columns:auto auto 1fr;grid-template-rows:auto}.cdx-search-field__icon{width:26px;height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:var(--icon-margin-right)}.cdx-search-field__icon svg{width:20px;height:20px;color:#707684}.cdx-search-field__input{font-size:14px;outline:none;font-weight:500;font-family:inherit;border:0;background:transparent;margin:0;padding:0;line-height:22px;min-width:calc(100% - 26px - var(--icon-margin-right))}.cdx-search-field__input::-webkit-input-placeholder{color:#707684;font-weight:500}.cdx-search-field__input::-moz-placeholder{color:#707684;font-weight:500}.cdx-search-field__input:-ms-input-placeholder{color:#707684;font-weight:500}.cdx-search-field__input::-ms-input-placeholder{color:#707684;font-weight:500}.cdx-search-field__input::placeholder{color:#707684;font-weight:500}.ce-popover{--border-radius: 6px;--width: 200px;--max-height: 270px;--padding: 6px;--offset-from-target: 8px;--color-border: #e8e8eb;--color-shadow: rgba(13,20,33,.13);--color-background: white;--color-text-primary: black;--color-text-secondary: #707684;--color-border-icon: rgba(201, 201, 204, .48);--color-border-icon-disabled: #EFF0F1;--color-text-icon-active: #388AE5;--color-background-icon-active: rgba(56, 138, 229, .1);--color-background-item-focus: rgba(34, 186, 255, .08);--color-shadow-item-focus: rgba(7, 161, 227, .08);--color-background-item-hover: #eff2f5;--color-background-item-confirm: #E24A4A;--color-background-item-confirm-hover: #CE4343;min-width:var(--width);width:var(--width);max-height:var(--max-height);border-radius:var(--border-radius);overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 3px 15px -3px var(--color-shadow);box-shadow:0 3px 15px -3px var(--color-shadow);position:absolute;left:0;top:calc(100% + var(--offset-from-target));background:var(--color-background);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;z-index:4;opacity:0;max-height:0;pointer-events:none;padding:0;border:none}.ce-popover--opened{opacity:1;padding:var(--padding);max-height:var(--max-height);pointer-events:auto;-webkit-animation:panelShowing .1s ease;animation:panelShowing .1s ease;border:1px solid var(--color-border)}@media (max-width: 650px){.ce-popover--opened{-webkit-animation:panelShowingMobile .25s ease;animation:panelShowingMobile .25s ease}}.ce-popover__items{overflow-y:auto;-ms-scroll-chaining:none;overscroll-behavior:contain}@media (max-width: 650px){.ce-popover__overlay{position:fixed;top:0;bottom:0;left:0;right:0;background:#1D202B;z-index:3;opacity:.5;-webkit-transition:opacity .12s ease-in;transition:opacity .12s ease-in;will-change:opacity;visibility:visible}}.ce-popover__overlay--hidden{display:none}.ce-popover--open-top{top:calc(-1 * (var(--offset-from-target) + var(--popover-height)))}@media (max-width: 650px){.ce-popover{--offset: 5px;position:fixed;max-width:none;min-width:calc(100% - var(--offset) * 2);left:var(--offset);right:var(--offset);bottom:calc(var(--offset) + env(safe-area-inset-bottom));top:auto;border-radius:10px}.ce-popover .ce-popover__search{display:none}}.ce-popover__search,.ce-popover__custom-content:not(:empty){margin-bottom:5px}.ce-popover__nothing-found-message{color:#707684;display:none;cursor:default;padding:3px;font-size:14px;line-height:20px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ce-popover__nothing-found-message--displayed{display:block}.ce-popover__custom-content:not(:empty){padding:4px}@media (min-width: 651px){.ce-popover__custom-content:not(:empty){padding:0}}.ce-popover__custom-content--hidden{display:none}.ce-popover-item{--border-radius: 6px;--icon-size: 20px;--icon-size-mobile: 28px;border-radius:var(--border-radius);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:3px;color:var(--color-text-primary);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media (max-width: 650px){.ce-popover-item{padding:4px}}.ce-popover-item:not(:last-of-type){margin-bottom:1px}.ce-popover-item__icon{border-radius:5px;width:26px;height:26px;-webkit-box-shadow:0 0 0 1px var(--color-border-icon);box-shadow:0 0 0 1px var(--color-border-icon);background:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:10px}.ce-popover-item__icon svg{width:20px;height:20px}@media (max-width: 650px){.ce-popover-item__icon{width:36px;height:36px;border-radius:8px}.ce-popover-item__icon svg{width:var(--icon-size-mobile);height:var(--icon-size-mobile)}}.ce-popover-item__title{font-size:14px;line-height:20px;font-weight:500;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}@media (max-width: 650px){.ce-popover-item__title{font-size:16px}}.ce-popover-item__secondary-title{color:var(--color-text-secondary);font-size:12px;margin-left:auto;white-space:nowrap;letter-spacing:-.1em;padding-right:5px;margin-bottom:-2px;opacity:.6}@media (max-width: 650px){.ce-popover-item__secondary-title{display:none}}.ce-popover-item--active{background:var(--color-background-icon-active);color:var(--color-text-icon-active)}.ce-popover-item--active .ce-popover-item__icon{-webkit-box-shadow:none;box-shadow:none}.ce-popover-item--disabled{color:var(--color-text-secondary);cursor:default;pointer-events:none}.ce-popover-item--disabled .ce-popover-item__icon{-webkit-box-shadow:0 0 0 1px var(--color-border-icon-disabled);box-shadow:0 0 0 1px var(--color-border-icon-disabled)}.ce-popover-item--focused:not(.ce-popover-item--no-focus){background:var(--color-background-item-focus)!important}.ce-popover-item--focused:not(.ce-popover-item--no-focus){-webkit-box-shadow:inset 0 0 0px 1px var(--color-shadow-item-focus);box-shadow:inset 0 0 0 1px var(--color-shadow-item-focus)}.ce-popover-item--hidden{display:none}@media (hover: hover){.ce-popover-item:hover{cursor:pointer}.ce-popover-item:hover:not(.ce-popover-item--no-hover){background-color:var(--color-background-item-hover)}.ce-popover-item:hover .ce-popover-item__icon{-webkit-box-shadow:none;box-shadow:none}}.ce-popover-item--confirmation{background:var(--color-background-item-confirm)}.ce-popover-item--confirmation .ce-popover-item__icon{color:var(--color-background-item-confirm)}.ce-popover-item--confirmation .ce-popover-item__title{color:#fff}@media (hover: hover){.ce-popover-item--confirmation:not(.ce-popover-item--no-hover):hover{background:var(--color-background-item-confirm-hover)}}.ce-popover-item--confirmation:not(.ce-popover-item--no-focus).ce-popover-item--focused{background:var(--color-background-item-confirm-hover)!important}.ce-popover-item--confirmation .ce-popover-item__icon,.ce-popover-item--active .ce-popover-item__icon,.ce-popover-item--focused .ce-popover-item__icon{-webkit-box-shadow:none;box-shadow:none}@-webkit-keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes panelShowingMobile{0%{opacity:0;-webkit-transform:translateY(14px) scale(.98);transform:translateY(14px) scale(.98)}70%{opacity:1;-webkit-transform:translateY(-4px);transform:translateY(-4px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes panelShowingMobile{0%{opacity:0;-webkit-transform:translateY(14px) scale(.98);transform:translateY(14px) scale(.98)}70%{opacity:1;-webkit-transform:translateY(-4px);transform:translateY(-4px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}.wobble{-webkit-animation-name:wobble;animation-name:wobble;-webkit-animation-duration:.4s;animation-duration:.4s}@-webkit-keyframes wobble{0%{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-9%,0,0);transform:translate3d(-9%,0,0)}30%{-webkit-transform:translate3d(9%,0,0);transform:translate3d(9%,0,0)}45%{-webkit-transform:translate3d(-4%,0,0);transform:translate3d(-4%,0,0)}60%{-webkit-transform:translate3d(4%,0,0);transform:translate3d(4%,0,0)}75%{-webkit-transform:translate3d(-1%,0,0);transform:translate3d(-1%,0,0)}to{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}}@keyframes wobble{0%{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-9%,0,0);transform:translate3d(-9%,0,0)}30%{-webkit-transform:translate3d(9%,0,0);transform:translate3d(9%,0,0)}45%{-webkit-transform:translate3d(-4%,0,0);transform:translate3d(-4%,0,0)}60%{-webkit-transform:translate3d(4%,0,0);transform:translate3d(4%,0,0)}75%{-webkit-transform:translate3d(-1%,0,0);transform:translate3d(-1%,0,0)}to{-webkit-transform:translate3d(0,0,0);transform:translateZ(0)}}
`;class r1 extends bt{constructor(){super(...arguments),this.isMobile=!1,this.contentRectCache=void 0,this.resizeDebouncer=Kl(()=>{this.windowResize()},200)}get CSS(){return{editorWrapper:"codex-editor",editorWrapperNarrow:"codex-editor--narrow",editorZone:"codex-editor__redactor",editorZoneHidden:"codex-editor__redactor--hidden",editorEmpty:"codex-editor--empty",editorRtlFix:"codex-editor--rtl"}}get contentRect(){if(this.contentRectCache)return this.contentRectCache;const e=this.nodes.wrapper.querySelector(`.${Ve.CSS.content}`);return e?(this.contentRectCache=e.getBoundingClientRect(),this.contentRectCache):{width:650,left:0,right:0}}async prepare(){this.checkIsMobile(),this.make(),this.loadStyles()}toggleReadOnly(e){e?this.disableModuleBindings():window.requestIdleCallback(()=>{this.enableModuleBindings()},{timeout:2e3})}checkEmptiness(){const{BlockManager:e}=this.Editor;this.nodes.wrapper.classList.toggle(this.CSS.editorEmpty,e.isEditorEmpty)}get someToolbarOpened(){const{Toolbar:e,BlockSettings:n,InlineToolbar:r,ConversionToolbar:s}=this.Editor;return n.opened||r.opened||s.opened||e.toolbox.opened}get someFlipperButtonFocused(){return this.Editor.Toolbar.toolbox.hasFocus()?!0:Object.entries(this.Editor).filter(([e,n])=>n.flipper instanceof Qe).some(([e,n])=>n.flipper.hasFocus())}destroy(){this.nodes.holder.innerHTML=""}closeAllToolbars(){const{Toolbar:e,BlockSettings:n,InlineToolbar:r,ConversionToolbar:s}=this.Editor;n.close(),r.close(),s.close(),e.toolbox.close()}checkIsMobile(){this.isMobile=window.innerWidth<dc}make(){this.nodes.holder=C.getHolder(this.config.holder),this.nodes.wrapper=C.make("div",[this.CSS.editorWrapper,...this.isRtl?[this.CSS.editorRtlFix]:[]]),this.nodes.redactor=C.make("div",this.CSS.editorZone),this.nodes.holder.offsetWidth<this.contentRect.width&&this.nodes.wrapper.classList.add(this.CSS.editorWrapperNarrow),this.nodes.redactor.style.paddingBottom=this.config.minHeight+"px",this.nodes.wrapper.appendChild(this.nodes.redactor),this.nodes.holder.appendChild(this.nodes.wrapper)}loadStyles(){const e="editor-js-styles";if(C.get(e))return;const n=C.make("style",null,{id:e,textContent:i1.toString()});this.config.style&&!Le(this.config.style)&&this.config.style.nonce&&n.setAttribute("nonce",this.config.style.nonce),C.prepend(document.head,n)}enableModuleBindings(){this.readOnlyMutableListeners.on(this.nodes.redactor,"click",n=>{this.redactorClicked(n)},!1),this.readOnlyMutableListeners.on(this.nodes.redactor,"mousedown",n=>{this.documentTouched(n)},{capture:!0,passive:!0}),this.readOnlyMutableListeners.on(this.nodes.redactor,"touchstart",n=>{this.documentTouched(n)},{capture:!0,passive:!0}),this.readOnlyMutableListeners.on(document,"keydown",n=>{this.documentKeydown(n)},!0),this.readOnlyMutableListeners.on(document,"mousedown",n=>{this.documentClicked(n)},!0);const e=Kl(()=>{this.selectionChanged()},180);this.readOnlyMutableListeners.on(document,"selectionchange",e,!0),this.readOnlyMutableListeners.on(window,"resize",()=>{this.resizeDebouncer()},{passive:!0}),this.watchBlockHoveredEvents()}watchBlockHoveredEvents(){let e;this.readOnlyMutableListeners.on(this.nodes.redactor,"mousemove",Yr(n=>{const r=n.target.closest(".ce-block");this.Editor.BlockSelection.anyBlockSelected||r&&e!==r&&(e=r,this.eventsDispatcher.emit(Cc,{block:this.Editor.BlockManager.getBlockByChildNode(r)}))},20),{passive:!0})}disableModuleBindings(){this.readOnlyMutableListeners.clearAll()}windowResize(){this.contentRectCache=null,this.checkIsMobile()}documentKeydown(e){switch(e.keyCode){case ot.ENTER:this.enterPressed(e);break;case ot.BACKSPACE:case ot.DELETE:this.backspacePressed(e);break;case ot.ESC:this.escapePressed(e);break;default:this.defaultBehaviour(e);break}}defaultBehaviour(e){const{currentBlock:n}=this.Editor.BlockManager,r=e.target.closest(`.${this.CSS.editorWrapper}`),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;if(n!==void 0&&r===null){this.Editor.BlockEvents.keydown(e);return}r||n&&s||(this.Editor.BlockManager.dropPointer(),this.Editor.Toolbar.close())}backspacePressed(e){const{BlockManager:n,BlockSelection:r,Caret:s}=this.Editor;if(r.anyBlockSelected&&!nt.isSelectionExists){const c=n.removeSelectedBlocks(),h=n.insertDefaultBlockAtIndex(c,!0);s.setToBlock(h,s.positions.START),r.clearSelection(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}}escapePressed(e){this.Editor.BlockSelection.clearSelection(e),this.Editor.Toolbar.toolbox.opened?(this.Editor.Toolbar.toolbox.close(),this.Editor.Caret.setToBlock(this.Editor.BlockManager.currentBlock,this.Editor.Caret.positions.END)):this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.ConversionToolbar.opened?this.Editor.ConversionToolbar.close():this.Editor.InlineToolbar.opened?this.Editor.InlineToolbar.close():this.Editor.Toolbar.close()}enterPressed(e){const{BlockManager:n,BlockSelection:r}=this.Editor,s=n.currentBlockIndex>=0;if(r.anyBlockSelected&&!nt.isSelectionExists){r.clearSelection(e),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();return}if(!this.someToolbarOpened&&s&&e.target.tagName==="BODY"){const c=this.Editor.BlockManager.insert();this.Editor.Caret.setToBlock(c),this.Editor.Toolbar.moveAndOpen(c)}this.Editor.BlockSelection.clearSelection(e)}documentClicked(e){var n,r;if(!e.isTrusted)return;const s=e.target;this.nodes.holder.contains(s)||nt.isAtEditor||(this.Editor.BlockManager.dropPointer(),this.Editor.Toolbar.close());const c=(n=this.Editor.BlockSettings.nodes.wrapper)==null?void 0:n.contains(s),h=(r=this.Editor.Toolbar.nodes.settingsToggler)==null?void 0:r.contains(s),f=c||h;if(this.Editor.BlockSettings.opened&&!f){this.Editor.BlockSettings.close();const g=this.Editor.BlockManager.getBlockByChildNode(s);this.Editor.Toolbar.moveAndOpen(g)}this.Editor.BlockSelection.clearSelection(e)}documentTouched(e){let n=e.target;if(n===this.nodes.redactor){const r=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,s=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;n=document.elementFromPoint(r,s)}try{this.Editor.BlockManager.setCurrentBlockByChildNode(n)}catch{this.Editor.RectangleSelection.isRectActivated()||this.Editor.Caret.setToTheLastBlock()}this.Editor.Toolbar.moveAndOpen()}redactorClicked(e){if(!nt.isCollapsed)return;const n=e.target,r=e.metaKey||e.ctrlKey;if(C.isAnchor(n)&&r){e.stopImmediatePropagation(),e.stopPropagation();const s=n.getAttribute("href"),c=Ib(s);Mb(c);return}this.processBottomZoneClick(e)}processBottomZoneClick(e){const n=this.Editor.BlockManager.getBlockByIndex(-1),r=C.offset(n.holder).bottom,s=e.pageY,{BlockSelection:c}=this.Editor;if(e.target instanceof Element&&e.target.isEqualNode(this.nodes.redactor)&&!c.anyBlockSelected&&r<s){e.stopImmediatePropagation(),e.stopPropagation();const{BlockManager:h,Caret:f,Toolbar:g}=this.Editor;(!h.lastBlock.tool.isDefault||!h.lastBlock.isEmpty)&&h.insertAtEnd(),f.setToTheLastBlock(),g.moveAndOpen(h.lastBlock)}}selectionChanged(){const{CrossBlockSelection:e,BlockSelection:n}=this.Editor,r=nt.anchorElement;if(e.isCrossBlockSelectionStarted&&n.anyBlockSelected&&nt.get().removeAllRanges(),!r){nt.range||this.Editor.InlineToolbar.close();return}const s=r.closest(`.${Ve.CSS.content}`)===null;if(s&&(this.Editor.InlineToolbar.containsNode(r)||this.Editor.InlineToolbar.close(),r.dataset.inlineToolbar!=="true"))return;this.Editor.BlockManager.currentBlock||this.Editor.BlockManager.setCurrentBlockByChildNode(r);const c=s!==!0;this.Editor.InlineToolbar.tryToShow(!0,c)}}const s1={BlocksAPI:Wb,CaretAPI:$b,EventsAPI:Yb,I18nAPI:es,API:Kb,InlineToolbarAPI:qb,ListenersAPI:Gb,NotifierAPI:Vb,ReadOnlyAPI:Jb,SanitizerAPI:rv,SaverAPI:sv,SelectionAPI:av,StylesAPI:lv,ToolbarAPI:cv,TooltipAPI:fv,UiAPI:gv,BlockSettings:Iv,ConversionToolbar:ke,Toolbar:Dv,InlineToolbar:Pv,BlockEvents:Hv,BlockManager:zv,BlockSelection:Wv,Caret:mi,CrossBlockSelection:$v,DragNDrop:Yv,ModificationsObserver:Kv,Paste:_c,ReadOnly:qv,RectangleSelection:ko,Renderer:Gv,Saver:jv,Tools:Oc,UI:r1};class a1{constructor(e){this.moduleInstances={},this.eventsDispatcher=new ki;let n,r;this.isReady=new Promise((s,c)=>{n=s,r=c}),Promise.resolve().then(async()=>{this.configuration=e,this.validate(),this.init(),await this.start(),await this.render();const{BlockManager:s,Caret:c,UI:h,ModificationsObserver:f}=this.moduleInstances;h.checkEmptiness(),f.enable(),this.configuration.autofocus&&c.setToBlock(s.blocks[0],c.positions.START),n()}).catch(s=>{yt(`Editor.js is not ready because of ${s}`,"error"),r(s)})}set configuration(e){var n,r;jt(e)?this.config={...e}:this.config={holder:e},qr(!!this.config.holderId,"config.holderId","config.holder"),this.config.holderId&&!this.config.holder&&(this.config.holder=this.config.holderId,this.config.holderId=null),this.config.holder==null&&(this.config.holder="editorjs"),this.config.logLevel||(this.config.logLevel=ac.VERBOSE),Eb(this.config.logLevel),qr(!!this.config.initialBlock,"config.initialBlock","config.defaultBlock"),this.config.defaultBlock=this.config.defaultBlock||this.config.initialBlock||"paragraph",this.config.minHeight=this.config.minHeight!==void 0?this.config.minHeight:300;const s={type:this.config.defaultBlock,data:{}};this.config.placeholder=this.config.placeholder||!1,this.config.sanitizer=this.config.sanitizer||{p:!0,b:!0,a:!0},this.config.hideToolbar=this.config.hideToolbar?this.config.hideToolbar:!1,this.config.tools=this.config.tools||{},this.config.i18n=this.config.i18n||{},this.config.data=this.config.data||{blocks:[]},this.config.onReady=this.config.onReady||(()=>{}),this.config.onChange=this.config.onChange||(()=>{}),this.config.inlineToolbar=this.config.inlineToolbar!==void 0?this.config.inlineToolbar:!0,(Le(this.config.data)||!this.config.data.blocks||this.config.data.blocks.length===0)&&(this.config.data={blocks:[s]}),this.config.readOnly=this.config.readOnly||!1,(n=this.config.i18n)!=null&&n.messages&&de.setDictionary(this.config.i18n.messages),this.config.i18n.direction=((r=this.config.i18n)==null?void 0:r.direction)||"ltr"}get configuration(){return this.config}validate(){const{holderId:e,holder:n}=this.config;if(e&&n)throw Error("«holderId» and «holder» param can't assign at the same time.");if(gn(n)&&!C.get(n))throw Error(`element with ID «${n}» is missing. Pass correct holder's ID.`);if(n&&jt(n)&&!C.isElement(n))throw Error("«holder» value must be an Element node")}init(){this.constructModules(),this.configureModules()}async start(){await["Tools","UI","BlockManager","Paste","BlockSelection","RectangleSelection","CrossBlockSelection","ReadOnly"].reduce((e,n)=>e.then(async()=>{try{await this.moduleInstances[n].prepare()}catch(r){if(r instanceof uc)throw new Error(r.message);yt(`Module ${n} was skipped because of %o`,"warn",r)}}),Promise.resolve())}render(){return this.moduleInstances.Renderer.render(this.config.data.blocks)}constructModules(){Object.entries(s1).forEach(([e,n])=>{try{this.moduleInstances[e]=new n({config:this.configuration,eventsDispatcher:this.eventsDispatcher})}catch(r){yt("[constructModules]",`Module ${e} skipped because`,"error",r)}})}configureModules(){for(const e in this.moduleInstances)Object.prototype.hasOwnProperty.call(this.moduleInstances,e)&&(this.moduleInstances[e].state=this.getModulesDiff(e))}getModulesDiff(e){const n={};for(const r in this.moduleInstances)r!==e&&(n[r]=this.moduleInstances[r]);return n}}/**
 * Editor.js
 *
 * @license Apache-2.0
 * @see Editor.js <https://editorjs.io>
 * @author CodeX Team <https://codex.so>
 */class l1{static get version(){return"2.29.0"}constructor(e){let n=()=>{};jt(e)&&Mt(e.onReady)&&(n=e.onReady);const r=new a1(e);this.isReady=r.isReady.then(()=>{this.exportAPI(r),n()})}exportAPI(e){const n=["configuration"],r=()=>{Object.values(e.moduleInstances).forEach(s=>{Mt(s.destroy)&&s.destroy(),s.listeners.removeAll()}),pv(),e=null;for(const s in this)Object.prototype.hasOwnProperty.call(this,s)&&delete this[s];Object.setPrototypeOf(this,null)};n.forEach(s=>{this[s]=e[s]}),this.destroy=r,Object.setPrototypeOf(this,e.moduleInstances.API.methods),delete this.exportAPI,Object.entries({blocks:{clear:"clear",render:"render"},caret:{focus:"focus"},events:{on:"on",off:"off",emit:"emit"},saver:{save:"save"}}).forEach(([s,c])=>{Object.entries(c).forEach(([h,f])=>{this[f]=e.moduleInstances.API.methods[s][h]})})}}(function(){try{if(typeof document<"u"){var l=document.createElement("style");l.appendChild(document.createTextNode(".ce-header{padding:.6em 0 3px;margin:0;line-height:1.25em;outline:none}.ce-header p,.ce-header div{padding:0!important;margin:0!important}.ce-header[contentEditable=true][data-placeholder]:before{position:absolute;content:attr(data-placeholder);color:#707684;font-weight:400;display:none;cursor:text}.ce-header[contentEditable=true][data-placeholder]:empty:before{display:block}.ce-header[contentEditable=true][data-placeholder]:empty:focus:before{display:none}")),document.head.appendChild(l)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const c1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M19 17V10.2135C19 10.1287 18.9011 10.0824 18.836 10.1367L16 12.5"/></svg>',d1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 11C16 10 19 9.5 19 12C19 13.9771 16.0684 13.9997 16.0012 16.8981C15.9999 16.9533 16.0448 17 16.1 17L19.3 17"/></svg>',h1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 11C16 10.5 16.8323 10 17.6 10C18.3677 10 19.5 10.311 19.5 11.5C19.5 12.5315 18.7474 12.9022 18.548 12.9823C18.5378 12.9864 18.5395 13.0047 18.5503 13.0063C18.8115 13.0456 20 13.3065 20 14.8C20 16 19.5 17 17.8 17C17.8 17 16 17 16 16.3"/></svg>',u1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M18 10L15.2834 14.8511C15.246 14.9178 15.294 15 15.3704 15C16.8489 15 18.7561 15 20.2 15M19 17C19 15.7187 19 14.8813 19 13.6"/></svg>',p1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16 15.9C16 15.9 16.3768 17 17.8 17C19.5 17 20 15.6199 20 14.7C20 12.7323 17.6745 12.0486 16.1635 12.9894C16.094 13.0327 16 12.9846 16 12.9027V10.1C16 10.0448 16.0448 10 16.1 10H19.8"/></svg>',f1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6 7L6 12M6 17L6 12M6 12L12 12M12 7V12M12 17L12 12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M19.5 10C16.5 10.5 16 13.3285 16 15M16 15V15C16 16.1046 16.8954 17 18 17H18.3246C19.3251 17 20.3191 16.3492 20.2522 15.3509C20.0612 12.4958 16 12.6611 16 15Z"/></svg>',g1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M9 7L9 12M9 17V12M9 12L15 12M15 7V12M15 17L15 12"/></svg>';/**
 * Header block for the Editor.js.
 *
 * @author CodeX (team@ifmo.su)
 * @copyright CodeX 2018
 * @license MIT
 * @version 2.0.0
 */let m1=class{constructor({data:e,config:n,api:r,readOnly:s}){this.api=r,this.readOnly=s,this._CSS={block:this.api.styles.block,wrapper:"ce-header"},this._settings=n,this._data=this.normalizeData(e),this._element=this.getTag()}normalizeData(e){const n={};return typeof e!="object"&&(e={}),n.text=e.text||"",n.level=parseInt(e.level)||this.defaultLevel.number,n}render(){return this._element}renderSettings(){return this.levels.map(e=>({icon:e.svg,label:this.api.i18n.t(`Heading ${e.number}`),onActivate:()=>this.setLevel(e.number),closeOnActivate:!0,isActive:this.currentLevel.number===e.number}))}setLevel(e){this.data={level:e,text:this.data.text}}merge(e){const n={text:this.data.text+e.text,level:this.data.level};this.data=n}validate(e){return e.text.trim()!==""}save(e){return{text:e.innerHTML,level:this.currentLevel.number}}static get conversionConfig(){return{export:"text",import:"text"}}static get sanitize(){return{level:!1,text:{}}}static get isReadOnlySupported(){return!0}get data(){return this._data.text=this._element.innerHTML,this._data.level=this.currentLevel.number,this._data}set data(e){if(this._data=this.normalizeData(e),e.level!==void 0&&this._element.parentNode){const n=this.getTag();n.innerHTML=this._element.innerHTML,this._element.parentNode.replaceChild(n,this._element),this._element=n}e.text!==void 0&&(this._element.innerHTML=this._data.text||"")}getTag(){const e=document.createElement(this.currentLevel.tag);return e.innerHTML=this._data.text||"",e.classList.add(this._CSS.wrapper),e.contentEditable=this.readOnly?"false":"true",e.dataset.placeholder=this.api.i18n.t(this._settings.placeholder||""),e}get currentLevel(){let e=this.levels.find(n=>n.number===this._data.level);return e||(e=this.defaultLevel),e}get defaultLevel(){if(this._settings.defaultLevel){const e=this.levels.find(n=>n.number===this._settings.defaultLevel);if(e)return e;console.warn("(ง'̀-'́)ง Heading Tool: the default level specified was not found in available levels")}return this.levels[1]}get levels(){const e=[{number:1,tag:"H1",svg:c1},{number:2,tag:"H2",svg:d1},{number:3,tag:"H3",svg:h1},{number:4,tag:"H4",svg:u1},{number:5,tag:"H5",svg:p1},{number:6,tag:"H6",svg:f1}];return this._settings.levels?e.filter(n=>this._settings.levels.includes(n.number)):e}onPaste(e){const n=e.detail.data;let r=this.defaultLevel.number;switch(n.tagName){case"H1":r=1;break;case"H2":r=2;break;case"H3":r=3;break;case"H4":r=4;break;case"H5":r=5;break;case"H6":r=6;break}this._settings.levels&&(r=this._settings.levels.reduce((s,c)=>Math.abs(c-r)<Math.abs(s-r)?c:s)),this.data={level:r,text:n.innerHTML}}static get pasteConfig(){return{tags:["H1","H2","H3","H4","H5","H6"]}}static get toolbox(){return{icon:g1,title:"Heading"}}};(function(){try{if(typeof document<"u"){var l=document.createElement("style");l.appendChild(document.createTextNode(".cdx-list{margin:0;padding-left:40px;outline:none}.cdx-list__item{padding:5.5px 0 5.5px 3px;line-height:1.6em}.cdx-list--unordered{list-style:disc}.cdx-list--ordered{list-style:decimal}.cdx-list-settings{display:flex}.cdx-list-settings .cdx-settings-button{width:50%}")),document.head.appendChild(l)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const Ql='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><line x1="9" x2="19" y1="7" y2="7" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="9" x2="19" y1="12" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="9" x2="19" y1="17" y2="17" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 17H4.99002"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 12H4.99002"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 7H4.99002"/></svg>',b1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><line x1="12" x2="19" y1="7" y2="7" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="12" x2="19" y1="12" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="12" x2="19" y1="17" y2="17" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.79999 14L7.79999 7.2135C7.79999 7.12872 7.7011 7.0824 7.63597 7.13668L4.79999 9.5"/></svg>';class v1{static get isReadOnlySupported(){return!0}static get enableLineBreaks(){return!0}static get toolbox(){return{icon:Ql,title:"List"}}constructor({data:e,config:n,api:r,readOnly:s}){this._elements={wrapper:null},this.api=r,this.readOnly=s,this.settings=[{name:"unordered",label:this.api.i18n.t("Unordered"),icon:Ql,default:n.defaultStyle==="unordered"||!1},{name:"ordered",label:this.api.i18n.t("Ordered"),icon:b1,default:n.defaultStyle==="ordered"||!0}],this._data={style:this.settings.find(c=>c.default===!0).name,items:[]},this.data=e}render(){return this._elements.wrapper=this.makeMainTag(this._data.style),this._data.items.length?this._data.items.forEach(e=>{this._elements.wrapper.appendChild(this._make("li",this.CSS.item,{innerHTML:e}))}):this._elements.wrapper.appendChild(this._make("li",this.CSS.item)),this.readOnly||this._elements.wrapper.addEventListener("keydown",e=>{const[n,r]=[13,8];switch(e.keyCode){case n:this.getOutofList(e);break;case r:this.backspace(e);break}},!1),this._elements.wrapper}save(){return this.data}static get conversionConfig(){return{export:e=>e.items.join(". "),import:e=>({items:[e],style:"unordered"})}}static get sanitize(){return{style:{},items:{br:!0}}}renderSettings(){return this.settings.map(e=>({...e,isActive:this._data.style===e.name,closeOnActivate:!0,onActivate:()=>this.toggleTune(e.name)}))}onPaste(e){const n=e.detail.data;this.data=this.pasteHandler(n)}static get pasteConfig(){return{tags:["OL","UL","LI"]}}makeMainTag(e){const n=e==="ordered"?this.CSS.wrapperOrdered:this.CSS.wrapperUnordered,r=e==="ordered"?"ol":"ul";return this._make(r,[this.CSS.baseBlock,this.CSS.wrapper,n],{contentEditable:!this.readOnly})}toggleTune(e){const n=this.makeMainTag(e);for(;this._elements.wrapper.hasChildNodes();)n.appendChild(this._elements.wrapper.firstChild);this._elements.wrapper.replaceWith(n),this._elements.wrapper=n,this._data.style=e}get CSS(){return{baseBlock:this.api.styles.block,wrapper:"cdx-list",wrapperOrdered:"cdx-list--ordered",wrapperUnordered:"cdx-list--unordered",item:"cdx-list__item"}}set data(e){e||(e={}),this._data.style=e.style||this.settings.find(r=>r.default===!0).name,this._data.items=e.items||[];const n=this._elements.wrapper;n&&n.parentNode.replaceChild(this.render(),n)}get data(){this._data.items=[];const e=this._elements.wrapper.querySelectorAll(`.${this.CSS.item}`);for(let n=0;n<e.length;n++)e[n].innerHTML.replace("<br>"," ").trim()&&this._data.items.push(e[n].innerHTML);return this._data}_make(e,n=null,r={}){const s=document.createElement(e);Array.isArray(n)?s.classList.add(...n):n&&s.classList.add(n);for(const c in r)s[c]=r[c];return s}get currentItem(){let e=window.getSelection().anchorNode;return e.nodeType!==Node.ELEMENT_NODE&&(e=e.parentNode),e.closest(`.${this.CSS.item}`)}getOutofList(e){const n=this._elements.wrapper.querySelectorAll("."+this.CSS.item);if(n.length<2)return;const r=n[n.length-1],s=this.currentItem;s===r&&!r.textContent.trim().length&&(s.parentElement.removeChild(s),this.api.blocks.insert(),this.api.caret.setToBlock(this.api.blocks.getCurrentBlockIndex()),e.preventDefault(),e.stopPropagation())}backspace(e){const n=this._elements.wrapper.querySelectorAll("."+this.CSS.item),r=n[0];r&&n.length<2&&!r.innerHTML.replace("<br>"," ").trim()&&e.preventDefault()}selectItem(e){e.preventDefault();const n=window.getSelection(),r=n.anchorNode.parentNode,s=r.closest("."+this.CSS.item),c=new Range;c.selectNodeContents(s),n.removeAllRanges(),n.addRange(c)}pasteHandler(e){const{tagName:n}=e;let r;switch(n){case"OL":r="ordered";break;case"UL":case"LI":r="unordered"}const s={style:r,items:[]};if(n==="LI")s.items=[e.innerHTML];else{const c=Array.from(e.querySelectorAll("LI"));s.items=c.map(h=>h.innerHTML).filter(h=>!!h.trim())}return s}}(function(){try{if(typeof document<"u"){var l=document.createElement("style");l.appendChild(document.createTextNode('.tc-wrap{--color-background:#f9f9fb;--color-text-secondary:#7b7e89;--color-border:#e8e8eb;--cell-size:34px;--toolbox-icon-size:18px;--toolbox-padding:6px;--toolbox-aiming-field-size:calc(var(--toolbox-icon-size) + var(--toolbox-padding)*2);border-left:0;position:relative;height:100%;width:100%;margin-top:var(--toolbox-icon-size);box-sizing:border-box;display:grid;grid-template-columns:calc(100% - var(--cell-size)) var(--cell-size)}.tc-wrap--readonly{grid-template-columns:100% var(--cell-size)}.tc-wrap svg{vertical-align:top}@media print{.tc-wrap{border-left-color:var(--color-border);border-left-style:solid;border-left-width:1px;grid-template-columns:100% var(--cell-size)}}@media print{.tc-wrap .tc-row:after{display:none}}.tc-table{position:relative;width:100%;height:100%;display:grid;font-size:14px;border-top:1px solid var(--color-border);line-height:1.4}.tc-table:after{width:calc(var(--cell-size));height:100%;left:calc(var(--cell-size)*-1);top:0}.tc-table:after,.tc-table:before{position:absolute;content:""}.tc-table:before{width:100%;height:var(--toolbox-aiming-field-size);top:calc(var(--toolbox-aiming-field-size)*-1);left:0}.tc-table--heading .tc-row:first-child{font-weight:600;border-bottom:2px solid var(--color-border)}.tc-table--heading .tc-row:first-child [contenteditable]:empty:before{content:attr(heading);color:var(--color-text-secondary)}.tc-table--heading .tc-row:first-child:after{bottom:-2px;border-bottom:2px solid var(--color-border)}.tc-add-column,.tc-add-row{display:flex;color:var(--color-text-secondary)}@media print{.tc-add{display:none}}.tc-add-column{padding:4px 0;justify-content:center;border-top:1px solid var(--color-border)}@media print{.tc-add-column{display:none}}.tc-add-row{height:var(--cell-size);align-items:center;padding-left:4px;position:relative}.tc-add-row:before{content:"";position:absolute;right:calc(var(--cell-size)*-1);width:var(--cell-size);height:100%}@media print{.tc-add-row{display:none}}.tc-add-column,.tc-add-row{transition:0s;cursor:pointer;will-change:background-color}.tc-add-column:hover,.tc-add-row:hover{transition:background-color .1s ease;background-color:var(--color-background)}.tc-add-row{margin-top:1px}.tc-add-row:hover:before{transition:.1s;background-color:var(--color-background)}.tc-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(10px,1fr));position:relative;border-bottom:1px solid var(--color-border)}.tc-row:after{content:"";pointer-events:none;position:absolute;width:var(--cell-size);height:100%;bottom:-1px;right:calc(var(--cell-size)*-1);border-bottom:1px solid var(--color-border)}.tc-row--selected{background:var(--color-background)}.tc-row--selected:after{background:var(--color-background)}.tc-cell{border-right:1px solid var(--color-border);padding:6px 12px;overflow:hidden;outline:none;line-break:normal}.tc-cell--selected{background:var(--color-background)}.tc-wrap--readonly .tc-row:after{display:none}.tc-toolbox{--toolbox-padding:6px;--popover-margin:30px;--toggler-click-zone-size:30px;--toggler-dots-color:#7b7e89;--toggler-dots-color-hovered:#1d202b;position:absolute;cursor:pointer;z-index:1;opacity:0;transition:opacity .1s;will-change:left,opacity}.tc-toolbox--column{top:calc(var(--toggler-click-zone-size)*-1);transform:translate(calc(var(--toggler-click-zone-size)*-1/2));will-change:left,opacity}.tc-toolbox--row{left:calc(var(--popover-margin)*-1);transform:translateY(calc(var(--toggler-click-zone-size)*-1/2));margin-top:-1px;will-change:top,opacity}.tc-toolbox--showed{opacity:1}.tc-toolbox .tc-popover{position:absolute;top:0;left:var(--popover-margin)}.tc-toolbox__toggler{display:flex;align-items:center;justify-content:center;width:var(--toggler-click-zone-size);height:var(--toggler-click-zone-size);color:var(--toggler-dots-color);opacity:0;transition:opacity .15s ease;will-change:opacity}.tc-toolbox__toggler:hover{color:var(--toggler-dots-color-hovered)}.tc-toolbox__toggler svg{fill:currentColor}.tc-wrap:hover .tc-toolbox__toggler{opacity:1}.tc-settings .cdx-settings-button{width:50%;margin:0}.tc-popover{--color-border:#eaeaea;--color-background:#fff;--color-background-hover:rgba(232,232,235,.49);--color-background-confirm:#e24a4a;--color-background-confirm-hover:#d54040;--color-text-confirm:#fff;background:var(--color-background);border:1px solid var(--color-border);box-shadow:0 3px 15px -3px #0d142121;border-radius:6px;padding:6px;display:none;will-change:opacity,transform}.tc-popover--opened{display:block;animation:menuShowing .1s cubic-bezier(.215,.61,.355,1) forwards}.tc-popover__item{display:flex;align-items:center;padding:2px 14px 2px 2px;border-radius:5px;cursor:pointer;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tc-popover__item:hover{background:var(--color-background-hover)}.tc-popover__item:not(:last-of-type){margin-bottom:2px}.tc-popover__item-icon{display:inline-flex;width:26px;height:26px;align-items:center;justify-content:center;background:var(--color-background);border-radius:5px;border:1px solid var(--color-border);margin-right:8px}.tc-popover__item-label{line-height:22px;font-size:14px;font-weight:500}.tc-popover__item--confirm{background:var(--color-background-confirm);color:var(--color-text-confirm)}.tc-popover__item--confirm:hover{background-color:var(--color-background-confirm-hover)}.tc-popover__item--confirm .tc-popover__item-icon{background:var(--color-background-confirm);border-color:#0000001a}.tc-popover__item--confirm .tc-popover__item-icon svg{transition:transform .2s ease-in;transform:rotate(90deg) scale(1.2)}.tc-popover__item--hidden{display:none}@keyframes menuShowing{0%{opacity:0;transform:translateY(-8px) scale(.9)}70%{opacity:1;transform:translateY(2px)}to{transform:translateY(0)}}')),document.head.appendChild(l)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();function we(l,e,n={}){const r=document.createElement(l);Array.isArray(e)?r.classList.add(...e):e&&r.classList.add(e);for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s]);return r}function tc(l){const e=l.getBoundingClientRect();return{y1:Math.floor(e.top+window.pageYOffset),x1:Math.floor(e.left+window.pageXOffset),x2:Math.floor(e.right+window.pageXOffset),y2:Math.floor(e.bottom+window.pageYOffset)}}function ec(l,e){const n=tc(l),r=tc(e);return{fromTopBorder:r.y1-n.y1,fromLeftBorder:r.x1-n.x1,fromRightBorder:n.x2-r.x2,fromBottomBorder:n.y2-r.y2}}function k1(l,e){const n=l.getBoundingClientRect(),{width:r,height:s,x:c,y:h}=n,{clientX:f,clientY:g}=e;return{width:r,height:s,x:f-c,y:g-h}}function nc(l,e){return e.parentNode.insertBefore(l,e)}function oc(l,e=!0){const n=document.createRange(),r=window.getSelection();n.selectNodeContents(l),n.collapse(e),r.removeAllRanges(),r.addRange(n)}class ce{constructor({items:e}){this.items=e,this.wrapper=void 0,this.itemEls=[]}static get CSS(){return{popover:"tc-popover",popoverOpened:"tc-popover--opened",item:"tc-popover__item",itemHidden:"tc-popover__item--hidden",itemConfirmState:"tc-popover__item--confirm",itemIcon:"tc-popover__item-icon",itemLabel:"tc-popover__item-label"}}render(){return this.wrapper=we("div",ce.CSS.popover),this.items.forEach((e,n)=>{const r=we("div",ce.CSS.item),s=we("div",ce.CSS.itemIcon,{innerHTML:e.icon}),c=we("div",ce.CSS.itemLabel,{textContent:e.label});r.dataset.index=n,r.appendChild(s),r.appendChild(c),this.wrapper.appendChild(r),this.itemEls.push(r)}),this.wrapper.addEventListener("click",e=>{this.popoverClicked(e)}),this.wrapper}popoverClicked(e){const n=e.target.closest(`.${ce.CSS.item}`);if(!n)return;const r=n.dataset.index,s=this.items[r];if(s.confirmationRequired&&!this.hasConfirmationState(n)){this.setConfirmationState(n);return}s.onClick()}setConfirmationState(e){e.classList.add(ce.CSS.itemConfirmState)}clearConfirmationState(e){e.classList.remove(ce.CSS.itemConfirmState)}hasConfirmationState(e){return e.classList.contains(ce.CSS.itemConfirmState)}get opened(){return this.wrapper.classList.contains(ce.CSS.popoverOpened)}open(){this.items.forEach((e,n)=>{typeof e.hideIf=="function"&&this.itemEls[n].classList.toggle(ce.CSS.itemHidden,e.hideIf())}),this.wrapper.classList.add(ce.CSS.popoverOpened)}close(){this.wrapper.classList.remove(ce.CSS.popoverOpened),this.itemEls.forEach(e=>{this.clearConfirmationState(e)})}}const ic='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 8L12 12M12 12L16 16M12 12L16 8M12 12L8 16"/></svg>',w1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.8833 9.16666L18.2167 12.5M18.2167 12.5L14.8833 15.8333M18.2167 12.5H10.05C9.16594 12.5 8.31809 12.1488 7.69297 11.5237C7.06785 10.8986 6.71666 10.0507 6.71666 9.16666"/></svg>',x1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.9167 14.9167L11.5833 18.25M11.5833 18.25L8.25 14.9167M11.5833 18.25L11.5833 10.0833C11.5833 9.19928 11.9345 8.35143 12.5596 7.72631C13.1848 7.10119 14.0326 6.75 14.9167 6.75"/></svg>',y1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.13333 14.9167L12.4667 18.25M12.4667 18.25L15.8 14.9167M12.4667 18.25L12.4667 10.0833C12.4667 9.19928 12.1155 8.35143 11.4904 7.72631C10.8652 7.10119 10.0174 6.75 9.13333 6.75"/></svg>',C1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.8833 15.8333L18.2167 12.5M18.2167 12.5L14.8833 9.16667M18.2167 12.5L10.05 12.5C9.16595 12.5 8.31811 12.8512 7.69299 13.4763C7.06787 14.1014 6.71667 14.9493 6.71667 15.8333"/></svg>',E1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.41 9.66H9.4"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 9.66H14.59"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M9.31 14.36H9.3"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2.6" d="M14.6 14.36H14.59"/></svg>',rc='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M12 7V12M12 17V12M17 12H12M12 12H7"/></svg>',S1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M5 10H19"/><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/></svg>',T1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M10 5V18.5"/><path stroke="currentColor" stroke-width="2" d="M14 5V18.5"/><path stroke="currentColor" stroke-width="2" d="M5 10H19"/><path stroke="currentColor" stroke-width="2" d="M5 14H19"/><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/></svg>',_1='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M10 5V18.5"/><path stroke="currentColor" stroke-width="2" d="M5 10H19"/><rect width="14" height="14" x="5" y="5" stroke="currentColor" stroke-width="2" rx="4"/></svg>';class fn{constructor({api:e,items:n,onOpen:r,onClose:s,cssModifier:c=""}){this.api=e,this.items=n,this.onOpen=r,this.onClose=s,this.cssModifier=c,this.popover=null,this.wrapper=this.createToolbox()}static get CSS(){return{toolbox:"tc-toolbox",toolboxShowed:"tc-toolbox--showed",toggler:"tc-toolbox__toggler"}}get element(){return this.wrapper}createToolbox(){const e=we("div",[fn.CSS.toolbox,this.cssModifier?`${fn.CSS.toolbox}--${this.cssModifier}`:""]);e.dataset.mutationFree="true";const n=this.createPopover(),r=this.createToggler();return e.appendChild(r),e.appendChild(n),e}createToggler(){const e=we("div",fn.CSS.toggler,{innerHTML:E1});return e.addEventListener("click",()=>{this.togglerClicked()}),e}createPopover(){return this.popover=new ce({items:this.items}),this.popover.render()}togglerClicked(){this.popover.opened?(this.popover.close(),this.onClose()):(this.popover.open(),this.onOpen())}show(e){const n=e();Object.entries(n).forEach(([r,s])=>{this.wrapper.style[r]=s}),this.wrapper.classList.add(fn.CSS.toolboxShowed)}hide(){this.popover.close(),this.wrapper.classList.remove(fn.CSS.toolboxShowed)}}function B1(l,e){let n=0;return function(...r){const s=new Date().getTime();if(!(s-n<l))return n=s,e(...r)}}const St={wrapper:"tc-wrap",wrapperReadOnly:"tc-wrap--readonly",table:"tc-table",row:"tc-row",withHeadings:"tc-table--heading",rowSelected:"tc-row--selected",cell:"tc-cell",cellSelected:"tc-cell--selected",addRow:"tc-add-row",addColumn:"tc-add-column"};class L1{constructor(e,n,r,s){this.readOnly=e,this.api=n,this.data=r,this.config=s,this.wrapper=null,this.table=null,this.toolboxColumn=this.createColumnToolbox(),this.toolboxRow=this.createRowToolbox(),this.createTableWrapper(),this.hoveredRow=0,this.hoveredColumn=0,this.selectedRow=0,this.selectedColumn=0,this.tunes={withHeadings:!1},this.resize(),this.fill(),this.focusedCell={row:0,column:0},this.documentClicked=c=>{const h=c.target.closest(`.${St.table}`)!==null,f=c.target.closest(`.${St.wrapper}`)===null;(h||f)&&this.hideToolboxes();const g=c.target.closest(`.${St.addRow}`),w=c.target.closest(`.${St.addColumn}`);g&&g.parentNode===this.wrapper?(this.addRow(void 0,!0),this.hideToolboxes()):w&&w.parentNode===this.wrapper&&(this.addColumn(void 0,!0),this.hideToolboxes())},this.readOnly||this.bindEvents()}getWrapper(){return this.wrapper}bindEvents(){document.addEventListener("click",this.documentClicked),this.table.addEventListener("mousemove",B1(150,e=>this.onMouseMoveInTable(e)),{passive:!0}),this.table.onkeypress=e=>this.onKeyPressListener(e),this.table.addEventListener("keydown",e=>this.onKeyDownListener(e)),this.table.addEventListener("focusin",e=>this.focusInTableListener(e))}createColumnToolbox(){return new fn({api:this.api,cssModifier:"column",items:[{label:this.api.i18n.t("Add column to left"),icon:x1,onClick:()=>{this.addColumn(this.selectedColumn,!0),this.hideToolboxes()}},{label:this.api.i18n.t("Add column to right"),icon:y1,onClick:()=>{this.addColumn(this.selectedColumn+1,!0),this.hideToolboxes()}},{label:this.api.i18n.t("Delete column"),icon:ic,hideIf:()=>this.numberOfColumns===1,confirmationRequired:!0,onClick:()=>{this.deleteColumn(this.selectedColumn),this.hideToolboxes()}}],onOpen:()=>{this.selectColumn(this.hoveredColumn),this.hideRowToolbox()},onClose:()=>{this.unselectColumn()}})}createRowToolbox(){return new fn({api:this.api,cssModifier:"row",items:[{label:this.api.i18n.t("Add row above"),icon:C1,onClick:()=>{this.addRow(this.selectedRow,!0),this.hideToolboxes()}},{label:this.api.i18n.t("Add row below"),icon:w1,onClick:()=>{this.addRow(this.selectedRow+1,!0),this.hideToolboxes()}},{label:this.api.i18n.t("Delete row"),icon:ic,hideIf:()=>this.numberOfRows===1,confirmationRequired:!0,onClick:()=>{this.deleteRow(this.selectedRow),this.hideToolboxes()}}],onOpen:()=>{this.selectRow(this.hoveredRow),this.hideColumnToolbox()},onClose:()=>{this.unselectRow()}})}moveCursorToNextRow(){this.focusedCell.row!==this.numberOfRows?(this.focusedCell.row+=1,this.focusCell(this.focusedCell)):(this.addRow(),this.focusedCell.row+=1,this.focusCell(this.focusedCell),this.updateToolboxesPosition(0,0))}getCell(e,n){return this.table.querySelectorAll(`.${St.row}:nth-child(${e}) .${St.cell}`)[n-1]}getRow(e){return this.table.querySelector(`.${St.row}:nth-child(${e})`)}getRowByCell(e){return e.parentElement}getRowFirstCell(e){return e.querySelector(`.${St.cell}:first-child`)}setCellContent(e,n,r){const s=this.getCell(e,n);s.innerHTML=r}addColumn(e=-1,n=!1){let r=this.numberOfColumns;for(let s=1;s<=this.numberOfRows;s++){let c;const h=this.createCell();if(e>0&&e<=r?(c=this.getCell(s,e),nc(h,c)):c=this.getRow(s).appendChild(h),s===1){const f=this.getCell(s,e>0?e:r+1);f&&n&&oc(f)}}this.addHeadingAttrToFirstRow()}addRow(e=-1,n=!1){let r,s=we("div",St.row);this.tunes.withHeadings&&this.removeHeadingAttrFromFirstRow();let c=this.numberOfColumns;if(e>0&&e<=this.numberOfRows){let f=this.getRow(e);r=nc(s,f)}else r=this.table.appendChild(s);this.fillRow(r,c),this.tunes.withHeadings&&this.addHeadingAttrToFirstRow();const h=this.getRowFirstCell(r);return h&&n&&oc(h),r}deleteColumn(e){for(let n=1;n<=this.numberOfRows;n++){const r=this.getCell(n,e);if(!r)return;r.remove()}}deleteRow(e){this.getRow(e).remove(),this.addHeadingAttrToFirstRow()}createTableWrapper(){if(this.wrapper=we("div",St.wrapper),this.table=we("div",St.table),this.readOnly&&this.wrapper.classList.add(St.wrapperReadOnly),this.wrapper.appendChild(this.toolboxRow.element),this.wrapper.appendChild(this.toolboxColumn.element),this.wrapper.appendChild(this.table),!this.readOnly){const e=we("div",St.addColumn,{innerHTML:rc}),n=we("div",St.addRow,{innerHTML:rc});this.wrapper.appendChild(e),this.wrapper.appendChild(n)}}computeInitialSize(){const e=this.data&&this.data.content,n=Array.isArray(e),r=n?e.length:!1,s=n?e.length:void 0,c=r?e[0].length:void 0,h=Number.parseInt(this.config&&this.config.rows),f=Number.parseInt(this.config&&this.config.cols),g=!isNaN(h)&&h>0?h:void 0,w=!isNaN(f)&&f>0?f:void 0;return{rows:s||g||2,cols:c||w||2}}resize(){const{rows:e,cols:n}=this.computeInitialSize();for(let r=0;r<e;r++)this.addRow();for(let r=0;r<n;r++)this.addColumn()}fill(){const e=this.data;if(e&&e.content)for(let n=0;n<e.content.length;n++)for(let r=0;r<e.content[n].length;r++)this.setCellContent(n+1,r+1,e.content[n][r])}fillRow(e,n){for(let r=1;r<=n;r++){const s=this.createCell();e.appendChild(s)}}createCell(){return we("div",St.cell,{contentEditable:!this.readOnly})}get numberOfRows(){return this.table.childElementCount}get numberOfColumns(){return this.numberOfRows?this.table.querySelectorAll(`.${St.row}:first-child .${St.cell}`).length:0}get isColumnMenuShowing(){return this.selectedColumn!==0}get isRowMenuShowing(){return this.selectedRow!==0}onMouseMoveInTable(e){const{row:n,column:r}=this.getHoveredCell(e);this.hoveredColumn=r,this.hoveredRow=n,this.updateToolboxesPosition()}onKeyPressListener(e){if(e.key==="Enter"){if(e.shiftKey)return!0;this.moveCursorToNextRow()}return e.key!=="Enter"}onKeyDownListener(e){e.key==="Tab"&&e.stopPropagation()}focusInTableListener(e){const n=e.target,r=this.getRowByCell(n);this.focusedCell={row:Array.from(this.table.querySelectorAll(`.${St.row}`)).indexOf(r)+1,column:Array.from(r.querySelectorAll(`.${St.cell}`)).indexOf(n)+1}}hideToolboxes(){this.hideRowToolbox(),this.hideColumnToolbox(),this.updateToolboxesPosition()}hideRowToolbox(){this.unselectRow(),this.toolboxRow.hide()}hideColumnToolbox(){this.unselectColumn(),this.toolboxColumn.hide()}focusCell(){this.focusedCellElem.focus()}get focusedCellElem(){const{row:e,column:n}=this.focusedCell;return this.getCell(e,n)}updateToolboxesPosition(e=this.hoveredRow,n=this.hoveredColumn){this.isColumnMenuShowing||n>0&&n<=this.numberOfColumns&&this.toolboxColumn.show(()=>({left:`calc((100% - var(--cell-size)) / (${this.numberOfColumns} * 2) * (1 + (${n} - 1) * 2))`})),this.isRowMenuShowing||e>0&&e<=this.numberOfRows&&this.toolboxRow.show(()=>{const r=this.getRow(e),{fromTopBorder:s}=ec(this.table,r),{height:c}=r.getBoundingClientRect();return{top:`${Math.ceil(s+c/2)}px`}})}setHeadingsSetting(e){this.tunes.withHeadings=e,e?(this.table.classList.add(St.withHeadings),this.addHeadingAttrToFirstRow()):(this.table.classList.remove(St.withHeadings),this.removeHeadingAttrFromFirstRow())}addHeadingAttrToFirstRow(){for(let e=1;e<=this.numberOfColumns;e++){let n=this.getCell(1,e);n&&n.setAttribute("heading",this.api.i18n.t("Heading"))}}removeHeadingAttrFromFirstRow(){for(let e=1;e<=this.numberOfColumns;e++){let n=this.getCell(1,e);n&&n.removeAttribute("heading")}}selectRow(e){const n=this.getRow(e);n&&(this.selectedRow=e,n.classList.add(St.rowSelected))}unselectRow(){if(this.selectedRow<=0)return;const e=this.table.querySelector(`.${St.rowSelected}`);e&&e.classList.remove(St.rowSelected),this.selectedRow=0}selectColumn(e){for(let n=1;n<=this.numberOfRows;n++){const r=this.getCell(n,e);r&&r.classList.add(St.cellSelected)}this.selectedColumn=e}unselectColumn(){if(this.selectedColumn<=0)return;let e=this.table.querySelectorAll(`.${St.cellSelected}`);Array.from(e).forEach(n=>{n.classList.remove(St.cellSelected)}),this.selectedColumn=0}getHoveredCell(e){let n=this.hoveredRow,r=this.hoveredColumn;const{width:s,height:c,x:h,y:f}=k1(this.table,e);return h>=0&&(r=this.binSearch(this.numberOfColumns,g=>this.getCell(1,g),({fromLeftBorder:g})=>h<g,({fromRightBorder:g})=>h>s-g)),f>=0&&(n=this.binSearch(this.numberOfRows,g=>this.getCell(g,1),({fromTopBorder:g})=>f<g,({fromBottomBorder:g})=>f>c-g)),{row:n||this.hoveredRow,column:r||this.hoveredColumn}}binSearch(e,n,r,s){let c=0,h=e+1,f=0,g;for(;c<h-1&&f<10;){g=Math.ceil((c+h)/2);const w=n(g),I=ec(this.table,w);if(r(I))h=g;else if(s(I))c=g;else break;f++}return g}getData(){const e=[];for(let n=1;n<=this.numberOfRows;n++){const r=this.table.querySelector(`.${St.row}:nth-child(${n})`),s=Array.from(r.querySelectorAll(`.${St.cell}`));s.every(c=>!c.textContent.trim())||e.push(s.map(c=>c.innerHTML))}return e}destroy(){document.removeEventListener("click",this.documentClicked)}}class I1{static get isReadOnlySupported(){return!0}static get enableLineBreaks(){return!0}constructor({data:e,config:n,api:r,readOnly:s}){this.api=r,this.readOnly=s,this.config=n,this.data={withHeadings:this.getConfig("withHeadings",!1,e),content:e&&e.content?e.content:[]},this.table=null}static get toolbox(){return{icon:_1,title:"Table"}}render(){return this.table=new L1(this.readOnly,this.api,this.data,this.config),this.container=we("div",this.api.styles.block),this.container.appendChild(this.table.getWrapper()),this.table.setHeadingsSetting(this.data.withHeadings),this.container}renderSettings(){return[{label:this.api.i18n.t("With headings"),icon:S1,isActive:this.data.withHeadings,closeOnActivate:!0,toggle:!0,onActivate:()=>{this.data.withHeadings=!0,this.table.setHeadingsSetting(this.data.withHeadings)}},{label:this.api.i18n.t("Without headings"),icon:T1,isActive:!this.data.withHeadings,closeOnActivate:!0,toggle:!0,onActivate:()=>{this.data.withHeadings=!1,this.table.setHeadingsSetting(this.data.withHeadings)}}]}save(){const e=this.table.getData();return{withHeadings:this.data.withHeadings,content:e}}destroy(){this.table.destroy()}getConfig(e,n=void 0,r=void 0){const s=this.data||r;return s?s[e]?s[e]:n:this.config&&this.config[e]?this.config[e]:n}static get pasteConfig(){return{tags:["TABLE","TR","TH","TD"]}}onPaste(e){const n=e.detail.data,r=n.querySelector(":scope > thead, tr:first-of-type th"),s=Array.from(n.querySelectorAll("tr")).map(c=>Array.from(c.querySelectorAll("th, td")).map(h=>h.innerHTML));this.data={withHeadings:r!==null,content:s},this.table.wrapper&&this.table.wrapper.replaceWith(this.render())}}var go=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rc(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var bi={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */bi.exports;(function(l,e){(function(){var n,r="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",w=500,I="__lodash_placeholder__",E=1,D=2,U=4,T=1,F=2,P=1,it=2,kt=4,Ot=8,G=16,Y=32,Z=64,$=128,y=256,S=512,A=30,R="...",z=800,V=16,rt=1,j=2,wt=3,ht=1/0,Tt=9007199254740991,Ut=17976931348623157e292,ft=0/0,ut=4294967295,oe=ut-1,N=ut>>>1,O=[["ary",$],["bind",P],["bindKey",it],["curry",Ot],["curryRight",G],["flip",S],["partial",Y],["partialRight",Z],["rearg",y]],K="[object Arguments]",Q="[object Array]",X="[object AsyncFunction]",_t="[object Boolean]",Lt="[object Date]",he="[object DOMException]",ie="[object Error]",vt="[object Function]",Xt="[object GeneratorFunction]",Dt="[object Map]",tn="[object Number]",Co="[object Null]",ue="[object Object]",en="[object Promise]",Hc="[object Proxy]",Xn="[object RegExp]",Ie="[object Set]",Zn="[object String]",Eo="[object Symbol]",Fc="[object Undefined]",Vn="[object WeakMap]",Uc="[object WeakSet]",Jn="[object ArrayBuffer]",Bn="[object DataView]",xi="[object Float32Array]",yi="[object Float64Array]",Ci="[object Int8Array]",Ei="[object Int16Array]",Si="[object Int32Array]",Ti="[object Uint8Array]",_i="[object Uint8ClampedArray]",Bi="[object Uint16Array]",Li="[object Uint32Array]",zc=/\b__p \+= '';/g,Wc=/\b(__p \+=) '' \+/g,$c=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fs=/&(?:amp|lt|gt|quot|#39);/g,gs=/[&<>"']/g,Yc=RegExp(fs.source),Kc=RegExp(gs.source),qc=/<%-([\s\S]+?)%>/g,Gc=/<%([\s\S]+?)%>/g,ms=/<%=([\s\S]+?)%>/g,jc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xc=/^\w*$/,Zc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ii=/[\\^$.*+?()[\]{}|]/g,Vc=RegExp(Ii.source),Ai=/^\s+/,Jc=/\s/,Qc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,td=/\{\n\/\* \[wrapped with (.+)\] \*/,ed=/,? & /,nd=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,od=/[()=,{}\[\]\/\s]/,id=/\\(\\)?/g,rd=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,bs=/\w*$/,sd=/^[-+]0x[0-9a-f]+$/i,ad=/^0b[01]+$/i,ld=/^\[object .+?Constructor\]$/,cd=/^0o[0-7]+$/i,dd=/^(?:0|[1-9]\d*)$/,hd=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,So=/($^)/,ud=/['\n\r\u2028\u2029\\]/g,To="\\ud800-\\udfff",pd="\\u0300-\\u036f",fd="\\ufe20-\\ufe2f",gd="\\u20d0-\\u20ff",vs=pd+fd+gd,ks="\\u2700-\\u27bf",ws="a-z\\xdf-\\xf6\\xf8-\\xff",md="\\xac\\xb1\\xd7\\xf7",bd="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vd="\\u2000-\\u206f",kd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xs="A-Z\\xc0-\\xd6\\xd8-\\xde",ys="\\ufe0e\\ufe0f",Cs=md+bd+vd+kd,Mi="['’]",wd="["+To+"]",Es="["+Cs+"]",_o="["+vs+"]",Ss="\\d+",xd="["+ks+"]",Ts="["+ws+"]",_s="[^"+To+Cs+Ss+ks+ws+xs+"]",Oi="\\ud83c[\\udffb-\\udfff]",yd="(?:"+_o+"|"+Oi+")",Bs="[^"+To+"]",Ri="(?:\\ud83c[\\udde6-\\uddff]){2}",Ni="[\\ud800-\\udbff][\\udc00-\\udfff]",Ln="["+xs+"]",Ls="\\u200d",Is="(?:"+Ts+"|"+_s+")",Cd="(?:"+Ln+"|"+_s+")",As="(?:"+Mi+"(?:d|ll|m|re|s|t|ve))?",Ms="(?:"+Mi+"(?:D|LL|M|RE|S|T|VE))?",Os=yd+"?",Rs="["+ys+"]?",Ed="(?:"+Ls+"(?:"+[Bs,Ri,Ni].join("|")+")"+Rs+Os+")*",Sd="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Td="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ns=Rs+Os+Ed,_d="(?:"+[xd,Ri,Ni].join("|")+")"+Ns,Bd="(?:"+[Bs+_o+"?",_o,Ri,Ni,wd].join("|")+")",Ld=RegExp(Mi,"g"),Id=RegExp(_o,"g"),Di=RegExp(Oi+"(?="+Oi+")|"+Bd+Ns,"g"),Ad=RegExp([Ln+"?"+Ts+"+"+As+"(?="+[Es,Ln,"$"].join("|")+")",Cd+"+"+Ms+"(?="+[Es,Ln+Is,"$"].join("|")+")",Ln+"?"+Is+"+"+As,Ln+"+"+Ms,Td,Sd,Ss,_d].join("|"),"g"),Md=RegExp("["+Ls+To+vs+ys+"]"),Od=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rd=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Nd=-1,At={};At[xi]=At[yi]=At[Ci]=At[Ei]=At[Si]=At[Ti]=At[_i]=At[Bi]=At[Li]=!0,At[K]=At[Q]=At[Jn]=At[_t]=At[Bn]=At[Lt]=At[ie]=At[vt]=At[Dt]=At[tn]=At[ue]=At[Xn]=At[Ie]=At[Zn]=At[Vn]=!1;var It={};It[K]=It[Q]=It[Jn]=It[Bn]=It[_t]=It[Lt]=It[xi]=It[yi]=It[Ci]=It[Ei]=It[Si]=It[Dt]=It[tn]=It[ue]=It[Xn]=It[Ie]=It[Zn]=It[Eo]=It[Ti]=It[_i]=It[Bi]=It[Li]=!0,It[ie]=It[vt]=It[Vn]=!1;var Dd={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Pd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Hd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fd={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ud=parseFloat,zd=parseInt,Ds=typeof go=="object"&&go&&go.Object===Object&&go,Wd=typeof self=="object"&&self&&self.Object===Object&&self,Kt=Ds||Wd||Function("return this")(),Pi=e&&!e.nodeType&&e,mn=Pi&&!0&&l&&!l.nodeType&&l,Ps=mn&&mn.exports===Pi,Hi=Ps&&Ds.process,xe=function(){try{var v=mn&&mn.require&&mn.require("util").types;return v||Hi&&Hi.binding&&Hi.binding("util")}catch{}}(),Hs=xe&&xe.isArrayBuffer,Fs=xe&&xe.isDate,Us=xe&&xe.isMap,zs=xe&&xe.isRegExp,Ws=xe&&xe.isSet,$s=xe&&xe.isTypedArray;function pe(v,_,x){switch(x.length){case 0:return v.call(_);case 1:return v.call(_,x[0]);case 2:return v.call(_,x[0],x[1]);case 3:return v.call(_,x[0],x[1],x[2])}return v.apply(_,x)}function $d(v,_,x,W){for(var st=-1,xt=v==null?0:v.length;++st<xt;){var zt=v[st];_(W,zt,x(zt),v)}return W}function ye(v,_){for(var x=-1,W=v==null?0:v.length;++x<W&&_(v[x],x,v)!==!1;);return v}function Yd(v,_){for(var x=v==null?0:v.length;x--&&_(v[x],x,v)!==!1;);return v}function Ys(v,_){for(var x=-1,W=v==null?0:v.length;++x<W;)if(!_(v[x],x,v))return!1;return!0}function nn(v,_){for(var x=-1,W=v==null?0:v.length,st=0,xt=[];++x<W;){var zt=v[x];_(zt,x,v)&&(xt[st++]=zt)}return xt}function Bo(v,_){var x=v==null?0:v.length;return!!x&&In(v,_,0)>-1}function Fi(v,_,x){for(var W=-1,st=v==null?0:v.length;++W<st;)if(x(_,v[W]))return!0;return!1}function Rt(v,_){for(var x=-1,W=v==null?0:v.length,st=Array(W);++x<W;)st[x]=_(v[x],x,v);return st}function on(v,_){for(var x=-1,W=_.length,st=v.length;++x<W;)v[st+x]=_[x];return v}function Ui(v,_,x,W){var st=-1,xt=v==null?0:v.length;for(W&&xt&&(x=v[++st]);++st<xt;)x=_(x,v[st],st,v);return x}function Kd(v,_,x,W){var st=v==null?0:v.length;for(W&&st&&(x=v[--st]);st--;)x=_(x,v[st],st,v);return x}function zi(v,_){for(var x=-1,W=v==null?0:v.length;++x<W;)if(_(v[x],x,v))return!0;return!1}var qd=Wi("length");function Gd(v){return v.split("")}function jd(v){return v.match(nd)||[]}function Ks(v,_,x){var W;return x(v,function(st,xt,zt){if(_(st,xt,zt))return W=xt,!1}),W}function Lo(v,_,x,W){for(var st=v.length,xt=x+(W?1:-1);W?xt--:++xt<st;)if(_(v[xt],xt,v))return xt;return-1}function In(v,_,x){return _===_?sh(v,_,x):Lo(v,qs,x)}function Xd(v,_,x,W){for(var st=x-1,xt=v.length;++st<xt;)if(W(v[st],_))return st;return-1}function qs(v){return v!==v}function Gs(v,_){var x=v==null?0:v.length;return x?Yi(v,_)/x:ft}function Wi(v){return function(_){return _==null?n:_[v]}}function $i(v){return function(_){return v==null?n:v[_]}}function js(v,_,x,W,st){return st(v,function(xt,zt,Bt){x=W?(W=!1,xt):_(x,xt,zt,Bt)}),x}function Zd(v,_){var x=v.length;for(v.sort(_);x--;)v[x]=v[x].value;return v}function Yi(v,_){for(var x,W=-1,st=v.length;++W<st;){var xt=_(v[W]);xt!==n&&(x=x===n?xt:x+xt)}return x}function Ki(v,_){for(var x=-1,W=Array(v);++x<v;)W[x]=_(x);return W}function Vd(v,_){return Rt(_,function(x){return[x,v[x]]})}function Xs(v){return v&&v.slice(0,Qs(v)+1).replace(Ai,"")}function fe(v){return function(_){return v(_)}}function qi(v,_){return Rt(_,function(x){return v[x]})}function Qn(v,_){return v.has(_)}function Zs(v,_){for(var x=-1,W=v.length;++x<W&&In(_,v[x],0)>-1;);return x}function Vs(v,_){for(var x=v.length;x--&&In(_,v[x],0)>-1;);return x}function Jd(v,_){for(var x=v.length,W=0;x--;)v[x]===_&&++W;return W}var Qd=$i(Dd),th=$i(Pd);function eh(v){return"\\"+Fd[v]}function nh(v,_){return v==null?n:v[_]}function An(v){return Md.test(v)}function oh(v){return Od.test(v)}function ih(v){for(var _,x=[];!(_=v.next()).done;)x.push(_.value);return x}function Gi(v){var _=-1,x=Array(v.size);return v.forEach(function(W,st){x[++_]=[st,W]}),x}function Js(v,_){return function(x){return v(_(x))}}function rn(v,_){for(var x=-1,W=v.length,st=0,xt=[];++x<W;){var zt=v[x];(zt===_||zt===I)&&(v[x]=I,xt[st++]=x)}return xt}function Io(v){var _=-1,x=Array(v.size);return v.forEach(function(W){x[++_]=W}),x}function rh(v){var _=-1,x=Array(v.size);return v.forEach(function(W){x[++_]=[W,W]}),x}function sh(v,_,x){for(var W=x-1,st=v.length;++W<st;)if(v[W]===_)return W;return-1}function ah(v,_,x){for(var W=x+1;W--;)if(v[W]===_)return W;return W}function Mn(v){return An(v)?ch(v):qd(v)}function Ae(v){return An(v)?dh(v):Gd(v)}function Qs(v){for(var _=v.length;_--&&Jc.test(v.charAt(_)););return _}var lh=$i(Hd);function ch(v){for(var _=Di.lastIndex=0;Di.test(v);)++_;return _}function dh(v){return v.match(Di)||[]}function hh(v){return v.match(Ad)||[]}var uh=function v(_){_=_==null?Kt:On.defaults(Kt.Object(),_,On.pick(Kt,Rd));var x=_.Array,W=_.Date,st=_.Error,xt=_.Function,zt=_.Math,Bt=_.Object,ji=_.RegExp,ph=_.String,Ce=_.TypeError,Ao=x.prototype,fh=xt.prototype,Rn=Bt.prototype,Mo=_["__core-js_shared__"],Oo=fh.toString,Et=Rn.hasOwnProperty,gh=0,ta=function(){var t=/[^.]+$/.exec(Mo&&Mo.keys&&Mo.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ro=Rn.toString,mh=Oo.call(Bt),bh=Kt._,vh=ji("^"+Oo.call(Et).replace(Ii,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),No=Ps?_.Buffer:n,sn=_.Symbol,Do=_.Uint8Array,ea=No?No.allocUnsafe:n,Po=Js(Bt.getPrototypeOf,Bt),na=Bt.create,oa=Rn.propertyIsEnumerable,Ho=Ao.splice,ia=sn?sn.isConcatSpreadable:n,to=sn?sn.iterator:n,bn=sn?sn.toStringTag:n,Fo=function(){try{var t=yn(Bt,"defineProperty");return t({},"",{}),t}catch{}}(),kh=_.clearTimeout!==Kt.clearTimeout&&_.clearTimeout,wh=W&&W.now!==Kt.Date.now&&W.now,xh=_.setTimeout!==Kt.setTimeout&&_.setTimeout,Uo=zt.ceil,zo=zt.floor,Xi=Bt.getOwnPropertySymbols,yh=No?No.isBuffer:n,ra=_.isFinite,Ch=Ao.join,Eh=Js(Bt.keys,Bt),Wt=zt.max,Zt=zt.min,Sh=W.now,Th=_.parseInt,sa=zt.random,_h=Ao.reverse,Zi=yn(_,"DataView"),eo=yn(_,"Map"),Vi=yn(_,"Promise"),Nn=yn(_,"Set"),no=yn(_,"WeakMap"),oo=yn(Bt,"create"),Wo=no&&new no,Dn={},Bh=Cn(Zi),Lh=Cn(eo),Ih=Cn(Vi),Ah=Cn(Nn),Mh=Cn(no),$o=sn?sn.prototype:n,io=$o?$o.valueOf:n,aa=$o?$o.toString:n;function u(t){if(Pt(t)&&!at(t)&&!(t instanceof gt)){if(t instanceof Ee)return t;if(Et.call(t,"__wrapped__"))return ll(t)}return new Ee(t)}var Pn=function(){function t(){}return function(o){if(!Nt(o))return{};if(na)return na(o);t.prototype=o;var i=new t;return t.prototype=n,i}}();function Yo(){}function Ee(t,o){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=n}u.templateSettings={escape:qc,evaluate:Gc,interpolate:ms,variable:"",imports:{_:u}},u.prototype=Yo.prototype,u.prototype.constructor=u,Ee.prototype=Pn(Yo.prototype),Ee.prototype.constructor=Ee;function gt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ut,this.__views__=[]}function Oh(){var t=new gt(this.__wrapped__);return t.__actions__=re(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=re(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=re(this.__views__),t}function Rh(){if(this.__filtered__){var t=new gt(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Nh(){var t=this.__wrapped__.value(),o=this.__dir__,i=at(t),a=o<0,d=i?t.length:0,p=Gu(0,d,this.__views__),m=p.start,b=p.end,k=b-m,B=a?b:m-1,L=this.__iteratees__,M=L.length,H=0,q=Zt(k,this.__takeCount__);if(!i||!a&&d==k&&q==k)return Aa(t,this.__actions__);var tt=[];t:for(;k--&&H<q;){B+=o;for(var ct=-1,et=t[B];++ct<M;){var pt=L[ct],mt=pt.iteratee,be=pt.type,ee=mt(et);if(be==j)et=ee;else if(!ee){if(be==rt)continue t;break t}}tt[H++]=et}return tt}gt.prototype=Pn(Yo.prototype),gt.prototype.constructor=gt;function vn(t){var o=-1,i=t==null?0:t.length;for(this.clear();++o<i;){var a=t[o];this.set(a[0],a[1])}}function Dh(){this.__data__=oo?oo(null):{},this.size=0}function Ph(t){var o=this.has(t)&&delete this.__data__[t];return this.size-=o?1:0,o}function Hh(t){var o=this.__data__;if(oo){var i=o[t];return i===g?n:i}return Et.call(o,t)?o[t]:n}function Fh(t){var o=this.__data__;return oo?o[t]!==n:Et.call(o,t)}function Uh(t,o){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=oo&&o===n?g:o,this}vn.prototype.clear=Dh,vn.prototype.delete=Ph,vn.prototype.get=Hh,vn.prototype.has=Fh,vn.prototype.set=Uh;function ze(t){var o=-1,i=t==null?0:t.length;for(this.clear();++o<i;){var a=t[o];this.set(a[0],a[1])}}function zh(){this.__data__=[],this.size=0}function Wh(t){var o=this.__data__,i=Ko(o,t);if(i<0)return!1;var a=o.length-1;return i==a?o.pop():Ho.call(o,i,1),--this.size,!0}function $h(t){var o=this.__data__,i=Ko(o,t);return i<0?n:o[i][1]}function Yh(t){return Ko(this.__data__,t)>-1}function Kh(t,o){var i=this.__data__,a=Ko(i,t);return a<0?(++this.size,i.push([t,o])):i[a][1]=o,this}ze.prototype.clear=zh,ze.prototype.delete=Wh,ze.prototype.get=$h,ze.prototype.has=Yh,ze.prototype.set=Kh;function We(t){var o=-1,i=t==null?0:t.length;for(this.clear();++o<i;){var a=t[o];this.set(a[0],a[1])}}function qh(){this.size=0,this.__data__={hash:new vn,map:new(eo||ze),string:new vn}}function Gh(t){var o=oi(this,t).delete(t);return this.size-=o?1:0,o}function jh(t){return oi(this,t).get(t)}function Xh(t){return oi(this,t).has(t)}function Zh(t,o){var i=oi(this,t),a=i.size;return i.set(t,o),this.size+=i.size==a?0:1,this}We.prototype.clear=qh,We.prototype.delete=Gh,We.prototype.get=jh,We.prototype.has=Xh,We.prototype.set=Zh;function kn(t){var o=-1,i=t==null?0:t.length;for(this.__data__=new We;++o<i;)this.add(t[o])}function Vh(t){return this.__data__.set(t,g),this}function Jh(t){return this.__data__.has(t)}kn.prototype.add=kn.prototype.push=Vh,kn.prototype.has=Jh;function Me(t){var o=this.__data__=new ze(t);this.size=o.size}function Qh(){this.__data__=new ze,this.size=0}function tu(t){var o=this.__data__,i=o.delete(t);return this.size=o.size,i}function eu(t){return this.__data__.get(t)}function nu(t){return this.__data__.has(t)}function ou(t,o){var i=this.__data__;if(i instanceof ze){var a=i.__data__;if(!eo||a.length<s-1)return a.push([t,o]),this.size=++i.size,this;i=this.__data__=new We(a)}return i.set(t,o),this.size=i.size,this}Me.prototype.clear=Qh,Me.prototype.delete=tu,Me.prototype.get=eu,Me.prototype.has=nu,Me.prototype.set=ou;function la(t,o){var i=at(t),a=!i&&En(t),d=!i&&!a&&hn(t),p=!i&&!a&&!d&&zn(t),m=i||a||d||p,b=m?Ki(t.length,ph):[],k=b.length;for(var B in t)(o||Et.call(t,B))&&!(m&&(B=="length"||d&&(B=="offset"||B=="parent")||p&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||qe(B,k)))&&b.push(B);return b}function ca(t){var o=t.length;return o?t[lr(0,o-1)]:n}function iu(t,o){return ii(re(t),wn(o,0,t.length))}function ru(t){return ii(re(t))}function Ji(t,o,i){(i!==n&&!Oe(t[o],i)||i===n&&!(o in t))&&$e(t,o,i)}function ro(t,o,i){var a=t[o];(!(Et.call(t,o)&&Oe(a,i))||i===n&&!(o in t))&&$e(t,o,i)}function Ko(t,o){for(var i=t.length;i--;)if(Oe(t[i][0],o))return i;return-1}function su(t,o,i,a){return an(t,function(d,p,m){o(a,d,i(d),m)}),a}function da(t,o){return t&&Fe(o,Yt(o),t)}function au(t,o){return t&&Fe(o,ae(o),t)}function $e(t,o,i){o=="__proto__"&&Fo?Fo(t,o,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[o]=i}function Qi(t,o){for(var i=-1,a=o.length,d=x(a),p=t==null;++i<a;)d[i]=p?n:Or(t,o[i]);return d}function wn(t,o,i){return t===t&&(i!==n&&(t=t<=i?t:i),o!==n&&(t=t>=o?t:o)),t}function Se(t,o,i,a,d,p){var m,b=o&E,k=o&D,B=o&U;if(i&&(m=d?i(t,a,d,p):i(t)),m!==n)return m;if(!Nt(t))return t;var L=at(t);if(L){if(m=Xu(t),!b)return re(t,m)}else{var M=Vt(t),H=M==vt||M==Xt;if(hn(t))return Ra(t,b);if(M==ue||M==K||H&&!d){if(m=k||H?{}:Qa(t),!b)return k?Hu(t,au(m,t)):Pu(t,da(m,t))}else{if(!It[M])return d?t:{};m=Zu(t,M,b)}}p||(p=new Me);var q=p.get(t);if(q)return q;p.set(t,m),Bl(t)?t.forEach(function(et){m.add(Se(et,o,i,et,t,p))}):Tl(t)&&t.forEach(function(et,pt){m.set(pt,Se(et,o,i,pt,t,p))});var tt=B?k?kr:vr:k?ae:Yt,ct=L?n:tt(t);return ye(ct||t,function(et,pt){ct&&(pt=et,et=t[pt]),ro(m,pt,Se(et,o,i,pt,t,p))}),m}function lu(t){var o=Yt(t);return function(i){return ha(i,t,o)}}function ha(t,o,i){var a=i.length;if(t==null)return!a;for(t=Bt(t);a--;){var d=i[a],p=o[d],m=t[d];if(m===n&&!(d in t)||!p(m))return!1}return!0}function ua(t,o,i){if(typeof t!="function")throw new Ce(h);return po(function(){t.apply(n,i)},o)}function so(t,o,i,a){var d=-1,p=Bo,m=!0,b=t.length,k=[],B=o.length;if(!b)return k;i&&(o=Rt(o,fe(i))),a?(p=Fi,m=!1):o.length>=s&&(p=Qn,m=!1,o=new kn(o));t:for(;++d<b;){var L=t[d],M=i==null?L:i(L);if(L=a||L!==0?L:0,m&&M===M){for(var H=B;H--;)if(o[H]===M)continue t;k.push(L)}else p(o,M,a)||k.push(L)}return k}var an=Fa(He),pa=Fa(er,!0);function cu(t,o){var i=!0;return an(t,function(a,d,p){return i=!!o(a,d,p),i}),i}function qo(t,o,i){for(var a=-1,d=t.length;++a<d;){var p=t[a],m=o(p);if(m!=null&&(b===n?m===m&&!me(m):i(m,b)))var b=m,k=p}return k}function du(t,o,i,a){var d=t.length;for(i=lt(i),i<0&&(i=-i>d?0:d+i),a=a===n||a>d?d:lt(a),a<0&&(a+=d),a=i>a?0:Il(a);i<a;)t[i++]=o;return t}function fa(t,o){var i=[];return an(t,function(a,d,p){o(a,d,p)&&i.push(a)}),i}function qt(t,o,i,a,d){var p=-1,m=t.length;for(i||(i=Ju),d||(d=[]);++p<m;){var b=t[p];o>0&&i(b)?o>1?qt(b,o-1,i,a,d):on(d,b):a||(d[d.length]=b)}return d}var tr=Ua(),ga=Ua(!0);function He(t,o){return t&&tr(t,o,Yt)}function er(t,o){return t&&ga(t,o,Yt)}function Go(t,o){return nn(o,function(i){return Ge(t[i])})}function xn(t,o){o=cn(o,t);for(var i=0,a=o.length;t!=null&&i<a;)t=t[Ue(o[i++])];return i&&i==a?t:n}function ma(t,o,i){var a=o(t);return at(t)?a:on(a,i(t))}function Qt(t){return t==null?t===n?Fc:Co:bn&&bn in Bt(t)?qu(t):rp(t)}function nr(t,o){return t>o}function hu(t,o){return t!=null&&Et.call(t,o)}function uu(t,o){return t!=null&&o in Bt(t)}function pu(t,o,i){return t>=Zt(o,i)&&t<Wt(o,i)}function or(t,o,i){for(var a=i?Fi:Bo,d=t[0].length,p=t.length,m=p,b=x(p),k=1/0,B=[];m--;){var L=t[m];m&&o&&(L=Rt(L,fe(o))),k=Zt(L.length,k),b[m]=!i&&(o||d>=120&&L.length>=120)?new kn(m&&L):n}L=t[0];var M=-1,H=b[0];t:for(;++M<d&&B.length<k;){var q=L[M],tt=o?o(q):q;if(q=i||q!==0?q:0,!(H?Qn(H,tt):a(B,tt,i))){for(m=p;--m;){var ct=b[m];if(!(ct?Qn(ct,tt):a(t[m],tt,i)))continue t}H&&H.push(tt),B.push(q)}}return B}function fu(t,o,i,a){return He(t,function(d,p,m){o(a,i(d),p,m)}),a}function ao(t,o,i){o=cn(o,t),t=ol(t,o);var a=t==null?t:t[Ue(_e(o))];return a==null?n:pe(a,t,i)}function ba(t){return Pt(t)&&Qt(t)==K}function gu(t){return Pt(t)&&Qt(t)==Jn}function mu(t){return Pt(t)&&Qt(t)==Lt}function lo(t,o,i,a,d){return t===o?!0:t==null||o==null||!Pt(t)&&!Pt(o)?t!==t&&o!==o:bu(t,o,i,a,lo,d)}function bu(t,o,i,a,d,p){var m=at(t),b=at(o),k=m?Q:Vt(t),B=b?Q:Vt(o);k=k==K?ue:k,B=B==K?ue:B;var L=k==ue,M=B==ue,H=k==B;if(H&&hn(t)){if(!hn(o))return!1;m=!0,L=!1}if(H&&!L)return p||(p=new Me),m||zn(t)?Za(t,o,i,a,d,p):Yu(t,o,k,i,a,d,p);if(!(i&T)){var q=L&&Et.call(t,"__wrapped__"),tt=M&&Et.call(o,"__wrapped__");if(q||tt){var ct=q?t.value():t,et=tt?o.value():o;return p||(p=new Me),d(ct,et,i,a,p)}}return H?(p||(p=new Me),Ku(t,o,i,a,d,p)):!1}function vu(t){return Pt(t)&&Vt(t)==Dt}function ir(t,o,i,a){var d=i.length,p=d,m=!a;if(t==null)return!p;for(t=Bt(t);d--;){var b=i[d];if(m&&b[2]?b[1]!==t[b[0]]:!(b[0]in t))return!1}for(;++d<p;){b=i[d];var k=b[0],B=t[k],L=b[1];if(m&&b[2]){if(B===n&&!(k in t))return!1}else{var M=new Me;if(a)var H=a(B,L,k,t,o,M);if(!(H===n?lo(L,B,T|F,a,M):H))return!1}}return!0}function va(t){if(!Nt(t)||tp(t))return!1;var o=Ge(t)?vh:ld;return o.test(Cn(t))}function ku(t){return Pt(t)&&Qt(t)==Xn}function wu(t){return Pt(t)&&Vt(t)==Ie}function xu(t){return Pt(t)&&di(t.length)&&!!At[Qt(t)]}function ka(t){return typeof t=="function"?t:t==null?le:typeof t=="object"?at(t)?ya(t[0],t[1]):xa(t):zl(t)}function rr(t){if(!uo(t))return Eh(t);var o=[];for(var i in Bt(t))Et.call(t,i)&&i!="constructor"&&o.push(i);return o}function yu(t){if(!Nt(t))return ip(t);var o=uo(t),i=[];for(var a in t)a=="constructor"&&(o||!Et.call(t,a))||i.push(a);return i}function sr(t,o){return t<o}function wa(t,o){var i=-1,a=se(t)?x(t.length):[];return an(t,function(d,p,m){a[++i]=o(d,p,m)}),a}function xa(t){var o=xr(t);return o.length==1&&o[0][2]?el(o[0][0],o[0][1]):function(i){return i===t||ir(i,t,o)}}function ya(t,o){return Cr(t)&&tl(o)?el(Ue(t),o):function(i){var a=Or(i,t);return a===n&&a===o?Rr(i,t):lo(o,a,T|F)}}function jo(t,o,i,a,d){t!==o&&tr(o,function(p,m){if(d||(d=new Me),Nt(p))Cu(t,o,m,i,jo,a,d);else{var b=a?a(Sr(t,m),p,m+"",t,o,d):n;b===n&&(b=p),Ji(t,m,b)}},ae)}function Cu(t,o,i,a,d,p,m){var b=Sr(t,i),k=Sr(o,i),B=m.get(k);if(B){Ji(t,i,B);return}var L=p?p(b,k,i+"",t,o,m):n,M=L===n;if(M){var H=at(k),q=!H&&hn(k),tt=!H&&!q&&zn(k);L=k,H||q||tt?at(b)?L=b:Ht(b)?L=re(b):q?(M=!1,L=Ra(k,!0)):tt?(M=!1,L=Na(k,!0)):L=[]:fo(k)||En(k)?(L=b,En(b)?L=Al(b):(!Nt(b)||Ge(b))&&(L=Qa(k))):M=!1}M&&(m.set(k,L),d(L,k,a,p,m),m.delete(k)),Ji(t,i,L)}function Ca(t,o){var i=t.length;if(i)return o+=o<0?i:0,qe(o,i)?t[o]:n}function Ea(t,o,i){o.length?o=Rt(o,function(p){return at(p)?function(m){return xn(m,p.length===1?p[0]:p)}:p}):o=[le];var a=-1;o=Rt(o,fe(J()));var d=wa(t,function(p,m,b){var k=Rt(o,function(B){return B(p)});return{criteria:k,index:++a,value:p}});return Zd(d,function(p,m){return Du(p,m,i)})}function Eu(t,o){return Sa(t,o,function(i,a){return Rr(t,a)})}function Sa(t,o,i){for(var a=-1,d=o.length,p={};++a<d;){var m=o[a],b=xn(t,m);i(b,m)&&co(p,cn(m,t),b)}return p}function Su(t){return function(o){return xn(o,t)}}function ar(t,o,i,a){var d=a?Xd:In,p=-1,m=o.length,b=t;for(t===o&&(o=re(o)),i&&(b=Rt(t,fe(i)));++p<m;)for(var k=0,B=o[p],L=i?i(B):B;(k=d(b,L,k,a))>-1;)b!==t&&Ho.call(b,k,1),Ho.call(t,k,1);return t}function Ta(t,o){for(var i=t?o.length:0,a=i-1;i--;){var d=o[i];if(i==a||d!==p){var p=d;qe(d)?Ho.call(t,d,1):hr(t,d)}}return t}function lr(t,o){return t+zo(sa()*(o-t+1))}function Tu(t,o,i,a){for(var d=-1,p=Wt(Uo((o-t)/(i||1)),0),m=x(p);p--;)m[a?p:++d]=t,t+=i;return m}function cr(t,o){var i="";if(!t||o<1||o>Tt)return i;do o%2&&(i+=t),o=zo(o/2),o&&(t+=t);while(o);return i}function dt(t,o){return Tr(nl(t,o,le),t+"")}function _u(t){return ca(Wn(t))}function Bu(t,o){var i=Wn(t);return ii(i,wn(o,0,i.length))}function co(t,o,i,a){if(!Nt(t))return t;o=cn(o,t);for(var d=-1,p=o.length,m=p-1,b=t;b!=null&&++d<p;){var k=Ue(o[d]),B=i;if(k==="__proto__"||k==="constructor"||k==="prototype")return t;if(d!=m){var L=b[k];B=a?a(L,k,b):n,B===n&&(B=Nt(L)?L:qe(o[d+1])?[]:{})}ro(b,k,B),b=b[k]}return t}var _a=Wo?function(t,o){return Wo.set(t,o),t}:le,Lu=Fo?function(t,o){return Fo(t,"toString",{configurable:!0,enumerable:!1,value:Dr(o),writable:!0})}:le;function Iu(t){return ii(Wn(t))}function Te(t,o,i){var a=-1,d=t.length;o<0&&(o=-o>d?0:d+o),i=i>d?d:i,i<0&&(i+=d),d=o>i?0:i-o>>>0,o>>>=0;for(var p=x(d);++a<d;)p[a]=t[a+o];return p}function Au(t,o){var i;return an(t,function(a,d,p){return i=o(a,d,p),!i}),!!i}function Xo(t,o,i){var a=0,d=t==null?a:t.length;if(typeof o=="number"&&o===o&&d<=N){for(;a<d;){var p=a+d>>>1,m=t[p];m!==null&&!me(m)&&(i?m<=o:m<o)?a=p+1:d=p}return d}return dr(t,o,le,i)}function dr(t,o,i,a){var d=0,p=t==null?0:t.length;if(p===0)return 0;o=i(o);for(var m=o!==o,b=o===null,k=me(o),B=o===n;d<p;){var L=zo((d+p)/2),M=i(t[L]),H=M!==n,q=M===null,tt=M===M,ct=me(M);if(m)var et=a||tt;else B?et=tt&&(a||H):b?et=tt&&H&&(a||!q):k?et=tt&&H&&!q&&(a||!ct):q||ct?et=!1:et=a?M<=o:M<o;et?d=L+1:p=L}return Zt(p,oe)}function Ba(t,o){for(var i=-1,a=t.length,d=0,p=[];++i<a;){var m=t[i],b=o?o(m):m;if(!i||!Oe(b,k)){var k=b;p[d++]=m===0?0:m}}return p}function La(t){return typeof t=="number"?t:me(t)?ft:+t}function ge(t){if(typeof t=="string")return t;if(at(t))return Rt(t,ge)+"";if(me(t))return aa?aa.call(t):"";var o=t+"";return o=="0"&&1/t==-ht?"-0":o}function ln(t,o,i){var a=-1,d=Bo,p=t.length,m=!0,b=[],k=b;if(i)m=!1,d=Fi;else if(p>=s){var B=o?null:Wu(t);if(B)return Io(B);m=!1,d=Qn,k=new kn}else k=o?[]:b;t:for(;++a<p;){var L=t[a],M=o?o(L):L;if(L=i||L!==0?L:0,m&&M===M){for(var H=k.length;H--;)if(k[H]===M)continue t;o&&k.push(M),b.push(L)}else d(k,M,i)||(k!==b&&k.push(M),b.push(L))}return b}function hr(t,o){return o=cn(o,t),t=ol(t,o),t==null||delete t[Ue(_e(o))]}function Ia(t,o,i,a){return co(t,o,i(xn(t,o)),a)}function Zo(t,o,i,a){for(var d=t.length,p=a?d:-1;(a?p--:++p<d)&&o(t[p],p,t););return i?Te(t,a?0:p,a?p+1:d):Te(t,a?p+1:0,a?d:p)}function Aa(t,o){var i=t;return i instanceof gt&&(i=i.value()),Ui(o,function(a,d){return d.func.apply(d.thisArg,on([a],d.args))},i)}function ur(t,o,i){var a=t.length;if(a<2)return a?ln(t[0]):[];for(var d=-1,p=x(a);++d<a;)for(var m=t[d],b=-1;++b<a;)b!=d&&(p[d]=so(p[d]||m,t[b],o,i));return ln(qt(p,1),o,i)}function Ma(t,o,i){for(var a=-1,d=t.length,p=o.length,m={};++a<d;){var b=a<p?o[a]:n;i(m,t[a],b)}return m}function pr(t){return Ht(t)?t:[]}function fr(t){return typeof t=="function"?t:le}function cn(t,o){return at(t)?t:Cr(t,o)?[t]:al(Ct(t))}var Mu=dt;function dn(t,o,i){var a=t.length;return i=i===n?a:i,!o&&i>=a?t:Te(t,o,i)}var Oa=kh||function(t){return Kt.clearTimeout(t)};function Ra(t,o){if(o)return t.slice();var i=t.length,a=ea?ea(i):new t.constructor(i);return t.copy(a),a}function gr(t){var o=new t.constructor(t.byteLength);return new Do(o).set(new Do(t)),o}function Ou(t,o){var i=o?gr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}function Ru(t){var o=new t.constructor(t.source,bs.exec(t));return o.lastIndex=t.lastIndex,o}function Nu(t){return io?Bt(io.call(t)):{}}function Na(t,o){var i=o?gr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function Da(t,o){if(t!==o){var i=t!==n,a=t===null,d=t===t,p=me(t),m=o!==n,b=o===null,k=o===o,B=me(o);if(!b&&!B&&!p&&t>o||p&&m&&k&&!b&&!B||a&&m&&k||!i&&k||!d)return 1;if(!a&&!p&&!B&&t<o||B&&i&&d&&!a&&!p||b&&i&&d||!m&&d||!k)return-1}return 0}function Du(t,o,i){for(var a=-1,d=t.criteria,p=o.criteria,m=d.length,b=i.length;++a<m;){var k=Da(d[a],p[a]);if(k){if(a>=b)return k;var B=i[a];return k*(B=="desc"?-1:1)}}return t.index-o.index}function Pa(t,o,i,a){for(var d=-1,p=t.length,m=i.length,b=-1,k=o.length,B=Wt(p-m,0),L=x(k+B),M=!a;++b<k;)L[b]=o[b];for(;++d<m;)(M||d<p)&&(L[i[d]]=t[d]);for(;B--;)L[b++]=t[d++];return L}function Ha(t,o,i,a){for(var d=-1,p=t.length,m=-1,b=i.length,k=-1,B=o.length,L=Wt(p-b,0),M=x(L+B),H=!a;++d<L;)M[d]=t[d];for(var q=d;++k<B;)M[q+k]=o[k];for(;++m<b;)(H||d<p)&&(M[q+i[m]]=t[d++]);return M}function re(t,o){var i=-1,a=t.length;for(o||(o=x(a));++i<a;)o[i]=t[i];return o}function Fe(t,o,i,a){var d=!i;i||(i={});for(var p=-1,m=o.length;++p<m;){var b=o[p],k=a?a(i[b],t[b],b,i,t):n;k===n&&(k=t[b]),d?$e(i,b,k):ro(i,b,k)}return i}function Pu(t,o){return Fe(t,yr(t),o)}function Hu(t,o){return Fe(t,Va(t),o)}function Vo(t,o){return function(i,a){var d=at(i)?$d:su,p=o?o():{};return d(i,t,J(a,2),p)}}function Hn(t){return dt(function(o,i){var a=-1,d=i.length,p=d>1?i[d-1]:n,m=d>2?i[2]:n;for(p=t.length>3&&typeof p=="function"?(d--,p):n,m&&te(i[0],i[1],m)&&(p=d<3?n:p,d=1),o=Bt(o);++a<d;){var b=i[a];b&&t(o,b,a,p)}return o})}function Fa(t,o){return function(i,a){if(i==null)return i;if(!se(i))return t(i,a);for(var d=i.length,p=o?d:-1,m=Bt(i);(o?p--:++p<d)&&a(m[p],p,m)!==!1;);return i}}function Ua(t){return function(o,i,a){for(var d=-1,p=Bt(o),m=a(o),b=m.length;b--;){var k=m[t?b:++d];if(i(p[k],k,p)===!1)break}return o}}function Fu(t,o,i){var a=o&P,d=ho(t);function p(){var m=this&&this!==Kt&&this instanceof p?d:t;return m.apply(a?i:this,arguments)}return p}function za(t){return function(o){o=Ct(o);var i=An(o)?Ae(o):n,a=i?i[0]:o.charAt(0),d=i?dn(i,1).join(""):o.slice(1);return a[t]()+d}}function Fn(t){return function(o){return Ui(Fl(Hl(o).replace(Ld,"")),t,"")}}function ho(t){return function(){var o=arguments;switch(o.length){case 0:return new t;case 1:return new t(o[0]);case 2:return new t(o[0],o[1]);case 3:return new t(o[0],o[1],o[2]);case 4:return new t(o[0],o[1],o[2],o[3]);case 5:return new t(o[0],o[1],o[2],o[3],o[4]);case 6:return new t(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new t(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var i=Pn(t.prototype),a=t.apply(i,o);return Nt(a)?a:i}}function Uu(t,o,i){var a=ho(t);function d(){for(var p=arguments.length,m=x(p),b=p,k=Un(d);b--;)m[b]=arguments[b];var B=p<3&&m[0]!==k&&m[p-1]!==k?[]:rn(m,k);if(p-=B.length,p<i)return qa(t,o,Jo,d.placeholder,n,m,B,n,n,i-p);var L=this&&this!==Kt&&this instanceof d?a:t;return pe(L,this,m)}return d}function Wa(t){return function(o,i,a){var d=Bt(o);if(!se(o)){var p=J(i,3);o=Yt(o),i=function(b){return p(d[b],b,d)}}var m=t(o,i,a);return m>-1?d[p?o[m]:m]:n}}function $a(t){return Ke(function(o){var i=o.length,a=i,d=Ee.prototype.thru;for(t&&o.reverse();a--;){var p=o[a];if(typeof p!="function")throw new Ce(h);if(d&&!m&&ni(p)=="wrapper")var m=new Ee([],!0)}for(a=m?a:i;++a<i;){p=o[a];var b=ni(p),k=b=="wrapper"?wr(p):n;k&&Er(k[0])&&k[1]==($|Ot|Y|y)&&!k[4].length&&k[9]==1?m=m[ni(k[0])].apply(m,k[3]):m=p.length==1&&Er(p)?m[b]():m.thru(p)}return function(){var B=arguments,L=B[0];if(m&&B.length==1&&at(L))return m.plant(L).value();for(var M=0,H=i?o[M].apply(this,B):L;++M<i;)H=o[M].call(this,H);return H}})}function Jo(t,o,i,a,d,p,m,b,k,B){var L=o&$,M=o&P,H=o&it,q=o&(Ot|G),tt=o&S,ct=H?n:ho(t);function et(){for(var pt=arguments.length,mt=x(pt),be=pt;be--;)mt[be]=arguments[be];if(q)var ee=Un(et),ve=Jd(mt,ee);if(a&&(mt=Pa(mt,a,d,q)),p&&(mt=Ha(mt,p,m,q)),pt-=ve,q&&pt<B){var Ft=rn(mt,ee);return qa(t,o,Jo,et.placeholder,i,mt,Ft,b,k,B-pt)}var Re=M?i:this,Xe=H?Re[t]:t;return pt=mt.length,b?mt=sp(mt,b):tt&&pt>1&&mt.reverse(),L&&k<pt&&(mt.length=k),this&&this!==Kt&&this instanceof et&&(Xe=ct||ho(Xe)),Xe.apply(Re,mt)}return et}function Ya(t,o){return function(i,a){return fu(i,t,o(a),{})}}function Qo(t,o){return function(i,a){var d;if(i===n&&a===n)return o;if(i!==n&&(d=i),a!==n){if(d===n)return a;typeof i=="string"||typeof a=="string"?(i=ge(i),a=ge(a)):(i=La(i),a=La(a)),d=t(i,a)}return d}}function mr(t){return Ke(function(o){return o=Rt(o,fe(J())),dt(function(i){var a=this;return t(o,function(d){return pe(d,a,i)})})})}function ti(t,o){o=o===n?" ":ge(o);var i=o.length;if(i<2)return i?cr(o,t):o;var a=cr(o,Uo(t/Mn(o)));return An(o)?dn(Ae(a),0,t).join(""):a.slice(0,t)}function zu(t,o,i,a){var d=o&P,p=ho(t);function m(){for(var b=-1,k=arguments.length,B=-1,L=a.length,M=x(L+k),H=this&&this!==Kt&&this instanceof m?p:t;++B<L;)M[B]=a[B];for(;k--;)M[B++]=arguments[++b];return pe(H,d?i:this,M)}return m}function Ka(t){return function(o,i,a){return a&&typeof a!="number"&&te(o,i,a)&&(i=a=n),o=je(o),i===n?(i=o,o=0):i=je(i),a=a===n?o<i?1:-1:je(a),Tu(o,i,a,t)}}function ei(t){return function(o,i){return typeof o=="string"&&typeof i=="string"||(o=Be(o),i=Be(i)),t(o,i)}}function qa(t,o,i,a,d,p,m,b,k,B){var L=o&Ot,M=L?m:n,H=L?n:m,q=L?p:n,tt=L?n:p;o|=L?Y:Z,o&=~(L?Z:Y),o&kt||(o&=~(P|it));var ct=[t,o,d,q,M,tt,H,b,k,B],et=i.apply(n,ct);return Er(t)&&il(et,ct),et.placeholder=a,rl(et,t,o)}function br(t){var o=zt[t];return function(i,a){if(i=Be(i),a=a==null?0:Zt(lt(a),292),a&&ra(i)){var d=(Ct(i)+"e").split("e"),p=o(d[0]+"e"+(+d[1]+a));return d=(Ct(p)+"e").split("e"),+(d[0]+"e"+(+d[1]-a))}return o(i)}}var Wu=Nn&&1/Io(new Nn([,-0]))[1]==ht?function(t){return new Nn(t)}:Fr;function Ga(t){return function(o){var i=Vt(o);return i==Dt?Gi(o):i==Ie?rh(o):Vd(o,t(o))}}function Ye(t,o,i,a,d,p,m,b){var k=o&it;if(!k&&typeof t!="function")throw new Ce(h);var B=a?a.length:0;if(B||(o&=~(Y|Z),a=d=n),m=m===n?m:Wt(lt(m),0),b=b===n?b:lt(b),B-=d?d.length:0,o&Z){var L=a,M=d;a=d=n}var H=k?n:wr(t),q=[t,o,i,a,d,L,M,p,m,b];if(H&&op(q,H),t=q[0],o=q[1],i=q[2],a=q[3],d=q[4],b=q[9]=q[9]===n?k?0:t.length:Wt(q[9]-B,0),!b&&o&(Ot|G)&&(o&=~(Ot|G)),!o||o==P)var tt=Fu(t,o,i);else o==Ot||o==G?tt=Uu(t,o,b):(o==Y||o==(P|Y))&&!d.length?tt=zu(t,o,i,a):tt=Jo.apply(n,q);var ct=H?_a:il;return rl(ct(tt,q),t,o)}function ja(t,o,i,a){return t===n||Oe(t,Rn[i])&&!Et.call(a,i)?o:t}function Xa(t,o,i,a,d,p){return Nt(t)&&Nt(o)&&(p.set(o,t),jo(t,o,n,Xa,p),p.delete(o)),t}function $u(t){return fo(t)?n:t}function Za(t,o,i,a,d,p){var m=i&T,b=t.length,k=o.length;if(b!=k&&!(m&&k>b))return!1;var B=p.get(t),L=p.get(o);if(B&&L)return B==o&&L==t;var M=-1,H=!0,q=i&F?new kn:n;for(p.set(t,o),p.set(o,t);++M<b;){var tt=t[M],ct=o[M];if(a)var et=m?a(ct,tt,M,o,t,p):a(tt,ct,M,t,o,p);if(et!==n){if(et)continue;H=!1;break}if(q){if(!zi(o,function(pt,mt){if(!Qn(q,mt)&&(tt===pt||d(tt,pt,i,a,p)))return q.push(mt)})){H=!1;break}}else if(!(tt===ct||d(tt,ct,i,a,p))){H=!1;break}}return p.delete(t),p.delete(o),H}function Yu(t,o,i,a,d,p,m){switch(i){case Bn:if(t.byteLength!=o.byteLength||t.byteOffset!=o.byteOffset)return!1;t=t.buffer,o=o.buffer;case Jn:return!(t.byteLength!=o.byteLength||!p(new Do(t),new Do(o)));case _t:case Lt:case tn:return Oe(+t,+o);case ie:return t.name==o.name&&t.message==o.message;case Xn:case Zn:return t==o+"";case Dt:var b=Gi;case Ie:var k=a&T;if(b||(b=Io),t.size!=o.size&&!k)return!1;var B=m.get(t);if(B)return B==o;a|=F,m.set(t,o);var L=Za(b(t),b(o),a,d,p,m);return m.delete(t),L;case Eo:if(io)return io.call(t)==io.call(o)}return!1}function Ku(t,o,i,a,d,p){var m=i&T,b=vr(t),k=b.length,B=vr(o),L=B.length;if(k!=L&&!m)return!1;for(var M=k;M--;){var H=b[M];if(!(m?H in o:Et.call(o,H)))return!1}var q=p.get(t),tt=p.get(o);if(q&&tt)return q==o&&tt==t;var ct=!0;p.set(t,o),p.set(o,t);for(var et=m;++M<k;){H=b[M];var pt=t[H],mt=o[H];if(a)var be=m?a(mt,pt,H,o,t,p):a(pt,mt,H,t,o,p);if(!(be===n?pt===mt||d(pt,mt,i,a,p):be)){ct=!1;break}et||(et=H=="constructor")}if(ct&&!et){var ee=t.constructor,ve=o.constructor;ee!=ve&&"constructor"in t&&"constructor"in o&&!(typeof ee=="function"&&ee instanceof ee&&typeof ve=="function"&&ve instanceof ve)&&(ct=!1)}return p.delete(t),p.delete(o),ct}function Ke(t){return Tr(nl(t,n,hl),t+"")}function vr(t){return ma(t,Yt,yr)}function kr(t){return ma(t,ae,Va)}var wr=Wo?function(t){return Wo.get(t)}:Fr;function ni(t){for(var o=t.name+"",i=Dn[o],a=Et.call(Dn,o)?i.length:0;a--;){var d=i[a],p=d.func;if(p==null||p==t)return d.name}return o}function Un(t){var o=Et.call(u,"placeholder")?u:t;return o.placeholder}function J(){var t=u.iteratee||Pr;return t=t===Pr?ka:t,arguments.length?t(arguments[0],arguments[1]):t}function oi(t,o){var i=t.__data__;return Qu(o)?i[typeof o=="string"?"string":"hash"]:i.map}function xr(t){for(var o=Yt(t),i=o.length;i--;){var a=o[i],d=t[a];o[i]=[a,d,tl(d)]}return o}function yn(t,o){var i=nh(t,o);return va(i)?i:n}function qu(t){var o=Et.call(t,bn),i=t[bn];try{t[bn]=n;var a=!0}catch{}var d=Ro.call(t);return a&&(o?t[bn]=i:delete t[bn]),d}var yr=Xi?function(t){return t==null?[]:(t=Bt(t),nn(Xi(t),function(o){return oa.call(t,o)}))}:Ur,Va=Xi?function(t){for(var o=[];t;)on(o,yr(t)),t=Po(t);return o}:Ur,Vt=Qt;(Zi&&Vt(new Zi(new ArrayBuffer(1)))!=Bn||eo&&Vt(new eo)!=Dt||Vi&&Vt(Vi.resolve())!=en||Nn&&Vt(new Nn)!=Ie||no&&Vt(new no)!=Vn)&&(Vt=function(t){var o=Qt(t),i=o==ue?t.constructor:n,a=i?Cn(i):"";if(a)switch(a){case Bh:return Bn;case Lh:return Dt;case Ih:return en;case Ah:return Ie;case Mh:return Vn}return o});function Gu(t,o,i){for(var a=-1,d=i.length;++a<d;){var p=i[a],m=p.size;switch(p.type){case"drop":t+=m;break;case"dropRight":o-=m;break;case"take":o=Zt(o,t+m);break;case"takeRight":t=Wt(t,o-m);break}}return{start:t,end:o}}function ju(t){var o=t.match(td);return o?o[1].split(ed):[]}function Ja(t,o,i){o=cn(o,t);for(var a=-1,d=o.length,p=!1;++a<d;){var m=Ue(o[a]);if(!(p=t!=null&&i(t,m)))break;t=t[m]}return p||++a!=d?p:(d=t==null?0:t.length,!!d&&di(d)&&qe(m,d)&&(at(t)||En(t)))}function Xu(t){var o=t.length,i=new t.constructor(o);return o&&typeof t[0]=="string"&&Et.call(t,"index")&&(i.index=t.index,i.input=t.input),i}function Qa(t){return typeof t.constructor=="function"&&!uo(t)?Pn(Po(t)):{}}function Zu(t,o,i){var a=t.constructor;switch(o){case Jn:return gr(t);case _t:case Lt:return new a(+t);case Bn:return Ou(t,i);case xi:case yi:case Ci:case Ei:case Si:case Ti:case _i:case Bi:case Li:return Na(t,i);case Dt:return new a;case tn:case Zn:return new a(t);case Xn:return Ru(t);case Ie:return new a;case Eo:return Nu(t)}}function Vu(t,o){var i=o.length;if(!i)return t;var a=i-1;return o[a]=(i>1?"& ":"")+o[a],o=o.join(i>2?", ":" "),t.replace(Qc,`{
/* [wrapped with `+o+`] */
`)}function Ju(t){return at(t)||En(t)||!!(ia&&t&&t[ia])}function qe(t,o){var i=typeof t;return o=o??Tt,!!o&&(i=="number"||i!="symbol"&&dd.test(t))&&t>-1&&t%1==0&&t<o}function te(t,o,i){if(!Nt(i))return!1;var a=typeof o;return(a=="number"?se(i)&&qe(o,i.length):a=="string"&&o in i)?Oe(i[o],t):!1}function Cr(t,o){if(at(t))return!1;var i=typeof t;return i=="number"||i=="symbol"||i=="boolean"||t==null||me(t)?!0:Xc.test(t)||!jc.test(t)||o!=null&&t in Bt(o)}function Qu(t){var o=typeof t;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?t!=="__proto__":t===null}function Er(t){var o=ni(t),i=u[o];if(typeof i!="function"||!(o in gt.prototype))return!1;if(t===i)return!0;var a=wr(i);return!!a&&t===a[0]}function tp(t){return!!ta&&ta in t}var ep=Mo?Ge:zr;function uo(t){var o=t&&t.constructor,i=typeof o=="function"&&o.prototype||Rn;return t===i}function tl(t){return t===t&&!Nt(t)}function el(t,o){return function(i){return i==null?!1:i[t]===o&&(o!==n||t in Bt(i))}}function np(t){var o=li(t,function(a){return i.size===w&&i.clear(),a}),i=o.cache;return o}function op(t,o){var i=t[1],a=o[1],d=i|a,p=d<(P|it|$),m=a==$&&i==Ot||a==$&&i==y&&t[7].length<=o[8]||a==($|y)&&o[7].length<=o[8]&&i==Ot;if(!(p||m))return t;a&P&&(t[2]=o[2],d|=i&P?0:kt);var b=o[3];if(b){var k=t[3];t[3]=k?Pa(k,b,o[4]):b,t[4]=k?rn(t[3],I):o[4]}return b=o[5],b&&(k=t[5],t[5]=k?Ha(k,b,o[6]):b,t[6]=k?rn(t[5],I):o[6]),b=o[7],b&&(t[7]=b),a&$&&(t[8]=t[8]==null?o[8]:Zt(t[8],o[8])),t[9]==null&&(t[9]=o[9]),t[0]=o[0],t[1]=d,t}function ip(t){var o=[];if(t!=null)for(var i in Bt(t))o.push(i);return o}function rp(t){return Ro.call(t)}function nl(t,o,i){return o=Wt(o===n?t.length-1:o,0),function(){for(var a=arguments,d=-1,p=Wt(a.length-o,0),m=x(p);++d<p;)m[d]=a[o+d];d=-1;for(var b=x(o+1);++d<o;)b[d]=a[d];return b[o]=i(m),pe(t,this,b)}}function ol(t,o){return o.length<2?t:xn(t,Te(o,0,-1))}function sp(t,o){for(var i=t.length,a=Zt(o.length,i),d=re(t);a--;){var p=o[a];t[a]=qe(p,i)?d[p]:n}return t}function Sr(t,o){if(!(o==="constructor"&&typeof t[o]=="function")&&o!="__proto__")return t[o]}var il=sl(_a),po=xh||function(t,o){return Kt.setTimeout(t,o)},Tr=sl(Lu);function rl(t,o,i){var a=o+"";return Tr(t,Vu(a,ap(ju(a),i)))}function sl(t){var o=0,i=0;return function(){var a=Sh(),d=V-(a-i);if(i=a,d>0){if(++o>=z)return arguments[0]}else o=0;return t.apply(n,arguments)}}function ii(t,o){var i=-1,a=t.length,d=a-1;for(o=o===n?a:o;++i<o;){var p=lr(i,d),m=t[p];t[p]=t[i],t[i]=m}return t.length=o,t}var al=np(function(t){var o=[];return t.charCodeAt(0)===46&&o.push(""),t.replace(Zc,function(i,a,d,p){o.push(d?p.replace(id,"$1"):a||i)}),o});function Ue(t){if(typeof t=="string"||me(t))return t;var o=t+"";return o=="0"&&1/t==-ht?"-0":o}function Cn(t){if(t!=null){try{return Oo.call(t)}catch{}try{return t+""}catch{}}return""}function ap(t,o){return ye(O,function(i){var a="_."+i[0];o&i[1]&&!Bo(t,a)&&t.push(a)}),t.sort()}function ll(t){if(t instanceof gt)return t.clone();var o=new Ee(t.__wrapped__,t.__chain__);return o.__actions__=re(t.__actions__),o.__index__=t.__index__,o.__values__=t.__values__,o}function lp(t,o,i){(i?te(t,o,i):o===n)?o=1:o=Wt(lt(o),0);var a=t==null?0:t.length;if(!a||o<1)return[];for(var d=0,p=0,m=x(Uo(a/o));d<a;)m[p++]=Te(t,d,d+=o);return m}function cp(t){for(var o=-1,i=t==null?0:t.length,a=0,d=[];++o<i;){var p=t[o];p&&(d[a++]=p)}return d}function dp(){var t=arguments.length;if(!t)return[];for(var o=x(t-1),i=arguments[0],a=t;a--;)o[a-1]=arguments[a];return on(at(i)?re(i):[i],qt(o,1))}var hp=dt(function(t,o){return Ht(t)?so(t,qt(o,1,Ht,!0)):[]}),up=dt(function(t,o){var i=_e(o);return Ht(i)&&(i=n),Ht(t)?so(t,qt(o,1,Ht,!0),J(i,2)):[]}),pp=dt(function(t,o){var i=_e(o);return Ht(i)&&(i=n),Ht(t)?so(t,qt(o,1,Ht,!0),n,i):[]});function fp(t,o,i){var a=t==null?0:t.length;return a?(o=i||o===n?1:lt(o),Te(t,o<0?0:o,a)):[]}function gp(t,o,i){var a=t==null?0:t.length;return a?(o=i||o===n?1:lt(o),o=a-o,Te(t,0,o<0?0:o)):[]}function mp(t,o){return t&&t.length?Zo(t,J(o,3),!0,!0):[]}function bp(t,o){return t&&t.length?Zo(t,J(o,3),!0):[]}function vp(t,o,i,a){var d=t==null?0:t.length;return d?(i&&typeof i!="number"&&te(t,o,i)&&(i=0,a=d),du(t,o,i,a)):[]}function cl(t,o,i){var a=t==null?0:t.length;if(!a)return-1;var d=i==null?0:lt(i);return d<0&&(d=Wt(a+d,0)),Lo(t,J(o,3),d)}function dl(t,o,i){var a=t==null?0:t.length;if(!a)return-1;var d=a-1;return i!==n&&(d=lt(i),d=i<0?Wt(a+d,0):Zt(d,a-1)),Lo(t,J(o,3),d,!0)}function hl(t){var o=t==null?0:t.length;return o?qt(t,1):[]}function kp(t){var o=t==null?0:t.length;return o?qt(t,ht):[]}function wp(t,o){var i=t==null?0:t.length;return i?(o=o===n?1:lt(o),qt(t,o)):[]}function xp(t){for(var o=-1,i=t==null?0:t.length,a={};++o<i;){var d=t[o];a[d[0]]=d[1]}return a}function ul(t){return t&&t.length?t[0]:n}function yp(t,o,i){var a=t==null?0:t.length;if(!a)return-1;var d=i==null?0:lt(i);return d<0&&(d=Wt(a+d,0)),In(t,o,d)}function Cp(t){var o=t==null?0:t.length;return o?Te(t,0,-1):[]}var Ep=dt(function(t){var o=Rt(t,pr);return o.length&&o[0]===t[0]?or(o):[]}),Sp=dt(function(t){var o=_e(t),i=Rt(t,pr);return o===_e(i)?o=n:i.pop(),i.length&&i[0]===t[0]?or(i,J(o,2)):[]}),Tp=dt(function(t){var o=_e(t),i=Rt(t,pr);return o=typeof o=="function"?o:n,o&&i.pop(),i.length&&i[0]===t[0]?or(i,n,o):[]});function _p(t,o){return t==null?"":Ch.call(t,o)}function _e(t){var o=t==null?0:t.length;return o?t[o-1]:n}function Bp(t,o,i){var a=t==null?0:t.length;if(!a)return-1;var d=a;return i!==n&&(d=lt(i),d=d<0?Wt(a+d,0):Zt(d,a-1)),o===o?ah(t,o,d):Lo(t,qs,d,!0)}function Lp(t,o){return t&&t.length?Ca(t,lt(o)):n}var Ip=dt(pl);function pl(t,o){return t&&t.length&&o&&o.length?ar(t,o):t}function Ap(t,o,i){return t&&t.length&&o&&o.length?ar(t,o,J(i,2)):t}function Mp(t,o,i){return t&&t.length&&o&&o.length?ar(t,o,n,i):t}var Op=Ke(function(t,o){var i=t==null?0:t.length,a=Qi(t,o);return Ta(t,Rt(o,function(d){return qe(d,i)?+d:d}).sort(Da)),a});function Rp(t,o){var i=[];if(!(t&&t.length))return i;var a=-1,d=[],p=t.length;for(o=J(o,3);++a<p;){var m=t[a];o(m,a,t)&&(i.push(m),d.push(a))}return Ta(t,d),i}function _r(t){return t==null?t:_h.call(t)}function Np(t,o,i){var a=t==null?0:t.length;return a?(i&&typeof i!="number"&&te(t,o,i)?(o=0,i=a):(o=o==null?0:lt(o),i=i===n?a:lt(i)),Te(t,o,i)):[]}function Dp(t,o){return Xo(t,o)}function Pp(t,o,i){return dr(t,o,J(i,2))}function Hp(t,o){var i=t==null?0:t.length;if(i){var a=Xo(t,o);if(a<i&&Oe(t[a],o))return a}return-1}function Fp(t,o){return Xo(t,o,!0)}function Up(t,o,i){return dr(t,o,J(i,2),!0)}function zp(t,o){var i=t==null?0:t.length;if(i){var a=Xo(t,o,!0)-1;if(Oe(t[a],o))return a}return-1}function Wp(t){return t&&t.length?Ba(t):[]}function $p(t,o){return t&&t.length?Ba(t,J(o,2)):[]}function Yp(t){var o=t==null?0:t.length;return o?Te(t,1,o):[]}function Kp(t,o,i){return t&&t.length?(o=i||o===n?1:lt(o),Te(t,0,o<0?0:o)):[]}function qp(t,o,i){var a=t==null?0:t.length;return a?(o=i||o===n?1:lt(o),o=a-o,Te(t,o<0?0:o,a)):[]}function Gp(t,o){return t&&t.length?Zo(t,J(o,3),!1,!0):[]}function jp(t,o){return t&&t.length?Zo(t,J(o,3)):[]}var Xp=dt(function(t){return ln(qt(t,1,Ht,!0))}),Zp=dt(function(t){var o=_e(t);return Ht(o)&&(o=n),ln(qt(t,1,Ht,!0),J(o,2))}),Vp=dt(function(t){var o=_e(t);return o=typeof o=="function"?o:n,ln(qt(t,1,Ht,!0),n,o)});function Jp(t){return t&&t.length?ln(t):[]}function Qp(t,o){return t&&t.length?ln(t,J(o,2)):[]}function tf(t,o){return o=typeof o=="function"?o:n,t&&t.length?ln(t,n,o):[]}function Br(t){if(!(t&&t.length))return[];var o=0;return t=nn(t,function(i){if(Ht(i))return o=Wt(i.length,o),!0}),Ki(o,function(i){return Rt(t,Wi(i))})}function fl(t,o){if(!(t&&t.length))return[];var i=Br(t);return o==null?i:Rt(i,function(a){return pe(o,n,a)})}var ef=dt(function(t,o){return Ht(t)?so(t,o):[]}),nf=dt(function(t){return ur(nn(t,Ht))}),of=dt(function(t){var o=_e(t);return Ht(o)&&(o=n),ur(nn(t,Ht),J(o,2))}),rf=dt(function(t){var o=_e(t);return o=typeof o=="function"?o:n,ur(nn(t,Ht),n,o)}),sf=dt(Br);function af(t,o){return Ma(t||[],o||[],ro)}function lf(t,o){return Ma(t||[],o||[],co)}var cf=dt(function(t){var o=t.length,i=o>1?t[o-1]:n;return i=typeof i=="function"?(t.pop(),i):n,fl(t,i)});function gl(t){var o=u(t);return o.__chain__=!0,o}function df(t,o){return o(t),t}function ri(t,o){return o(t)}var hf=Ke(function(t){var o=t.length,i=o?t[0]:0,a=this.__wrapped__,d=function(p){return Qi(p,t)};return o>1||this.__actions__.length||!(a instanceof gt)||!qe(i)?this.thru(d):(a=a.slice(i,+i+(o?1:0)),a.__actions__.push({func:ri,args:[d],thisArg:n}),new Ee(a,this.__chain__).thru(function(p){return o&&!p.length&&p.push(n),p}))});function uf(){return gl(this)}function pf(){return new Ee(this.value(),this.__chain__)}function ff(){this.__values__===n&&(this.__values__=Ll(this.value()));var t=this.__index__>=this.__values__.length,o=t?n:this.__values__[this.__index__++];return{done:t,value:o}}function gf(){return this}function mf(t){for(var o,i=this;i instanceof Yo;){var a=ll(i);a.__index__=0,a.__values__=n,o?d.__wrapped__=a:o=a;var d=a;i=i.__wrapped__}return d.__wrapped__=t,o}function bf(){var t=this.__wrapped__;if(t instanceof gt){var o=t;return this.__actions__.length&&(o=new gt(this)),o=o.reverse(),o.__actions__.push({func:ri,args:[_r],thisArg:n}),new Ee(o,this.__chain__)}return this.thru(_r)}function vf(){return Aa(this.__wrapped__,this.__actions__)}var kf=Vo(function(t,o,i){Et.call(t,i)?++t[i]:$e(t,i,1)});function wf(t,o,i){var a=at(t)?Ys:cu;return i&&te(t,o,i)&&(o=n),a(t,J(o,3))}function xf(t,o){var i=at(t)?nn:fa;return i(t,J(o,3))}var yf=Wa(cl),Cf=Wa(dl);function Ef(t,o){return qt(si(t,o),1)}function Sf(t,o){return qt(si(t,o),ht)}function Tf(t,o,i){return i=i===n?1:lt(i),qt(si(t,o),i)}function ml(t,o){var i=at(t)?ye:an;return i(t,J(o,3))}function bl(t,o){var i=at(t)?Yd:pa;return i(t,J(o,3))}var _f=Vo(function(t,o,i){Et.call(t,i)?t[i].push(o):$e(t,i,[o])});function Bf(t,o,i,a){t=se(t)?t:Wn(t),i=i&&!a?lt(i):0;var d=t.length;return i<0&&(i=Wt(d+i,0)),hi(t)?i<=d&&t.indexOf(o,i)>-1:!!d&&In(t,o,i)>-1}var Lf=dt(function(t,o,i){var a=-1,d=typeof o=="function",p=se(t)?x(t.length):[];return an(t,function(m){p[++a]=d?pe(o,m,i):ao(m,o,i)}),p}),If=Vo(function(t,o,i){$e(t,i,o)});function si(t,o){var i=at(t)?Rt:wa;return i(t,J(o,3))}function Af(t,o,i,a){return t==null?[]:(at(o)||(o=o==null?[]:[o]),i=a?n:i,at(i)||(i=i==null?[]:[i]),Ea(t,o,i))}var Mf=Vo(function(t,o,i){t[i?0:1].push(o)},function(){return[[],[]]});function Of(t,o,i){var a=at(t)?Ui:js,d=arguments.length<3;return a(t,J(o,4),i,d,an)}function Rf(t,o,i){var a=at(t)?Kd:js,d=arguments.length<3;return a(t,J(o,4),i,d,pa)}function Nf(t,o){var i=at(t)?nn:fa;return i(t,ci(J(o,3)))}function Df(t){var o=at(t)?ca:_u;return o(t)}function Pf(t,o,i){(i?te(t,o,i):o===n)?o=1:o=lt(o);var a=at(t)?iu:Bu;return a(t,o)}function Hf(t){var o=at(t)?ru:Iu;return o(t)}function Ff(t){if(t==null)return 0;if(se(t))return hi(t)?Mn(t):t.length;var o=Vt(t);return o==Dt||o==Ie?t.size:rr(t).length}function Uf(t,o,i){var a=at(t)?zi:Au;return i&&te(t,o,i)&&(o=n),a(t,J(o,3))}var zf=dt(function(t,o){if(t==null)return[];var i=o.length;return i>1&&te(t,o[0],o[1])?o=[]:i>2&&te(o[0],o[1],o[2])&&(o=[o[0]]),Ea(t,qt(o,1),[])}),ai=wh||function(){return Kt.Date.now()};function Wf(t,o){if(typeof o!="function")throw new Ce(h);return t=lt(t),function(){if(--t<1)return o.apply(this,arguments)}}function vl(t,o,i){return o=i?n:o,o=t&&o==null?t.length:o,Ye(t,$,n,n,n,n,o)}function kl(t,o){var i;if(typeof o!="function")throw new Ce(h);return t=lt(t),function(){return--t>0&&(i=o.apply(this,arguments)),t<=1&&(o=n),i}}var Lr=dt(function(t,o,i){var a=P;if(i.length){var d=rn(i,Un(Lr));a|=Y}return Ye(t,a,o,i,d)}),wl=dt(function(t,o,i){var a=P|it;if(i.length){var d=rn(i,Un(wl));a|=Y}return Ye(o,a,t,i,d)});function xl(t,o,i){o=i?n:o;var a=Ye(t,Ot,n,n,n,n,n,o);return a.placeholder=xl.placeholder,a}function yl(t,o,i){o=i?n:o;var a=Ye(t,G,n,n,n,n,n,o);return a.placeholder=yl.placeholder,a}function Cl(t,o,i){var a,d,p,m,b,k,B=0,L=!1,M=!1,H=!0;if(typeof t!="function")throw new Ce(h);o=Be(o)||0,Nt(i)&&(L=!!i.leading,M="maxWait"in i,p=M?Wt(Be(i.maxWait)||0,o):p,H="trailing"in i?!!i.trailing:H);function q(Ft){var Re=a,Xe=d;return a=d=n,B=Ft,m=t.apply(Xe,Re),m}function tt(Ft){return B=Ft,b=po(pt,o),L?q(Ft):m}function ct(Ft){var Re=Ft-k,Xe=Ft-B,Wl=o-Re;return M?Zt(Wl,p-Xe):Wl}function et(Ft){var Re=Ft-k,Xe=Ft-B;return k===n||Re>=o||Re<0||M&&Xe>=p}function pt(){var Ft=ai();if(et(Ft))return mt(Ft);b=po(pt,ct(Ft))}function mt(Ft){return b=n,H&&a?q(Ft):(a=d=n,m)}function be(){b!==n&&Oa(b),B=0,a=k=d=b=n}function ee(){return b===n?m:mt(ai())}function ve(){var Ft=ai(),Re=et(Ft);if(a=arguments,d=this,k=Ft,Re){if(b===n)return tt(k);if(M)return Oa(b),b=po(pt,o),q(k)}return b===n&&(b=po(pt,o)),m}return ve.cancel=be,ve.flush=ee,ve}var $f=dt(function(t,o){return ua(t,1,o)}),Yf=dt(function(t,o,i){return ua(t,Be(o)||0,i)});function Kf(t){return Ye(t,S)}function li(t,o){if(typeof t!="function"||o!=null&&typeof o!="function")throw new Ce(h);var i=function(){var a=arguments,d=o?o.apply(this,a):a[0],p=i.cache;if(p.has(d))return p.get(d);var m=t.apply(this,a);return i.cache=p.set(d,m)||p,m};return i.cache=new(li.Cache||We),i}li.Cache=We;function ci(t){if(typeof t!="function")throw new Ce(h);return function(){var o=arguments;switch(o.length){case 0:return!t.call(this);case 1:return!t.call(this,o[0]);case 2:return!t.call(this,o[0],o[1]);case 3:return!t.call(this,o[0],o[1],o[2])}return!t.apply(this,o)}}function qf(t){return kl(2,t)}var Gf=Mu(function(t,o){o=o.length==1&&at(o[0])?Rt(o[0],fe(J())):Rt(qt(o,1),fe(J()));var i=o.length;return dt(function(a){for(var d=-1,p=Zt(a.length,i);++d<p;)a[d]=o[d].call(this,a[d]);return pe(t,this,a)})}),Ir=dt(function(t,o){var i=rn(o,Un(Ir));return Ye(t,Y,n,o,i)}),El=dt(function(t,o){var i=rn(o,Un(El));return Ye(t,Z,n,o,i)}),jf=Ke(function(t,o){return Ye(t,y,n,n,n,o)});function Xf(t,o){if(typeof t!="function")throw new Ce(h);return o=o===n?o:lt(o),dt(t,o)}function Zf(t,o){if(typeof t!="function")throw new Ce(h);return o=o==null?0:Wt(lt(o),0),dt(function(i){var a=i[o],d=dn(i,0,o);return a&&on(d,a),pe(t,this,d)})}function Vf(t,o,i){var a=!0,d=!0;if(typeof t!="function")throw new Ce(h);return Nt(i)&&(a="leading"in i?!!i.leading:a,d="trailing"in i?!!i.trailing:d),Cl(t,o,{leading:a,maxWait:o,trailing:d})}function Jf(t){return vl(t,1)}function Qf(t,o){return Ir(fr(o),t)}function tg(){if(!arguments.length)return[];var t=arguments[0];return at(t)?t:[t]}function eg(t){return Se(t,U)}function ng(t,o){return o=typeof o=="function"?o:n,Se(t,U,o)}function og(t){return Se(t,E|U)}function ig(t,o){return o=typeof o=="function"?o:n,Se(t,E|U,o)}function rg(t,o){return o==null||ha(t,o,Yt(o))}function Oe(t,o){return t===o||t!==t&&o!==o}var sg=ei(nr),ag=ei(function(t,o){return t>=o}),En=ba(function(){return arguments}())?ba:function(t){return Pt(t)&&Et.call(t,"callee")&&!oa.call(t,"callee")},at=x.isArray,lg=Hs?fe(Hs):gu;function se(t){return t!=null&&di(t.length)&&!Ge(t)}function Ht(t){return Pt(t)&&se(t)}function cg(t){return t===!0||t===!1||Pt(t)&&Qt(t)==_t}var hn=yh||zr,dg=Fs?fe(Fs):mu;function hg(t){return Pt(t)&&t.nodeType===1&&!fo(t)}function ug(t){if(t==null)return!0;if(se(t)&&(at(t)||typeof t=="string"||typeof t.splice=="function"||hn(t)||zn(t)||En(t)))return!t.length;var o=Vt(t);if(o==Dt||o==Ie)return!t.size;if(uo(t))return!rr(t).length;for(var i in t)if(Et.call(t,i))return!1;return!0}function pg(t,o){return lo(t,o)}function fg(t,o,i){i=typeof i=="function"?i:n;var a=i?i(t,o):n;return a===n?lo(t,o,n,i):!!a}function Ar(t){if(!Pt(t))return!1;var o=Qt(t);return o==ie||o==he||typeof t.message=="string"&&typeof t.name=="string"&&!fo(t)}function gg(t){return typeof t=="number"&&ra(t)}function Ge(t){if(!Nt(t))return!1;var o=Qt(t);return o==vt||o==Xt||o==X||o==Hc}function Sl(t){return typeof t=="number"&&t==lt(t)}function di(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Tt}function Nt(t){var o=typeof t;return t!=null&&(o=="object"||o=="function")}function Pt(t){return t!=null&&typeof t=="object"}var Tl=Us?fe(Us):vu;function mg(t,o){return t===o||ir(t,o,xr(o))}function bg(t,o,i){return i=typeof i=="function"?i:n,ir(t,o,xr(o),i)}function vg(t){return _l(t)&&t!=+t}function kg(t){if(ep(t))throw new st(c);return va(t)}function wg(t){return t===null}function xg(t){return t==null}function _l(t){return typeof t=="number"||Pt(t)&&Qt(t)==tn}function fo(t){if(!Pt(t)||Qt(t)!=ue)return!1;var o=Po(t);if(o===null)return!0;var i=Et.call(o,"constructor")&&o.constructor;return typeof i=="function"&&i instanceof i&&Oo.call(i)==mh}var Mr=zs?fe(zs):ku;function yg(t){return Sl(t)&&t>=-Tt&&t<=Tt}var Bl=Ws?fe(Ws):wu;function hi(t){return typeof t=="string"||!at(t)&&Pt(t)&&Qt(t)==Zn}function me(t){return typeof t=="symbol"||Pt(t)&&Qt(t)==Eo}var zn=$s?fe($s):xu;function Cg(t){return t===n}function Eg(t){return Pt(t)&&Vt(t)==Vn}function Sg(t){return Pt(t)&&Qt(t)==Uc}var Tg=ei(sr),_g=ei(function(t,o){return t<=o});function Ll(t){if(!t)return[];if(se(t))return hi(t)?Ae(t):re(t);if(to&&t[to])return ih(t[to]());var o=Vt(t),i=o==Dt?Gi:o==Ie?Io:Wn;return i(t)}function je(t){if(!t)return t===0?t:0;if(t=Be(t),t===ht||t===-ht){var o=t<0?-1:1;return o*Ut}return t===t?t:0}function lt(t){var o=je(t),i=o%1;return o===o?i?o-i:o:0}function Il(t){return t?wn(lt(t),0,ut):0}function Be(t){if(typeof t=="number")return t;if(me(t))return ft;if(Nt(t)){var o=typeof t.valueOf=="function"?t.valueOf():t;t=Nt(o)?o+"":o}if(typeof t!="string")return t===0?t:+t;t=Xs(t);var i=ad.test(t);return i||cd.test(t)?zd(t.slice(2),i?2:8):sd.test(t)?ft:+t}function Al(t){return Fe(t,ae(t))}function Bg(t){return t?wn(lt(t),-Tt,Tt):t===0?t:0}function Ct(t){return t==null?"":ge(t)}var Lg=Hn(function(t,o){if(uo(o)||se(o)){Fe(o,Yt(o),t);return}for(var i in o)Et.call(o,i)&&ro(t,i,o[i])}),Ml=Hn(function(t,o){Fe(o,ae(o),t)}),ui=Hn(function(t,o,i,a){Fe(o,ae(o),t,a)}),Ig=Hn(function(t,o,i,a){Fe(o,Yt(o),t,a)}),Ag=Ke(Qi);function Mg(t,o){var i=Pn(t);return o==null?i:da(i,o)}var Og=dt(function(t,o){t=Bt(t);var i=-1,a=o.length,d=a>2?o[2]:n;for(d&&te(o[0],o[1],d)&&(a=1);++i<a;)for(var p=o[i],m=ae(p),b=-1,k=m.length;++b<k;){var B=m[b],L=t[B];(L===n||Oe(L,Rn[B])&&!Et.call(t,B))&&(t[B]=p[B])}return t}),Rg=dt(function(t){return t.push(n,Xa),pe(Ol,n,t)});function Ng(t,o){return Ks(t,J(o,3),He)}function Dg(t,o){return Ks(t,J(o,3),er)}function Pg(t,o){return t==null?t:tr(t,J(o,3),ae)}function Hg(t,o){return t==null?t:ga(t,J(o,3),ae)}function Fg(t,o){return t&&He(t,J(o,3))}function Ug(t,o){return t&&er(t,J(o,3))}function zg(t){return t==null?[]:Go(t,Yt(t))}function Wg(t){return t==null?[]:Go(t,ae(t))}function Or(t,o,i){var a=t==null?n:xn(t,o);return a===n?i:a}function $g(t,o){return t!=null&&Ja(t,o,hu)}function Rr(t,o){return t!=null&&Ja(t,o,uu)}var Yg=Ya(function(t,o,i){o!=null&&typeof o.toString!="function"&&(o=Ro.call(o)),t[o]=i},Dr(le)),Kg=Ya(function(t,o,i){o!=null&&typeof o.toString!="function"&&(o=Ro.call(o)),Et.call(t,o)?t[o].push(i):t[o]=[i]},J),qg=dt(ao);function Yt(t){return se(t)?la(t):rr(t)}function ae(t){return se(t)?la(t,!0):yu(t)}function Gg(t,o){var i={};return o=J(o,3),He(t,function(a,d,p){$e(i,o(a,d,p),a)}),i}function jg(t,o){var i={};return o=J(o,3),He(t,function(a,d,p){$e(i,d,o(a,d,p))}),i}var Xg=Hn(function(t,o,i){jo(t,o,i)}),Ol=Hn(function(t,o,i,a){jo(t,o,i,a)}),Zg=Ke(function(t,o){var i={};if(t==null)return i;var a=!1;o=Rt(o,function(p){return p=cn(p,t),a||(a=p.length>1),p}),Fe(t,kr(t),i),a&&(i=Se(i,E|D|U,$u));for(var d=o.length;d--;)hr(i,o[d]);return i});function Vg(t,o){return Rl(t,ci(J(o)))}var Jg=Ke(function(t,o){return t==null?{}:Eu(t,o)});function Rl(t,o){if(t==null)return{};var i=Rt(kr(t),function(a){return[a]});return o=J(o),Sa(t,i,function(a,d){return o(a,d[0])})}function Qg(t,o,i){o=cn(o,t);var a=-1,d=o.length;for(d||(d=1,t=n);++a<d;){var p=t==null?n:t[Ue(o[a])];p===n&&(a=d,p=i),t=Ge(p)?p.call(t):p}return t}function tm(t,o,i){return t==null?t:co(t,o,i)}function em(t,o,i,a){return a=typeof a=="function"?a:n,t==null?t:co(t,o,i,a)}var Nl=Ga(Yt),Dl=Ga(ae);function nm(t,o,i){var a=at(t),d=a||hn(t)||zn(t);if(o=J(o,4),i==null){var p=t&&t.constructor;d?i=a?new p:[]:Nt(t)?i=Ge(p)?Pn(Po(t)):{}:i={}}return(d?ye:He)(t,function(m,b,k){return o(i,m,b,k)}),i}function om(t,o){return t==null?!0:hr(t,o)}function im(t,o,i){return t==null?t:Ia(t,o,fr(i))}function rm(t,o,i,a){return a=typeof a=="function"?a:n,t==null?t:Ia(t,o,fr(i),a)}function Wn(t){return t==null?[]:qi(t,Yt(t))}function sm(t){return t==null?[]:qi(t,ae(t))}function am(t,o,i){return i===n&&(i=o,o=n),i!==n&&(i=Be(i),i=i===i?i:0),o!==n&&(o=Be(o),o=o===o?o:0),wn(Be(t),o,i)}function lm(t,o,i){return o=je(o),i===n?(i=o,o=0):i=je(i),t=Be(t),pu(t,o,i)}function cm(t,o,i){if(i&&typeof i!="boolean"&&te(t,o,i)&&(o=i=n),i===n&&(typeof o=="boolean"?(i=o,o=n):typeof t=="boolean"&&(i=t,t=n)),t===n&&o===n?(t=0,o=1):(t=je(t),o===n?(o=t,t=0):o=je(o)),t>o){var a=t;t=o,o=a}if(i||t%1||o%1){var d=sa();return Zt(t+d*(o-t+Ud("1e-"+((d+"").length-1))),o)}return lr(t,o)}var dm=Fn(function(t,o,i){return o=o.toLowerCase(),t+(i?Pl(o):o)});function Pl(t){return Nr(Ct(t).toLowerCase())}function Hl(t){return t=Ct(t),t&&t.replace(hd,Qd).replace(Id,"")}function hm(t,o,i){t=Ct(t),o=ge(o);var a=t.length;i=i===n?a:wn(lt(i),0,a);var d=i;return i-=o.length,i>=0&&t.slice(i,d)==o}function um(t){return t=Ct(t),t&&Kc.test(t)?t.replace(gs,th):t}function pm(t){return t=Ct(t),t&&Vc.test(t)?t.replace(Ii,"\\$&"):t}var fm=Fn(function(t,o,i){return t+(i?"-":"")+o.toLowerCase()}),gm=Fn(function(t,o,i){return t+(i?" ":"")+o.toLowerCase()}),mm=za("toLowerCase");function bm(t,o,i){t=Ct(t),o=lt(o);var a=o?Mn(t):0;if(!o||a>=o)return t;var d=(o-a)/2;return ti(zo(d),i)+t+ti(Uo(d),i)}function vm(t,o,i){t=Ct(t),o=lt(o);var a=o?Mn(t):0;return o&&a<o?t+ti(o-a,i):t}function km(t,o,i){t=Ct(t),o=lt(o);var a=o?Mn(t):0;return o&&a<o?ti(o-a,i)+t:t}function wm(t,o,i){return i||o==null?o=0:o&&(o=+o),Th(Ct(t).replace(Ai,""),o||0)}function xm(t,o,i){return(i?te(t,o,i):o===n)?o=1:o=lt(o),cr(Ct(t),o)}function ym(){var t=arguments,o=Ct(t[0]);return t.length<3?o:o.replace(t[1],t[2])}var Cm=Fn(function(t,o,i){return t+(i?"_":"")+o.toLowerCase()});function Em(t,o,i){return i&&typeof i!="number"&&te(t,o,i)&&(o=i=n),i=i===n?ut:i>>>0,i?(t=Ct(t),t&&(typeof o=="string"||o!=null&&!Mr(o))&&(o=ge(o),!o&&An(t))?dn(Ae(t),0,i):t.split(o,i)):[]}var Sm=Fn(function(t,o,i){return t+(i?" ":"")+Nr(o)});function Tm(t,o,i){return t=Ct(t),i=i==null?0:wn(lt(i),0,t.length),o=ge(o),t.slice(i,i+o.length)==o}function _m(t,o,i){var a=u.templateSettings;i&&te(t,o,i)&&(o=n),t=Ct(t),o=ui({},o,a,ja);var d=ui({},o.imports,a.imports,ja),p=Yt(d),m=qi(d,p),b,k,B=0,L=o.interpolate||So,M="__p += '",H=ji((o.escape||So).source+"|"+L.source+"|"+(L===ms?rd:So).source+"|"+(o.evaluate||So).source+"|$","g"),q="//# sourceURL="+(Et.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Nd+"]")+`
`;t.replace(H,function(et,pt,mt,be,ee,ve){return mt||(mt=be),M+=t.slice(B,ve).replace(ud,eh),pt&&(b=!0,M+=`' +
__e(`+pt+`) +
'`),ee&&(k=!0,M+=`';
`+ee+`;
__p += '`),mt&&(M+=`' +
((__t = (`+mt+`)) == null ? '' : __t) +
'`),B=ve+et.length,et}),M+=`';
`;var tt=Et.call(o,"variable")&&o.variable;if(!tt)M=`with (obj) {
`+M+`
}
`;else if(od.test(tt))throw new st(f);M=(k?M.replace(zc,""):M).replace(Wc,"$1").replace($c,"$1;"),M="function("+(tt||"obj")+`) {
`+(tt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(k?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+M+`return __p
}`;var ct=Ul(function(){return xt(p,q+"return "+M).apply(n,m)});if(ct.source=M,Ar(ct))throw ct;return ct}function Bm(t){return Ct(t).toLowerCase()}function Lm(t){return Ct(t).toUpperCase()}function Im(t,o,i){if(t=Ct(t),t&&(i||o===n))return Xs(t);if(!t||!(o=ge(o)))return t;var a=Ae(t),d=Ae(o),p=Zs(a,d),m=Vs(a,d)+1;return dn(a,p,m).join("")}function Am(t,o,i){if(t=Ct(t),t&&(i||o===n))return t.slice(0,Qs(t)+1);if(!t||!(o=ge(o)))return t;var a=Ae(t),d=Vs(a,Ae(o))+1;return dn(a,0,d).join("")}function Mm(t,o,i){if(t=Ct(t),t&&(i||o===n))return t.replace(Ai,"");if(!t||!(o=ge(o)))return t;var a=Ae(t),d=Zs(a,Ae(o));return dn(a,d).join("")}function Om(t,o){var i=A,a=R;if(Nt(o)){var d="separator"in o?o.separator:d;i="length"in o?lt(o.length):i,a="omission"in o?ge(o.omission):a}t=Ct(t);var p=t.length;if(An(t)){var m=Ae(t);p=m.length}if(i>=p)return t;var b=i-Mn(a);if(b<1)return a;var k=m?dn(m,0,b).join(""):t.slice(0,b);if(d===n)return k+a;if(m&&(b+=k.length-b),Mr(d)){if(t.slice(b).search(d)){var B,L=k;for(d.global||(d=ji(d.source,Ct(bs.exec(d))+"g")),d.lastIndex=0;B=d.exec(L);)var M=B.index;k=k.slice(0,M===n?b:M)}}else if(t.indexOf(ge(d),b)!=b){var H=k.lastIndexOf(d);H>-1&&(k=k.slice(0,H))}return k+a}function Rm(t){return t=Ct(t),t&&Yc.test(t)?t.replace(fs,lh):t}var Nm=Fn(function(t,o,i){return t+(i?" ":"")+o.toUpperCase()}),Nr=za("toUpperCase");function Fl(t,o,i){return t=Ct(t),o=i?n:o,o===n?oh(t)?hh(t):jd(t):t.match(o)||[]}var Ul=dt(function(t,o){try{return pe(t,n,o)}catch(i){return Ar(i)?i:new st(i)}}),Dm=Ke(function(t,o){return ye(o,function(i){i=Ue(i),$e(t,i,Lr(t[i],t))}),t});function Pm(t){var o=t==null?0:t.length,i=J();return t=o?Rt(t,function(a){if(typeof a[1]!="function")throw new Ce(h);return[i(a[0]),a[1]]}):[],dt(function(a){for(var d=-1;++d<o;){var p=t[d];if(pe(p[0],this,a))return pe(p[1],this,a)}})}function Hm(t){return lu(Se(t,E))}function Dr(t){return function(){return t}}function Fm(t,o){return t==null||t!==t?o:t}var Um=$a(),zm=$a(!0);function le(t){return t}function Pr(t){return ka(typeof t=="function"?t:Se(t,E))}function Wm(t){return xa(Se(t,E))}function $m(t,o){return ya(t,Se(o,E))}var Ym=dt(function(t,o){return function(i){return ao(i,t,o)}}),Km=dt(function(t,o){return function(i){return ao(t,i,o)}});function Hr(t,o,i){var a=Yt(o),d=Go(o,a);i==null&&!(Nt(o)&&(d.length||!a.length))&&(i=o,o=t,t=this,d=Go(o,Yt(o)));var p=!(Nt(i)&&"chain"in i)||!!i.chain,m=Ge(t);return ye(d,function(b){var k=o[b];t[b]=k,m&&(t.prototype[b]=function(){var B=this.__chain__;if(p||B){var L=t(this.__wrapped__),M=L.__actions__=re(this.__actions__);return M.push({func:k,args:arguments,thisArg:t}),L.__chain__=B,L}return k.apply(t,on([this.value()],arguments))})}),t}function qm(){return Kt._===this&&(Kt._=bh),this}function Fr(){}function Gm(t){return t=lt(t),dt(function(o){return Ca(o,t)})}var jm=mr(Rt),Xm=mr(Ys),Zm=mr(zi);function zl(t){return Cr(t)?Wi(Ue(t)):Su(t)}function Vm(t){return function(o){return t==null?n:xn(t,o)}}var Jm=Ka(),Qm=Ka(!0);function Ur(){return[]}function zr(){return!1}function tb(){return{}}function eb(){return""}function nb(){return!0}function ob(t,o){if(t=lt(t),t<1||t>Tt)return[];var i=ut,a=Zt(t,ut);o=J(o),t-=ut;for(var d=Ki(a,o);++i<t;)o(i);return d}function ib(t){return at(t)?Rt(t,Ue):me(t)?[t]:re(al(Ct(t)))}function rb(t){var o=++gh;return Ct(t)+o}var sb=Qo(function(t,o){return t+o},0),ab=br("ceil"),lb=Qo(function(t,o){return t/o},1),cb=br("floor");function db(t){return t&&t.length?qo(t,le,nr):n}function hb(t,o){return t&&t.length?qo(t,J(o,2),nr):n}function ub(t){return Gs(t,le)}function pb(t,o){return Gs(t,J(o,2))}function fb(t){return t&&t.length?qo(t,le,sr):n}function gb(t,o){return t&&t.length?qo(t,J(o,2),sr):n}var mb=Qo(function(t,o){return t*o},1),bb=br("round"),vb=Qo(function(t,o){return t-o},0);function kb(t){return t&&t.length?Yi(t,le):0}function wb(t,o){return t&&t.length?Yi(t,J(o,2)):0}return u.after=Wf,u.ary=vl,u.assign=Lg,u.assignIn=Ml,u.assignInWith=ui,u.assignWith=Ig,u.at=Ag,u.before=kl,u.bind=Lr,u.bindAll=Dm,u.bindKey=wl,u.castArray=tg,u.chain=gl,u.chunk=lp,u.compact=cp,u.concat=dp,u.cond=Pm,u.conforms=Hm,u.constant=Dr,u.countBy=kf,u.create=Mg,u.curry=xl,u.curryRight=yl,u.debounce=Cl,u.defaults=Og,u.defaultsDeep=Rg,u.defer=$f,u.delay=Yf,u.difference=hp,u.differenceBy=up,u.differenceWith=pp,u.drop=fp,u.dropRight=gp,u.dropRightWhile=mp,u.dropWhile=bp,u.fill=vp,u.filter=xf,u.flatMap=Ef,u.flatMapDeep=Sf,u.flatMapDepth=Tf,u.flatten=hl,u.flattenDeep=kp,u.flattenDepth=wp,u.flip=Kf,u.flow=Um,u.flowRight=zm,u.fromPairs=xp,u.functions=zg,u.functionsIn=Wg,u.groupBy=_f,u.initial=Cp,u.intersection=Ep,u.intersectionBy=Sp,u.intersectionWith=Tp,u.invert=Yg,u.invertBy=Kg,u.invokeMap=Lf,u.iteratee=Pr,u.keyBy=If,u.keys=Yt,u.keysIn=ae,u.map=si,u.mapKeys=Gg,u.mapValues=jg,u.matches=Wm,u.matchesProperty=$m,u.memoize=li,u.merge=Xg,u.mergeWith=Ol,u.method=Ym,u.methodOf=Km,u.mixin=Hr,u.negate=ci,u.nthArg=Gm,u.omit=Zg,u.omitBy=Vg,u.once=qf,u.orderBy=Af,u.over=jm,u.overArgs=Gf,u.overEvery=Xm,u.overSome=Zm,u.partial=Ir,u.partialRight=El,u.partition=Mf,u.pick=Jg,u.pickBy=Rl,u.property=zl,u.propertyOf=Vm,u.pull=Ip,u.pullAll=pl,u.pullAllBy=Ap,u.pullAllWith=Mp,u.pullAt=Op,u.range=Jm,u.rangeRight=Qm,u.rearg=jf,u.reject=Nf,u.remove=Rp,u.rest=Xf,u.reverse=_r,u.sampleSize=Pf,u.set=tm,u.setWith=em,u.shuffle=Hf,u.slice=Np,u.sortBy=zf,u.sortedUniq=Wp,u.sortedUniqBy=$p,u.split=Em,u.spread=Zf,u.tail=Yp,u.take=Kp,u.takeRight=qp,u.takeRightWhile=Gp,u.takeWhile=jp,u.tap=df,u.throttle=Vf,u.thru=ri,u.toArray=Ll,u.toPairs=Nl,u.toPairsIn=Dl,u.toPath=ib,u.toPlainObject=Al,u.transform=nm,u.unary=Jf,u.union=Xp,u.unionBy=Zp,u.unionWith=Vp,u.uniq=Jp,u.uniqBy=Qp,u.uniqWith=tf,u.unset=om,u.unzip=Br,u.unzipWith=fl,u.update=im,u.updateWith=rm,u.values=Wn,u.valuesIn=sm,u.without=ef,u.words=Fl,u.wrap=Qf,u.xor=nf,u.xorBy=of,u.xorWith=rf,u.zip=sf,u.zipObject=af,u.zipObjectDeep=lf,u.zipWith=cf,u.entries=Nl,u.entriesIn=Dl,u.extend=Ml,u.extendWith=ui,Hr(u,u),u.add=sb,u.attempt=Ul,u.camelCase=dm,u.capitalize=Pl,u.ceil=ab,u.clamp=am,u.clone=eg,u.cloneDeep=og,u.cloneDeepWith=ig,u.cloneWith=ng,u.conformsTo=rg,u.deburr=Hl,u.defaultTo=Fm,u.divide=lb,u.endsWith=hm,u.eq=Oe,u.escape=um,u.escapeRegExp=pm,u.every=wf,u.find=yf,u.findIndex=cl,u.findKey=Ng,u.findLast=Cf,u.findLastIndex=dl,u.findLastKey=Dg,u.floor=cb,u.forEach=ml,u.forEachRight=bl,u.forIn=Pg,u.forInRight=Hg,u.forOwn=Fg,u.forOwnRight=Ug,u.get=Or,u.gt=sg,u.gte=ag,u.has=$g,u.hasIn=Rr,u.head=ul,u.identity=le,u.includes=Bf,u.indexOf=yp,u.inRange=lm,u.invoke=qg,u.isArguments=En,u.isArray=at,u.isArrayBuffer=lg,u.isArrayLike=se,u.isArrayLikeObject=Ht,u.isBoolean=cg,u.isBuffer=hn,u.isDate=dg,u.isElement=hg,u.isEmpty=ug,u.isEqual=pg,u.isEqualWith=fg,u.isError=Ar,u.isFinite=gg,u.isFunction=Ge,u.isInteger=Sl,u.isLength=di,u.isMap=Tl,u.isMatch=mg,u.isMatchWith=bg,u.isNaN=vg,u.isNative=kg,u.isNil=xg,u.isNull=wg,u.isNumber=_l,u.isObject=Nt,u.isObjectLike=Pt,u.isPlainObject=fo,u.isRegExp=Mr,u.isSafeInteger=yg,u.isSet=Bl,u.isString=hi,u.isSymbol=me,u.isTypedArray=zn,u.isUndefined=Cg,u.isWeakMap=Eg,u.isWeakSet=Sg,u.join=_p,u.kebabCase=fm,u.last=_e,u.lastIndexOf=Bp,u.lowerCase=gm,u.lowerFirst=mm,u.lt=Tg,u.lte=_g,u.max=db,u.maxBy=hb,u.mean=ub,u.meanBy=pb,u.min=fb,u.minBy=gb,u.stubArray=Ur,u.stubFalse=zr,u.stubObject=tb,u.stubString=eb,u.stubTrue=nb,u.multiply=mb,u.nth=Lp,u.noConflict=qm,u.noop=Fr,u.now=ai,u.pad=bm,u.padEnd=vm,u.padStart=km,u.parseInt=wm,u.random=cm,u.reduce=Of,u.reduceRight=Rf,u.repeat=xm,u.replace=ym,u.result=Qg,u.round=bb,u.runInContext=v,u.sample=Df,u.size=Ff,u.snakeCase=Cm,u.some=Uf,u.sortedIndex=Dp,u.sortedIndexBy=Pp,u.sortedIndexOf=Hp,u.sortedLastIndex=Fp,u.sortedLastIndexBy=Up,u.sortedLastIndexOf=zp,u.startCase=Sm,u.startsWith=Tm,u.subtract=vb,u.sum=kb,u.sumBy=wb,u.template=_m,u.times=ob,u.toFinite=je,u.toInteger=lt,u.toLength=Il,u.toLower=Bm,u.toNumber=Be,u.toSafeInteger=Bg,u.toString=Ct,u.toUpper=Lm,u.trim=Im,u.trimEnd=Am,u.trimStart=Mm,u.truncate=Om,u.unescape=Rm,u.uniqueId=rb,u.upperCase=Nm,u.upperFirst=Nr,u.each=ml,u.eachRight=bl,u.first=ul,Hr(u,function(){var t={};return He(u,function(o,i){Et.call(u.prototype,i)||(t[i]=o)}),t}(),{chain:!1}),u.VERSION=r,ye(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){u[t].placeholder=u}),ye(["drop","take"],function(t,o){gt.prototype[t]=function(i){i=i===n?1:Wt(lt(i),0);var a=this.__filtered__&&!o?new gt(this):this.clone();return a.__filtered__?a.__takeCount__=Zt(i,a.__takeCount__):a.__views__.push({size:Zt(i,ut),type:t+(a.__dir__<0?"Right":"")}),a},gt.prototype[t+"Right"]=function(i){return this.reverse()[t](i).reverse()}}),ye(["filter","map","takeWhile"],function(t,o){var i=o+1,a=i==rt||i==wt;gt.prototype[t]=function(d){var p=this.clone();return p.__iteratees__.push({iteratee:J(d,3),type:i}),p.__filtered__=p.__filtered__||a,p}}),ye(["head","last"],function(t,o){var i="take"+(o?"Right":"");gt.prototype[t]=function(){return this[i](1).value()[0]}}),ye(["initial","tail"],function(t,o){var i="drop"+(o?"":"Right");gt.prototype[t]=function(){return this.__filtered__?new gt(this):this[i](1)}}),gt.prototype.compact=function(){return this.filter(le)},gt.prototype.find=function(t){return this.filter(t).head()},gt.prototype.findLast=function(t){return this.reverse().find(t)},gt.prototype.invokeMap=dt(function(t,o){return typeof t=="function"?new gt(this):this.map(function(i){return ao(i,t,o)})}),gt.prototype.reject=function(t){return this.filter(ci(J(t)))},gt.prototype.slice=function(t,o){t=lt(t);var i=this;return i.__filtered__&&(t>0||o<0)?new gt(i):(t<0?i=i.takeRight(-t):t&&(i=i.drop(t)),o!==n&&(o=lt(o),i=o<0?i.dropRight(-o):i.take(o-t)),i)},gt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},gt.prototype.toArray=function(){return this.take(ut)},He(gt.prototype,function(t,o){var i=/^(?:filter|find|map|reject)|While$/.test(o),a=/^(?:head|last)$/.test(o),d=u[a?"take"+(o=="last"?"Right":""):o],p=a||/^find/.test(o);d&&(u.prototype[o]=function(){var m=this.__wrapped__,b=a?[1]:arguments,k=m instanceof gt,B=b[0],L=k||at(m),M=function(pt){var mt=d.apply(u,on([pt],b));return a&&H?mt[0]:mt};L&&i&&typeof B=="function"&&B.length!=1&&(k=L=!1);var H=this.__chain__,q=!!this.__actions__.length,tt=p&&!H,ct=k&&!q;if(!p&&L){m=ct?m:new gt(this);var et=t.apply(m,b);return et.__actions__.push({func:ri,args:[M],thisArg:n}),new Ee(et,H)}return tt&&ct?t.apply(this,b):(et=this.thru(M),tt?a?et.value()[0]:et.value():et)})}),ye(["pop","push","shift","sort","splice","unshift"],function(t){var o=Ao[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",a=/^(?:pop|shift)$/.test(t);u.prototype[t]=function(){var d=arguments;if(a&&!this.__chain__){var p=this.value();return o.apply(at(p)?p:[],d)}return this[i](function(m){return o.apply(at(m)?m:[],d)})}}),He(gt.prototype,function(t,o){var i=u[o];if(i){var a=i.name+"";Et.call(Dn,a)||(Dn[a]=[]),Dn[a].push({name:o,func:i})}}),Dn[Jo(n,it).name]=[{name:"wrapper",func:n}],gt.prototype.clone=Oh,gt.prototype.reverse=Rh,gt.prototype.value=Nh,u.prototype.at=hf,u.prototype.chain=uf,u.prototype.commit=pf,u.prototype.next=ff,u.prototype.plant=mf,u.prototype.reverse=bf,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=vf,u.prototype.first=u.prototype.head,to&&(u.prototype[to]=gf),u},On=uh();mn?((mn.exports=On)._=On,Pi._=On):Kt._=On}).call(go)})(bi,bi.exports);var A1=bi.exports;const Nc=Rc(A1);var Dc={exports:{}};(function(l,e){(function(n,r){l.exports=r()})(self,()=>(()=>{var n={757:(h,f,g)=>{h.exports=g(666)},666:h=>{var f=function(g){var w,I=Object.prototype,E=I.hasOwnProperty,D=typeof Symbol=="function"?Symbol:{},U=D.iterator||"@@iterator",T=D.asyncIterator||"@@asyncIterator",F=D.toStringTag||"@@toStringTag";function P(N,O,K){return Object.defineProperty(N,O,{value:K,enumerable:!0,configurable:!0,writable:!0}),N[O]}try{P({},"")}catch{P=function(O,K,Q){return O[K]=Q}}function it(N,O,K,Q){var X=O&&O.prototype instanceof y?O:y,_t=Object.create(X.prototype),Lt=new ft(Q||[]);return _t._invoke=function(he,ie,vt){var Xt=Ot;return function(Dt,tn){if(Xt===Y)throw new Error("Generator is already running");if(Xt===Z){if(Dt==="throw")throw tn;return oe()}for(vt.method=Dt,vt.arg=tn;;){var Co=vt.delegate;if(Co){var ue=ht(Co,vt);if(ue){if(ue===$)continue;return ue}}if(vt.method==="next")vt.sent=vt._sent=vt.arg;else if(vt.method==="throw"){if(Xt===Ot)throw Xt=Z,vt.arg;vt.dispatchException(vt.arg)}else vt.method==="return"&&vt.abrupt("return",vt.arg);Xt=Y;var en=kt(he,ie,vt);if(en.type==="normal"){if(Xt=vt.done?Z:G,en.arg===$)continue;return{value:en.arg,done:vt.done}}en.type==="throw"&&(Xt=Z,vt.method="throw",vt.arg=en.arg)}}}(N,K,Lt),_t}function kt(N,O,K){try{return{type:"normal",arg:N.call(O,K)}}catch(Q){return{type:"throw",arg:Q}}}g.wrap=it;var Ot="suspendedStart",G="suspendedYield",Y="executing",Z="completed",$={};function y(){}function S(){}function A(){}var R={};P(R,U,function(){return this});var z=Object.getPrototypeOf,V=z&&z(z(ut([])));V&&V!==I&&E.call(V,U)&&(R=V);var rt=A.prototype=y.prototype=Object.create(R);function j(N){["next","throw","return"].forEach(function(O){P(N,O,function(K){return this._invoke(O,K)})})}function wt(N,O){function K(X,_t,Lt,he){var ie=kt(N[X],N,_t);if(ie.type!=="throw"){var vt=ie.arg,Xt=vt.value;return Xt&&typeof Xt=="object"&&E.call(Xt,"__await")?O.resolve(Xt.__await).then(function(Dt){K("next",Dt,Lt,he)},function(Dt){K("throw",Dt,Lt,he)}):O.resolve(Xt).then(function(Dt){vt.value=Dt,Lt(vt)},function(Dt){return K("throw",Dt,Lt,he)})}he(ie.arg)}var Q;this._invoke=function(X,_t){function Lt(){return new O(function(he,ie){K(X,_t,he,ie)})}return Q=Q?Q.then(Lt,Lt):Lt()}}function ht(N,O){var K=N.iterator[O.method];if(K===w){if(O.delegate=null,O.method==="throw"){if(N.iterator.return&&(O.method="return",O.arg=w,ht(N,O),O.method==="throw"))return $;O.method="throw",O.arg=new TypeError("The iterator does not provide a 'throw' method")}return $}var Q=kt(K,N.iterator,O.arg);if(Q.type==="throw")return O.method="throw",O.arg=Q.arg,O.delegate=null,$;var X=Q.arg;return X?X.done?(O[N.resultName]=X.value,O.next=N.nextLoc,O.method!=="return"&&(O.method="next",O.arg=w),O.delegate=null,$):X:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,$)}function Tt(N){var O={tryLoc:N[0]};1 in N&&(O.catchLoc=N[1]),2 in N&&(O.finallyLoc=N[2],O.afterLoc=N[3]),this.tryEntries.push(O)}function Ut(N){var O=N.completion||{};O.type="normal",delete O.arg,N.completion=O}function ft(N){this.tryEntries=[{tryLoc:"root"}],N.forEach(Tt,this),this.reset(!0)}function ut(N){if(N){var O=N[U];if(O)return O.call(N);if(typeof N.next=="function")return N;if(!isNaN(N.length)){var K=-1,Q=function X(){for(;++K<N.length;)if(E.call(N,K))return X.value=N[K],X.done=!1,X;return X.value=w,X.done=!0,X};return Q.next=Q}}return{next:oe}}function oe(){return{value:w,done:!0}}return S.prototype=A,P(rt,"constructor",A),P(A,"constructor",S),S.displayName=P(A,F,"GeneratorFunction"),g.isGeneratorFunction=function(N){var O=typeof N=="function"&&N.constructor;return!!O&&(O===S||(O.displayName||O.name)==="GeneratorFunction")},g.mark=function(N){return Object.setPrototypeOf?Object.setPrototypeOf(N,A):(N.__proto__=A,P(N,F,"GeneratorFunction")),N.prototype=Object.create(rt),N},g.awrap=function(N){return{__await:N}},j(wt.prototype),P(wt.prototype,T,function(){return this}),g.AsyncIterator=wt,g.async=function(N,O,K,Q,X){X===void 0&&(X=Promise);var _t=new wt(it(N,O,K,Q),X);return g.isGeneratorFunction(O)?_t:_t.next().then(function(Lt){return Lt.done?Lt.value:_t.next()})},j(rt),P(rt,F,"Generator"),P(rt,U,function(){return this}),P(rt,"toString",function(){return"[object Generator]"}),g.keys=function(N){var O=[];for(var K in N)O.push(K);return O.reverse(),function Q(){for(;O.length;){var X=O.pop();if(X in N)return Q.value=X,Q.done=!1,Q}return Q.done=!0,Q}},g.values=ut,ft.prototype={constructor:ft,reset:function(N){if(this.prev=0,this.next=0,this.sent=this._sent=w,this.done=!1,this.delegate=null,this.method="next",this.arg=w,this.tryEntries.forEach(Ut),!N)for(var O in this)O.charAt(0)==="t"&&E.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=w)},stop:function(){this.done=!0;var N=this.tryEntries[0].completion;if(N.type==="throw")throw N.arg;return this.rval},dispatchException:function(N){if(this.done)throw N;var O=this;function K(ie,vt){return _t.type="throw",_t.arg=N,O.next=ie,vt&&(O.method="next",O.arg=w),!!vt}for(var Q=this.tryEntries.length-1;Q>=0;--Q){var X=this.tryEntries[Q],_t=X.completion;if(X.tryLoc==="root")return K("end");if(X.tryLoc<=this.prev){var Lt=E.call(X,"catchLoc"),he=E.call(X,"finallyLoc");if(Lt&&he){if(this.prev<X.catchLoc)return K(X.catchLoc,!0);if(this.prev<X.finallyLoc)return K(X.finallyLoc)}else if(Lt){if(this.prev<X.catchLoc)return K(X.catchLoc,!0)}else{if(!he)throw new Error("try statement without catch or finally");if(this.prev<X.finallyLoc)return K(X.finallyLoc)}}}},abrupt:function(N,O){for(var K=this.tryEntries.length-1;K>=0;--K){var Q=this.tryEntries[K];if(Q.tryLoc<=this.prev&&E.call(Q,"finallyLoc")&&this.prev<Q.finallyLoc){var X=Q;break}}X&&(N==="break"||N==="continue")&&X.tryLoc<=O&&O<=X.finallyLoc&&(X=null);var _t=X?X.completion:{};return _t.type=N,_t.arg=O,X?(this.method="next",this.next=X.finallyLoc,$):this.complete(_t)},complete:function(N,O){if(N.type==="throw")throw N.arg;return N.type==="break"||N.type==="continue"?this.next=N.arg:N.type==="return"?(this.rval=this.arg=N.arg,this.method="return",this.next="end"):N.type==="normal"&&O&&(this.next=O),$},finish:function(N){for(var O=this.tryEntries.length-1;O>=0;--O){var K=this.tryEntries[O];if(K.finallyLoc===N)return this.complete(K.completion,K.afterLoc),Ut(K),$}},catch:function(N){for(var O=this.tryEntries.length-1;O>=0;--O){var K=this.tryEntries[O];if(K.tryLoc===N){var Q=K.completion;if(Q.type==="throw"){var X=Q.arg;Ut(K)}return X}}throw new Error("illegal catch attempt")},delegateYield:function(N,O,K){return this.delegate={iterator:ut(N),resultName:O,nextLoc:K},this.method==="next"&&(this.arg=w),$}},g}(h.exports);try{regeneratorRuntime=f}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=f:Function("r","regeneratorRuntime = r")(f)}},571:function(h,f){var g,w;g=function(I){var E=function(){function U(T,F){for(var P=0;P<F.length;P++){var it=F[P];it.enumerable=it.enumerable||!1,it.configurable=!0,"value"in it&&(it.writable=!0),Object.defineProperty(T,it.key,it)}}return function(T,F,P){return F&&U(T.prototype,F),P&&U(T,P),T}}(),D=function(){function U(T){(function(F,P){if(!(F instanceof P))throw new TypeError("Cannot call a class as a function")})(this,U),this.target=T,this.isContentEditable=T&&T.contentEditable}return E(U,[{key:"getPos",value:function(){if(document.activeElement!==this.target)return-1;if(this.isContentEditable){this.target.focus();var T=document.getSelection().getRangeAt(0),F=T.cloneRange();return F.selectNodeContents(this.target),F.setEnd(T.endContainer,T.endOffset),F.toString().length}return this.target.selectionStart}},{key:"setPos",value:function(T){if(this.isContentEditable){if(T>=0){var F=window.getSelection(),P=this.createRange(this.target,{count:T});P&&(P.collapse(!1),F.removeAllRanges(),F.addRange(P))}}else this.target.setSelectionRange(T,T)}},{key:"createRange",value:function(T,F,P){if(P||((P=document.createRange()).selectNode(T),P.setStart(T,0)),F.count===0)P.setEnd(T,F.count);else if(T&&F.count>0)if(T.nodeType===Node.TEXT_NODE)T.textContent.length<F.count?F.count-=T.textContent.length:(P.setEnd(T,F.count),F.count=0);else for(var it=0;it<T.childNodes.length&&(P=this.createRange(T.childNodes[it],F,P),F.count!==0);it++);return P}}]),U}();I.exports=D},(w=g.apply(f,[h]))===void 0||(h.exports=w)},334:(h,f,g)=>{h.exports=g(571)}},r={};function s(h){var f=r[h];if(f!==void 0)return f.exports;var g=r[h]={exports:{}};return n[h].call(g.exports,g,g.exports,s),g.exports}s.n=h=>{var f=h&&h.__esModule?()=>h.default:()=>h;return s.d(f,{a:f}),f},s.d=(h,f)=>{for(var g in f)s.o(f,g)&&!s.o(h,g)&&Object.defineProperty(h,g,{enumerable:!0,get:f[g]})},s.o=(h,f)=>Object.prototype.hasOwnProperty.call(h,f);var c={};return(()=>{function h(G,Y,Z,$,y,S,A){try{var R=G[S](A),z=R.value}catch(V){return void Z(V)}R.done?Y(z):Promise.resolve(z).then($,y)}function f(G){return function(){var Y=this,Z=arguments;return new Promise(function($,y){var S=G.apply(Y,Z);function A(z){h(S,$,y,A,R,"next",z)}function R(z){h(S,$,y,A,R,"throw",z)}A(void 0)})}}function g(G,Y,Z){return Y in G?Object.defineProperty(G,Y,{value:Z,enumerable:!0,configurable:!0,writable:!0}):G[Y]=Z,G}function w(G,Y){if(!(G instanceof Y))throw new TypeError("Cannot call a class as a function")}function I(G,Y){for(var Z=0;Z<Y.length;Z++){var $=Y[Z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(G,$.key,$)}}function E(G,Y,Z){return Y&&I(G.prototype,Y),Z&&I(G,Z),Object.defineProperty(G,"prototype",{writable:!1}),G}s.d(c,{default:()=>Ot});var D=s(757),U=s.n(D),T=s(334),F=s.n(T),P=function(){function G(Y,Z,$){w(this,G),this.holder=Z,this.observer=null,this.debounceTimer=$,this.mutationDebouncer=this.debounce(function(){Y()},this.debounceTimer)}return E(G,[{key:"setMutationObserver",value:function(){var Y=this,Z=this.holder.querySelector(".codex-editor__redactor");this.observer=new MutationObserver(function($){Y.mutationHandler($)}),this.observer.observe(Z,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(Y){var Z=this,$=!1;Y.forEach(function(y){switch(y.type){case"childList":y.target===Z.holder?Z.onDestroy():$=!0;break;case"characterData":$=!0;break;case"attributes":y.target.classList.contains("ce-block")||y.target.classList.contains("tc-toolbox")||($=!0)}}),$&&this.mutationDebouncer()}},{key:"debounce",value:function(Y,Z){var $,y=this;return function(){for(var S=arguments.length,A=new Array(S),R=0;R<S;R++)A[R]=arguments[R];var z=y;clearTimeout($),$=setTimeout(function(){return Y.apply(z,A)},Z)}}},{key:"onDestroy",value:function(){var Y=new CustomEvent("destroy");document.dispatchEvent(Y),this.observer.disconnect()}}]),G}();function it(G,Y){var Z=Object.keys(G);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(G);Y&&($=$.filter(function(y){return Object.getOwnPropertyDescriptor(G,y).enumerable})),Z.push.apply(Z,$)}return Z}function kt(G){for(var Y=1;Y<arguments.length;Y++){var Z=arguments[Y]!=null?arguments[Y]:{};Y%2?it(Object(Z),!0).forEach(function($){g(G,$,Z[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(Z)):it(Object(Z)).forEach(function($){Object.defineProperty(G,$,Object.getOwnPropertyDescriptor(Z,$))})}return G}var Ot=function(){function G(y){var S=this,A=y.editor,R=y.config,z=R===void 0?{}:R,V=y.onUpdate,rt=y.maxLength;w(this,G);var j={maxLength:30,onUpdate:function(){},config:{debounceTimer:200,shortcuts:{undo:["CMD+Z"],redo:["CMD+Y","CMD+SHIFT+Z"]}}},wt=A.blocks,ht=A.caret,Tt=A.configuration,Ut=Tt.holder,ft=Tt.defaultBlock,ut=j.config.shortcuts,oe=z.shortcuts,N=kt(kt({},ut),oe),O=Array.isArray(N.undo)?N.undo:[N.undo],K=Array.isArray(N.redo)?N.redo:[N.redo],Q=j.config.debounceTimer,X=z.debounceTimer,_t=X===void 0?Q:X;this.holder=typeof Ut=="string"?document.getElementById(Ut):Ut,this.editor=A,this.defaultBlock=ft,this.blocks=wt,this.caret=ht,this.shouldSaveHistory=!0,this.readOnly=Tt.readOnly,this.maxLength=rt||j.maxLength,this.onUpdate=V||j.onUpdate,this.config={debounceTimer:_t,shortcuts:{undo:O,redo:K}},new P(function(){return S.registerChange()},this.holder,this.config.debounceTimer).setMutationObserver(),this.setEventListeners(),this.initialItem=null,this.clear()}var Y,Z,$;return E(G,[{key:"truncate",value:function(y,S){for(;y.length>S;)y.shift()}},{key:"initialize",value:function(y){var S="blocks"in y?y.blocks:y,A={index:S.length-1,state:S};this.stack[0]=A,this.initialItem=A}},{key:"clear",value:function(){this.stack=this.initialItem?[this.initialItem]:[{index:0,state:[{type:this.defaultBlock,data:{}}]}],this.position=0,this.onUpdate()}},{key:"setReadOnly",value:function(){var y=this.holder.querySelector(".ce-toolbox");this.readOnly=!y}},{key:"registerChange",value:function(){var y=this;this.setReadOnly(),this.readOnly||(this.editor&&this.editor.save&&this.shouldSaveHistory&&this.editor.save().then(function(S){y.editorDidUpdate(S.blocks)&&y.save(S.blocks)}),this.shouldSaveHistory=!0)}},{key:"editorDidUpdate",value:function(y){var S=this.stack[this.position].state;return!!y.length&&(y.length!==S.length||JSON.stringify(S)!==JSON.stringify(y))}},{key:"save",value:function(y){this.position>=this.maxLength&&this.truncate(this.stack,this.maxLength),this.position=Math.min(this.position,this.stack.length-1),this.stack=this.stack.slice(0,this.position+1);var S=this.blocks.getCurrentBlockIndex(),A=this.blocks.getBlocksCount(),R=S;y[S]||(R-=A-y.length);var z=!y[R]||y[R].type!=="paragraph"&&y[R].type!=="header"?null:this.getCaretIndex(S);this.stack.push({index:R,state:y,caretIndex:z}),this.position+=1,this.onUpdate()}},{key:"getCaretIndex",value:function(y){var S=this.holder.getElementsByClassName("ce-block__content");return new(F())(S[y].firstChild).getPos()}},{key:"insertDeletedBlock",value:function(y,S,A){for(var R=0;R<y.length;R+=1)if(!S[R]||y[R].id!==S[R].id){this.blocks.insert(y[R].type,y[R].data,{},R,!0),this.caret.setToBlock(A,"end");break}}},{key:"blockWasDropped",value:function(y,S){return y.length===S.length&&y.some(function(A,R){return A.id!==S[R].id})}},{key:"blockWasSkipped",value:function(y,S,A,R){return y<S&&A.length!==R.length}},{key:"contentChangedInNoFocusBlock",value:function(y,S){return y!==S}},{key:"blockWasDeleted",value:function(y,S){return y.length>S.length}},{key:"undo",value:($=f(U().mark(function y(){var S,A,R,z,V,rt,j,wt,ht,Tt,Ut;return U().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:if(!this.canUndo()){ft.next=43;break}if(S=this.stack[this.position],A=S.index,R=S.state,this.position-=1,this.shouldSaveHistory=!1,z=this.stack[this.position].index,V=this.stack[this.position],rt=V.state,j=V.caretIndex,this.onUpdate(),wt=this.blocks.getBlocksCount(),rt[z]||(z-=1,this.stack[this.position].index=z),!this.blockWasDeleted(rt,R)){ft.next=13;break}this.insertDeletedBlock(rt,R,z),ft.next=38;break;case 13:if(!this.blockWasSkipped(z,A,rt,R)){ft.next=19;break}return ft.next=16,this.blocks.delete(A);case 16:this.caret.setToBlock(z,"end"),ft.next=38;break;case 19:if(!(wt>rt.length)){ft.next=27;break}return ft.next=22,this.blocks.render({blocks:rt});case 22:return ft.next=24,this.editor.blocks.insert(this.defaultBlock,{});case 24:this.setCaretIndex(z,j),ft.next=38;break;case 27:if(!this.blockWasDropped(rt,R)){ft.next=33;break}return ft.next=30,this.blocks.render({blocks:rt});case 30:this.caret.setToBlock(z,"end"),ft.next=38;break;case 33:if(!this.contentChangedInNoFocusBlock(z,A)){ft.next=38;break}return ht=this.blocks.getBlockByIndex(A),Tt=ht.id,ft.next=37,this.blocks.update(Tt,rt[A].data);case 37:this.setCaretIndex(z,j);case 38:if(!(Ut=this.blocks.getBlockByIndex(z))){ft.next=43;break}return ft.next=42,this.blocks.update(Ut.id,rt[z].data);case 42:this.setCaretIndex(z,j);case 43:case"end":return ft.stop()}},y,this)})),function(){return $.apply(this,arguments)})},{key:"setCaretIndex",value:function(y,S){if(S&&S!==-1){var A=this.holder.getElementsByClassName("ce-block__content"),R=new(F())(A[y].firstChild);setTimeout(function(){return R.setPos(S)},50)}else this.caret.setToBlock(y,"end")}},{key:"insertBlock",value:(Z=f(U().mark(function y(S,A){return U().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,this.blocks.insert(S[A].type,S[A].data,{},A,!0);case 2:case"end":return R.stop()}},y,this)})),function(y,S){return Z.apply(this,arguments)})},{key:"insertSkippedBlocks",value:function(y,S){for(var A=y;A<S.length;A+=1)this.insertBlock(S,A)}},{key:"redo",value:(Y=f(U().mark(function y(){var S,A,R,z,V,rt,j,wt;return U().wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:if(!this.canRedo()){ht.next=26;break}if(this.position+=1,this.shouldSaveHistory=!1,S=this.stack[this.position],A=S.index,R=S.state,z=S.caretIndex,V=this.stack[this.position-1],rt=V.index,j=V.state,!this.blockWasDeleted(j,R)){ht.next=11;break}return ht.next=8,this.blocks.delete();case 8:this.caret.setToBlock(A,"end"),ht.next=20;break;case 11:if(!this.blockWasSkipped(rt,A,R,j)){ht.next=16;break}this.insertSkippedBlocks(j.length,R),this.caret.setToBlock(A,"end"),ht.next=20;break;case 16:if(!this.blockWasDropped(R,j)||this.position===1){ht.next=20;break}return ht.next=19,this.blocks.render({blocks:R});case 19:this.caret.setToBlock(A,"end");case 20:if(this.onUpdate(),!(wt=this.blocks.getBlockByIndex(A))){ht.next=26;break}return ht.next=25,this.blocks.update(wt.id,R[A].data);case 25:this.setCaretIndex(A,z);case 26:case"end":return ht.stop()}},y,this)})),function(){return Y.apply(this,arguments)})},{key:"canUndo",value:function(){return!this.readOnly&&this.position>0}},{key:"canRedo",value:function(){return!this.readOnly&&this.position<this.count()}},{key:"count",value:function(){return this.stack.length-1}},{key:"parseKeys",value:function(y){var S={CMD:/(Mac)/i.test(navigator.platform)?"metaKey":"ctrlKey",ALT:"altKey",SHIFT:"shiftKey"},A=y.slice(0,-1).map(function(z){return S[z]}),R=A.includes("shiftKey")&&y.length===2?y[y.length-1].toUpperCase():y[y.length-1].toLowerCase();return A.push(R),A}},{key:"setEventListeners",value:function(){var y=this,S=this.holder,A=this.config.shortcuts,R=A.undo,z=A.redo,V=R.map(function(ut){return ut.replace(/ /g,"").split("+")}),rt=z.map(function(ut){return ut.replace(/ /g,"").split("+")}),j=V.map(function(ut){return y.parseKeys(ut)}),wt=rt.map(function(ut){return y.parseKeys(ut)}),ht=function(ut,oe){return oe.reduce(function(N,O){return N||function(K,Q){return Q.length===3&&K[Q[0]]&&K[Q[1]]&&K.key.toLowerCase()===Q[2]}(ut,O)},!1)},Tt=function(ut,oe,N){return!(!function(O,K){return K.reduce(function(Q,X){return Q||function(_t,Lt){return Lt.length===2&&_t[Lt[0]]&&_t.key.toLowerCase()===Lt[1]}(O,X)},!1)}(ut,oe)||ht(ut,N))||!!ht(ut,oe)},Ut=function(ut){Tt(ut,j,wt)&&(ut.preventDefault(),y.undo())},ft=function(ut){Tt(ut,wt,j)&&(ut.preventDefault(),y.redo())};S.addEventListener("keydown",Ut),S.addEventListener("keydown",ft),S.addEventListener("destroy",function(){S.removeEventListener("keydown",Ut),S.removeEventListener("keydown",ft)})}}],[{key:"isReadOnlySupported",get:function(){return!0}}]),G}()})(),c.default})())})(Dc);var M1=Dc.exports;const O1=Rc(M1);class R1{static get isInline(){return!0}get state(){return this._state}constructor({config:e,api:n}){this.api=n,this.button=null,this.optionButtons=[],this._state=!0,this.selectedText=null,this.range=null,this._settings=e,this.aiDrawer=document.getElementById("ai-drawer"),this.CSS={actions:"change-case-action",toolbarLabel:"change-case-toolbar__label",tool:"change-case-tool",toolbarBtnActive:this.api.styles.settingsButtonActive,inlineButton:this.api.styles.inlineToolButton},this.caseOptions={shorten:"Shorten",expand:"Expand",suggest:"Suggestions",prompt:"Prompt AI"}}set state(e){this._state=e,this.button.classList.toggle(this.CSS.toolbarBtnActive,e)}get title(){return"AI Assistant"}render(){const e=this.api.blocks.getCurrentBlockIndex();if(this.api.blocks.getBlockByIndex(e).name!="list")return this.button=document.createElement("button"),this.button.type="button",this.button.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
    `,this.button.classList.add(this.CSS.inlineButton),this.button}checkState(e){e.anchorNode}extractAllText(){let e=this.api.blocks.getBlocksCount();const n=[];for(let r=0;r<e;r++){const s=this.api.blocks.getBlockByIndex(r);if(!s.holder.textContent)continue;let h=s.holder.children[0].children[0].cloneNode(!0);const f=w=>{Array.from(w.attributes).forEach(I=>w.removeAttribute(I.name)),Array.from(w.children).forEach(I=>f(I))};if(f(h),s.name==="paragraph"){let w=document.createElement("p");w.innerHTML=h.innerHTML,h=w}let g=h.outerHTML;n.push(g)}return n.join(`

`)}handleClick(e,n){if(!e)return;const r=e.cloneContents();r&&(r.childNodes.forEach(s=>{s.nodeName}),!(n=="prompt"&&(n=prompt("Enter your prompt"),!n))&&(Livewire.dispatch("showDrawer"),this.aiDrawer.innerHTML='<div class="flex min-h-screen justify-center items-center"><span class="loading loading-spinner loading-lg"></span></div>',this.getCompletions(n).then(s=>{if(n=="shorten"&&(e.deleteContents(),e.insertNode(document.createTextNode(s.suggestions[0]))),n=="expand"&&(e.collapse(!1),e.insertNode(document.createTextNode(" "+s.suggestions[0]))),n=="expand"||n=="shorten"){Livewire.dispatch("hideDrawer");return}this.aiDrawer.innerHTML="",s.suggestions.forEach(c=>{const h=document.createElement("div");h.textContent=c,h.classList.add("cursor-pointer","p-2","hover:bg-gray-100","mb-2","mx-2","border","border-gray-200","rounded","text-lg"),h.onclick=()=>{e.deleteContents(),e.insertNode(document.createTextNode(c)),Livewire.dispatch("hideDrawer"),this.aiDrawer.innerHTML=""},this.aiDrawer.appendChild(h)})}),this.api.inlineToolbar.close()))}getCompletions(e){return new Promise((n,r)=>{const s=this.selectedText.textContent,c=this._settings.assistantUrl,h={articleHTML:this.extractAllText(),selectedText:s,prompt:e};fetch(c,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":this._settings.csrfToken},body:JSON.stringify(h)}).then(f=>f.json()).then(f=>n(f)).catch(f=>r(f))})}surround(e){this.selectedText=e.cloneContents(),this.actions.hidden=!this.actions.hidden,this.range=this.actions.hidden?null:e,this.state=!this.actions.hidden}renderActions(){this.actions=document.createElement("div"),this.actions.classList.add(this.CSS.actions);const e=document.createElement("div");e.classList.add(this.CSS.toolbarLabel),e.innerHTML=this.title,this.actions.appendChild(e),this.optionButtons=Object.keys(this.caseOptions).map(n=>{const r=document.createElement("div");return r.classList.add(this.CSS.tool),r.dataset.mode=n,r.innerHTML=this.caseOptions[n],r});for(const n of this.optionButtons)this.actions.appendChild(n),this.api.listeners.on(n,"click",()=>{this.handleClick(this.range,n.dataset.mode)});return this.actions.hidden=!0,this.actions}destroy(){for(const e of this.optionButtons)this.api.listeners.off(e,"click")}}var sc=null;let ps=Nc.debounce(Pc,200);Livewire.hook("morph.added",ps);Livewire.hook("morph.updated",ps);Livewire.hook("morph.removed",ps);setTimeout(()=>Pc(),500);function Pc(){const l=document.getElementById("editorjs");if(l){if(l.dataset.articleId===sc&&l.children.length>0){console.log("Article ID same as last article ID");return}sc=l.dataset.articleId,N1(l)}}function N1(l){const e=JSON.parse(l.dataset.editorjsData),n=new l1({holder:"editorjs",data:e,tools:{header:{class:m1,inlineToolbar:!0},list:{class:v1,inlineToolbar:!0},table:I1,assistant:{class:R1,config:{assistantUrl:l.dataset.assistantUrl,csrfToken:document.querySelector('input[name="_token"]').value},shortcut:"CTRL+M"}},onReady:()=>{new O1({editor:n,config:{shortcuts:{undo:"CTRL+Z",redo:"CTRL+SHIFT+Z"}}}).initialize(e)},onChange:Nc.debounce(()=>D1(n,l),200)})}function D1(l,e){l.save().then(n=>{fetch(e.dataset.postUrl,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-Token":document.querySelector('input[name="_token"]').value},body:JSON.stringify({data:n})}).then(r=>r.json()).then(r=>{console.log("Success:",r)}).catch(r=>{console.error("Error:",r)})})}
